{"ast":null,"code":"/**\r\n * DevExtreme (esm/viz/core/annotations.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport domAdapter from \"../../core/dom_adapter\";\nimport { isDefined, isFunction } from \"../../core/utils/type\";\nimport { Tooltip } from \"../core/tooltip\";\nimport { extend } from \"../../core/utils/extend\";\nimport { patchFontOptions } from \"./utils\";\nimport { Plaque } from \"./plaque\";\nimport pointerEvents from \"../../events/pointer\";\nimport { start as dragEventStart, move as dragEventMove, end as dragEventEnd } from \"../../events/drag\";\nimport { addNamespace } from \"../../events/utils/index\";\nimport eventsEngine from \"../../events/core/events_engine\";\nvar getDocument = domAdapter.getDocument;\nvar EVENT_NS = \"annotations\";\nvar DOT_EVENT_NS = \".\" + EVENT_NS;\nvar POINTER_ACTION = addNamespace([pointerEvents.down, pointerEvents.move], EVENT_NS);\nvar POINTER_UP_EVENT_NAME = addNamespace(pointerEvents.up, EVENT_NS);\nvar DRAG_START_EVENT_NAME = dragEventStart + DOT_EVENT_NS;\nvar DRAG_EVENT_NAME = dragEventMove + DOT_EVENT_NS;\nvar DRAG_END_EVENT_NAME = dragEventEnd + DOT_EVENT_NS;\n\nfunction coreAnnotation(options, contentTemplate) {\n  return {\n    draw: function (widget, group) {\n      var annotationGroup = widget._renderer.g().append(group).css(patchFontOptions(options.font));\n\n      if (this.plaque) {\n        this.plaque.clear();\n      }\n\n      this.plaque = new Plaque(extend(true, {}, options, {\n        cornerRadius: (options.border || {}).cornerRadius\n      }), widget, annotationGroup, contentTemplate, widget._isAnnotationBounded(options));\n      this.plaque.draw(widget._getAnnotationCoords(this));\n\n      if (options.allowDragging) {\n        annotationGroup.on(DRAG_START_EVENT_NAME, {\n          immediate: true\n        }, e => {\n          this._dragOffsetX = this.plaque.x - e.pageX;\n          this._dragOffsetY = this.plaque.y - e.pageY;\n        }).on(DRAG_EVENT_NAME, e => {\n          this.plaque.move(e.pageX + this._dragOffsetX, e.pageY + this._dragOffsetY);\n        }).on(DRAG_END_EVENT_NAME, e => {\n          this.offsetX = (this.offsetX || 0) + e.offset.x;\n          this.offsetY = (this.offsetY || 0) + e.offset.y;\n        });\n      }\n    },\n\n    hitTest(x, y) {\n      return this.plaque.hitTest(x, y);\n    },\n\n    showTooltip(tooltip, _ref) {\n      var {\n        x: x,\n        y: y\n      } = _ref;\n      var that = this;\n      var options = that.options;\n\n      if (tooltip.annotation !== that) {\n        tooltip.setTemplate(options.tooltipTemplate);\n\n        var callback = result => {\n          result && (tooltip.annotation = that);\n        };\n\n        callback(tooltip.show(options, {\n          x: x,\n          y: y\n        }, {\n          target: options\n        }, options.customizeTooltip, callback));\n      } else if (!tooltip.isCursorOnTooltip(x, y)) {\n        tooltip.move(x, y);\n      }\n    }\n\n  };\n}\n\nfunction getTemplateFunction(options, widget) {\n  var template;\n\n  if (\"text\" === options.type) {\n    template = function (item, groupElement) {\n      var text = widget._renderer.text(item.text).attr({\n        class: item.cssClass\n      }).append({\n        element: groupElement\n      });\n\n      if (item.width > 0 || item.height > 0) {\n        text.setMaxSize(item.width, item.height, {\n          wordWrap: item.wordWrap,\n          textOverflow: item.textOverflow\n        });\n      }\n    };\n  } else if (\"image\" === options.type) {\n    template = function (item, groupElement) {\n      var {\n        width: width,\n        height: height,\n        url: url,\n        location: location\n      } = item.image || {};\n      var {\n        width: outerWidth,\n        height: outerHeight\n      } = item;\n      var imageWidth = outerWidth > 0 ? Math.min(width, outerWidth) : width;\n      var imageHeight = outerHeight > 0 ? Math.min(height, outerHeight) : height;\n\n      widget._renderer.image(0, 0, imageWidth, imageHeight, url, location || \"center\").append({\n        element: groupElement\n      });\n    };\n  } else if (\"custom\" === options.type) {\n    template = options.template;\n  }\n\n  return template;\n}\n\nfunction getImageObject(image) {\n  return \"string\" === typeof image ? {\n    url: image\n  } : image;\n}\n\nexport var createAnnotations = function (widget, items) {\n  var commonAnnotationSettings = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\n  var customizeAnnotation = arguments.length > 3 ? arguments[3] : void 0;\n  var pullOptions = arguments.length > 4 ? arguments[4] : void 0;\n  var commonImageOptions = getImageObject(commonAnnotationSettings.image);\n  return items.reduce((arr, item) => {\n    var currentImageOptions = getImageObject(item.image);\n    var customizedItem = isFunction(customizeAnnotation) ? customizeAnnotation(item) : {};\n\n    if (customizedItem) {\n      customizedItem.image = getImageObject(customizedItem.image);\n    }\n\n    var options = extend(true, {}, commonAnnotationSettings, item, {\n      image: commonImageOptions\n    }, {\n      image: currentImageOptions\n    }, customizedItem);\n    var templateFunction = getTemplateFunction(options, widget);\n    var annotation = templateFunction && extend(true, pullOptions(options), coreAnnotation(options, widget._getTemplate(templateFunction)));\n    annotation && arr.push(annotation);\n    return arr;\n  }, []);\n};\nvar chartPlugin = {\n  name: \"annotations_chart\",\n\n  init() {},\n\n  dispose() {},\n\n  members: {\n    _getAnnotationCoords(annotation) {\n      var _axis, _axis2;\n\n      var coords = {\n        offsetX: annotation.offsetX,\n        offsetY: annotation.offsetY\n      };\n      var argCoordName = this._options.silent(\"rotated\") ? \"y\" : \"x\";\n      var valCoordName = this._options.silent(\"rotated\") ? \"x\" : \"y\";\n      var argAxis = this.getArgumentAxis();\n      var argument = argAxis.validateUnit(annotation.argument);\n      var axis = this.getValueAxis(annotation.axis);\n      var series;\n      var pane = null === (_axis = axis) || void 0 === _axis ? void 0 : _axis.pane;\n\n      if (annotation.series) {\n        var _series;\n\n        series = this.series.filter(s => s.name === annotation.series)[0];\n        axis = null === (_series = series) || void 0 === _series ? void 0 : _series.getValueAxis();\n        isDefined(axis) && (pane = axis.pane);\n      }\n\n      if (isDefined(argument)) {\n        if (series) {\n          var center = series.getPointCenterByArg(argument);\n          center && (coords[argCoordName] = center[argCoordName]);\n        } else {\n          coords[argCoordName] = argAxis.getTranslator().translate(argument);\n        }\n\n        !isDefined(pane) && (pane = argAxis.pane);\n      }\n\n      var value = null === (_axis2 = axis) || void 0 === _axis2 ? void 0 : _axis2.validateUnit(annotation.value);\n\n      if (isDefined(value)) {\n        var _axis3;\n\n        coords[valCoordName] = null === (_axis3 = axis) || void 0 === _axis3 ? void 0 : _axis3.getTranslator().translate(value);\n        !isDefined(pane) && isDefined(axis) && (pane = axis.pane);\n      }\n\n      coords.canvas = this._getCanvasForPane(pane);\n\n      if (isDefined(coords[argCoordName]) && !isDefined(value)) {\n        var _series2;\n\n        if (!isDefined(axis) && !isDefined(series)) {\n          coords[valCoordName] = argAxis.getAxisPosition();\n        } else if (isDefined(axis) && !isDefined(series)) {\n          coords[valCoordName] = this._argumentAxes.filter(a => a.pane === axis.pane)[0].getAxisPosition();\n        } else if (null !== (_series2 = series) && void 0 !== _series2 && _series2.checkSeriesViewportCoord(argAxis, coords[argCoordName])) {\n          coords[valCoordName] = series.getSeriesPairCoord(coords[argCoordName], true);\n        }\n      }\n\n      if (!isDefined(argument) && isDefined(coords[valCoordName])) {\n        if (isDefined(axis) && !isDefined(series)) {\n          coords[argCoordName] = axis.getAxisPosition();\n        } else if (isDefined(series)) {\n          if (series.checkSeriesViewportCoord(axis, coords[valCoordName])) {\n            coords[argCoordName] = series.getSeriesPairCoord(coords[valCoordName], false);\n          }\n        }\n      }\n\n      return coords;\n    },\n\n    _annotationsPointerEventHandler(event) {\n      if (this._disposed) {\n        return;\n      }\n\n      var originalEvent = event.originalEvent || {};\n      var touch = originalEvent.touches && originalEvent.touches[0] || {};\n\n      var rootOffset = this._renderer.getRootOffset();\n\n      var coords = {\n        x: touch.pageX || originalEvent.pageX || event.pageX,\n        y: touch.pageY || originalEvent.pageY || event.pageY\n      };\n\n      var annotation = this._annotations.items.filter(a => a.hitTest(coords.x - rootOffset.left, coords.y - rootOffset.top))[0];\n\n      if (!annotation || !annotation.options.tooltipEnabled) {\n        this._annotations.hideTooltip();\n\n        return;\n      }\n\n      this._clear();\n\n      if (annotation.options.allowDragging && event.type === pointerEvents.down) {\n        this._annotations._hideToolTipForDrag = true;\n      }\n\n      if (!this._annotations._hideToolTipForDrag) {\n        annotation.showTooltip(this._annotations.tooltip, coords);\n        event.stopPropagation();\n      }\n    },\n\n    _isAnnotationBounded: options => isDefined(options.value) || isDefined(options.argument),\n    _pullOptions: options => ({\n      type: options.type,\n      name: options.name,\n      x: options.x,\n      y: options.y,\n      value: options.value,\n      argument: options.argument,\n      axis: options.axis,\n      series: options.series,\n      options: options,\n      offsetX: options.offsetX,\n      offsetY: options.offsetY\n    }),\n\n    _forceAnnotationRender() {\n      this._change([\"FORCE_RENDER\"]);\n    },\n\n    _clear() {\n      this.hideTooltip();\n      this.clearHover();\n    }\n\n  }\n};\nvar polarChartPlugin = {\n  name: \"annotations_polar_chart\",\n\n  init() {},\n\n  dispose() {},\n\n  members: {\n    _getAnnotationCoords(annotation) {\n      var coords = {\n        offsetX: annotation.offsetX,\n        offsetY: annotation.offsetY,\n        canvas: this._calcCanvas()\n      };\n      var argAxis = this.getArgumentAxis();\n      var argument = argAxis.validateUnit(annotation.argument);\n      var value = this.getValueAxis().validateUnit(annotation.value);\n      var radius = annotation.radius;\n      var angle = annotation.angle;\n      var pointCoords;\n      var series;\n\n      if (annotation.series) {\n        series = this.series.filter(s => s.name === annotation.series)[0];\n      }\n\n      extend(true, coords, this.getXYFromPolar(angle, radius, argument, value));\n\n      if (isDefined(series)) {\n        if (isDefined(coords.angle) && !isDefined(value) && !isDefined(radius)) {\n          if (!isDefined(argument)) {\n            argument = argAxis.getTranslator().from(isFinite(angle) ? this.getActualAngle(angle) : coords.angle);\n          }\n\n          pointCoords = series.getSeriesPairCoord({\n            argument: argument,\n            angle: -coords.angle\n          }, true);\n        } else if (isDefined(coords.radius) && !isDefined(argument) && !isDefined(angle)) {\n          pointCoords = series.getSeriesPairCoord({\n            radius: coords.radius\n          }, false);\n        }\n\n        if (isDefined(pointCoords)) {\n          coords.x = pointCoords.x;\n          coords.y = pointCoords.y;\n        }\n      }\n\n      if (annotation.series && !isDefined(pointCoords)) {\n        coords.x = coords.y = void 0;\n      }\n\n      return coords;\n    },\n\n    _annotationsPointerEventHandler: chartPlugin.members._annotationsPointerEventHandler,\n    _isAnnotationBounded: chartPlugin.members._isAnnotationBounded,\n\n    _pullOptions(options) {\n      var polarOptions = extend({}, {\n        radius: options.radius,\n        angle: options.angle\n      }, chartPlugin.members._pullOptions(options));\n      delete polarOptions.axis;\n      return polarOptions;\n    },\n\n    _forceAnnotationRender: chartPlugin.members._forceAnnotationRender,\n    _clear: chartPlugin.members._clear\n  }\n};\nvar vectorMapPlugin = {\n  name: \"annotations_vector_map\",\n\n  init() {},\n\n  dispose() {\n    this._annotations._offTracker();\n\n    this._annotations._offTracker = null;\n  },\n\n  members: {\n    _getAnnotationCoords(annotation) {\n      var coords = {\n        offsetX: annotation.offsetX,\n        offsetY: annotation.offsetY\n      };\n      coords.canvas = this._projection.getCanvas();\n\n      if (annotation.coordinates) {\n        var data = this._projection.toScreenPoint(annotation.coordinates);\n\n        coords.x = data[0];\n        coords.y = data[1];\n      }\n\n      return coords;\n    },\n\n    _annotationsPointerEventHandler: chartPlugin.members._annotationsPointerEventHandler,\n    _isAnnotationBounded: options => isDefined(options.coordinates),\n\n    _pullOptions(options) {\n      var vectorMapOptions = extend({}, {\n        coordinates: options.coordinates\n      }, chartPlugin.members._pullOptions(options));\n      delete vectorMapOptions.axis;\n      delete vectorMapOptions.series;\n      delete vectorMapOptions.argument;\n      delete vectorMapOptions.value;\n      return vectorMapOptions;\n    },\n\n    _forceAnnotationRender() {\n      this._change([\"EXTRA_ELEMENTS\"]);\n    },\n\n    _getAnnotationStyles: () => ({\n      \"text-anchor\": \"start\"\n    }),\n\n    _clear() {}\n\n  },\n  extenders: {\n    _prepareExtraElements() {\n      var that = this;\n\n      var renderElements = () => {\n        that._renderExtraElements();\n      };\n\n      that._annotations._offTracker = that._tracker.on({\n        move: renderElements,\n        zoom: renderElements,\n        end: renderElements\n      });\n    }\n\n  }\n};\nvar pieChartPlugin = {\n  name: \"annotations_pie_chart\",\n\n  init() {},\n\n  dispose() {},\n\n  members: {\n    _getAnnotationCoords(annotation) {\n      var series;\n      var coords = {\n        offsetX: annotation.offsetX,\n        offsetY: annotation.offsetY,\n        canvas: this._canvas\n      };\n\n      if (annotation.argument) {\n        if (annotation.series) {\n          series = this.getSeriesByName(annotation.series);\n        } else {\n          series = this.series[0];\n        }\n\n        var argument = series.getPointsByArg(annotation.argument)[0];\n        var {\n          x: x,\n          y: y\n        } = argument.getAnnotationCoords(annotation.location);\n        coords.x = x;\n        coords.y = y;\n      }\n\n      return coords;\n    },\n\n    _isAnnotationBounded: options => options.argument,\n    _annotationsPointerEventHandler: chartPlugin.members._annotationsPointerEventHandler,\n\n    _pullOptions(options) {\n      var pieChartOptions = extend({}, {\n        location: options.location\n      }, chartPlugin.members._pullOptions(options));\n      delete pieChartOptions.axis;\n      return pieChartOptions;\n    },\n\n    _clear: chartPlugin.members._clear,\n    _forceAnnotationRender: chartPlugin.members._forceAnnotationRender\n  }\n};\nvar corePlugin = {\n  name: \"annotations_core\",\n\n  init() {\n    this._annotations = {\n      items: [],\n      _hideToolTipForDrag: false,\n      tooltip: new Tooltip({\n        cssClass: \"\".concat(this._rootClassPrefix, \"-annotation-tooltip\"),\n        eventTrigger: this._eventTrigger,\n        widgetRoot: this.element(),\n        widget: this\n      }),\n\n      hideTooltip() {\n        this.tooltip.annotation = null;\n        this.tooltip.hide();\n      },\n\n      clearItems() {\n        this.items.forEach(i => i.plaque.clear());\n        this.items = [];\n      }\n\n    };\n\n    this._annotations.tooltip.setRendererOptions(this._getRendererOptions());\n  },\n\n  dispose() {\n    this._annotationsGroup.linkRemove().linkOff();\n\n    eventsEngine.off(getDocument(), DOT_EVENT_NS);\n\n    this._annotationsGroup.off(DOT_EVENT_NS);\n\n    this._annotations.tooltip && this._annotations.tooltip.dispose();\n  },\n\n  extenders: {\n    _createHtmlStructure() {\n      this._annotationsGroup = this._renderer.g().attr({\n        class: \"\".concat(this._rootClassPrefix, \"-annotations\")\n      }).css(this._getAnnotationStyles()).linkOn(this._renderer.root, \"annotations\").linkAppend();\n      eventsEngine.on(getDocument(), POINTER_ACTION, e => {\n        if (this._disposed) {\n          return;\n        }\n\n        if (!this._annotations.tooltip.isCursorOnTooltip(e.pageX, e.pageY)) {\n          this._annotations.hideTooltip();\n        }\n      });\n      eventsEngine.on(getDocument(), POINTER_UP_EVENT_NAME, event => {\n        this._annotations._hideToolTipForDrag = false;\n\n        this._annotationsPointerEventHandler(event);\n      });\n\n      this._annotationsGroup.on(POINTER_ACTION, this._annotationsPointerEventHandler.bind(this));\n    },\n\n    _renderExtraElements() {\n      this._annotationsGroup.clear();\n\n      this._annotations.items.forEach(item => item.draw(this, this._annotationsGroup));\n    },\n\n    _stopCurrentHandling() {\n      this._annotations.hideTooltip();\n    }\n\n  },\n  members: {\n    _buildAnnotations() {\n      this._annotations.clearItems();\n\n      var items = this._getOption(\"annotations\", true);\n\n      if (!(null !== items && void 0 !== items && items.length)) {\n        return;\n      }\n\n      this._annotations.items = createAnnotations(this, items, this._getOption(\"commonAnnotationSettings\"), this._getOption(\"customizeAnnotation\", true), this._pullOptions);\n    },\n\n    _setAnnotationTooltipOptions() {\n      var tooltipOptions = extend({}, this._getOption(\"tooltip\"));\n      tooltipOptions.contentTemplate = tooltipOptions.customizeTooltip = void 0;\n\n      this._annotations.tooltip.update(tooltipOptions);\n    },\n\n    _getAnnotationCoords: () => ({}),\n    _pullOptions: () => ({}),\n    _getAnnotationStyles: () => ({})\n  },\n\n  customize(constructor) {\n    constructor.addChange({\n      code: \"ANNOTATIONITEMS\",\n\n      handler() {\n        this._requestChange([\"ANNOTATIONS\"]);\n      },\n\n      isOptionChange: true,\n      option: \"annotations\"\n    });\n    constructor.addChange({\n      code: \"ANNOTATIONSSETTINGS\",\n\n      handler() {\n        this._requestChange([\"ANNOTATIONS\"]);\n      },\n\n      isOptionChange: true,\n      option: \"commonAnnotationSettings\"\n    });\n    constructor.addChange({\n      code: \"ANNOTATIONS\",\n\n      handler() {\n        this._buildAnnotations();\n\n        this._setAnnotationTooltipOptions();\n\n        this._forceAnnotationRender();\n      },\n\n      isThemeDependent: true,\n      isOptionChange: true\n    });\n  },\n\n  fontFields: [\"commonAnnotationSettings.font\"]\n};\nexport var plugins = {\n  core: corePlugin,\n  chart: chartPlugin,\n  polarChart: polarChartPlugin,\n  vectorMap: vectorMapPlugin,\n  pieChart: pieChartPlugin\n};","map":{"version":3,"names":["domAdapter","isDefined","isFunction","Tooltip","extend","patchFontOptions","Plaque","pointerEvents","start","dragEventStart","move","dragEventMove","end","dragEventEnd","addNamespace","eventsEngine","getDocument","EVENT_NS","DOT_EVENT_NS","POINTER_ACTION","down","POINTER_UP_EVENT_NAME","up","DRAG_START_EVENT_NAME","DRAG_EVENT_NAME","DRAG_END_EVENT_NAME","coreAnnotation","options","contentTemplate","draw","widget","group","annotationGroup","_renderer","g","append","css","font","plaque","clear","cornerRadius","border","_isAnnotationBounded","_getAnnotationCoords","allowDragging","on","immediate","e","_dragOffsetX","x","pageX","_dragOffsetY","y","pageY","offsetX","offset","offsetY","hitTest","showTooltip","tooltip","_ref","that","annotation","setTemplate","tooltipTemplate","callback","result","show","target","customizeTooltip","isCursorOnTooltip","getTemplateFunction","template","type","item","groupElement","text","attr","class","cssClass","element","width","height","setMaxSize","wordWrap","textOverflow","url","location","image","outerWidth","outerHeight","imageWidth","Math","min","imageHeight","getImageObject","createAnnotations","items","commonAnnotationSettings","arguments","length","customizeAnnotation","pullOptions","commonImageOptions","reduce","arr","currentImageOptions","customizedItem","templateFunction","_getTemplate","push","chartPlugin","name","init","dispose","members","_axis","_axis2","coords","argCoordName","_options","silent","valCoordName","argAxis","getArgumentAxis","argument","validateUnit","axis","getValueAxis","series","pane","_series","filter","s","center","getPointCenterByArg","getTranslator","translate","value","_axis3","canvas","_getCanvasForPane","_series2","getAxisPosition","_argumentAxes","a","checkSeriesViewportCoord","getSeriesPairCoord","_annotationsPointerEventHandler","event","_disposed","originalEvent","touch","touches","rootOffset","getRootOffset","_annotations","left","top","tooltipEnabled","hideTooltip","_clear","_hideToolTipForDrag","stopPropagation","_pullOptions","_forceAnnotationRender","_change","clearHover","polarChartPlugin","_calcCanvas","radius","angle","pointCoords","getXYFromPolar","from","isFinite","getActualAngle","polarOptions","vectorMapPlugin","_offTracker","_projection","getCanvas","coordinates","data","toScreenPoint","vectorMapOptions","_getAnnotationStyles","extenders","_prepareExtraElements","renderElements","_renderExtraElements","_tracker","zoom","pieChartPlugin","_canvas","getSeriesByName","getPointsByArg","getAnnotationCoords","pieChartOptions","corePlugin","concat","_rootClassPrefix","eventTrigger","_eventTrigger","widgetRoot","hide","clearItems","forEach","i","setRendererOptions","_getRendererOptions","_annotationsGroup","linkRemove","linkOff","off","_createHtmlStructure","linkOn","root","linkAppend","bind","_stopCurrentHandling","_buildAnnotations","_getOption","_setAnnotationTooltipOptions","tooltipOptions","update","customize","constructor","addChange","code","handler","_requestChange","isOptionChange","option","isThemeDependent","fontFields","plugins","core","chart","polarChart","vectorMap","pieChart"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/viz/core/annotations.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/viz/core/annotations.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport domAdapter from \"../../core/dom_adapter\";\r\nimport {\r\n    isDefined,\r\n    isFunction\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    Tooltip\r\n} from \"../core/tooltip\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    patchFontOptions\r\n} from \"./utils\";\r\nimport {\r\n    Plaque\r\n} from \"./plaque\";\r\nimport pointerEvents from \"../../events/pointer\";\r\nimport {\r\n    start as dragEventStart,\r\n    move as dragEventMove,\r\n    end as dragEventEnd\r\n} from \"../../events/drag\";\r\nimport {\r\n    addNamespace\r\n} from \"../../events/utils/index\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nvar getDocument = domAdapter.getDocument;\r\nvar EVENT_NS = \"annotations\";\r\nvar DOT_EVENT_NS = \".\" + EVENT_NS;\r\nvar POINTER_ACTION = addNamespace([pointerEvents.down, pointerEvents.move], EVENT_NS);\r\nvar POINTER_UP_EVENT_NAME = addNamespace(pointerEvents.up, EVENT_NS);\r\nvar DRAG_START_EVENT_NAME = dragEventStart + DOT_EVENT_NS;\r\nvar DRAG_EVENT_NAME = dragEventMove + DOT_EVENT_NS;\r\nvar DRAG_END_EVENT_NAME = dragEventEnd + DOT_EVENT_NS;\r\n\r\nfunction coreAnnotation(options, contentTemplate) {\r\n    return {\r\n        draw: function(widget, group) {\r\n            var annotationGroup = widget._renderer.g().append(group).css(patchFontOptions(options.font));\r\n            if (this.plaque) {\r\n                this.plaque.clear()\r\n            }\r\n            this.plaque = new Plaque(extend(true, {}, options, {\r\n                cornerRadius: (options.border || {}).cornerRadius\r\n            }), widget, annotationGroup, contentTemplate, widget._isAnnotationBounded(options));\r\n            this.plaque.draw(widget._getAnnotationCoords(this));\r\n            if (options.allowDragging) {\r\n                annotationGroup.on(DRAG_START_EVENT_NAME, {\r\n                    immediate: true\r\n                }, e => {\r\n                    this._dragOffsetX = this.plaque.x - e.pageX;\r\n                    this._dragOffsetY = this.plaque.y - e.pageY\r\n                }).on(DRAG_EVENT_NAME, e => {\r\n                    this.plaque.move(e.pageX + this._dragOffsetX, e.pageY + this._dragOffsetY)\r\n                }).on(DRAG_END_EVENT_NAME, e => {\r\n                    this.offsetX = (this.offsetX || 0) + e.offset.x;\r\n                    this.offsetY = (this.offsetY || 0) + e.offset.y\r\n                })\r\n            }\r\n        },\r\n        hitTest(x, y) {\r\n            return this.plaque.hitTest(x, y)\r\n        },\r\n        showTooltip(tooltip, _ref) {\r\n            var {\r\n                x: x,\r\n                y: y\r\n            } = _ref;\r\n            var that = this;\r\n            var options = that.options;\r\n            if (tooltip.annotation !== that) {\r\n                tooltip.setTemplate(options.tooltipTemplate);\r\n                var callback = result => {\r\n                    result && (tooltip.annotation = that)\r\n                };\r\n                callback(tooltip.show(options, {\r\n                    x: x,\r\n                    y: y\r\n                }, {\r\n                    target: options\r\n                }, options.customizeTooltip, callback))\r\n            } else if (!tooltip.isCursorOnTooltip(x, y)) {\r\n                tooltip.move(x, y)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction getTemplateFunction(options, widget) {\r\n    var template;\r\n    if (\"text\" === options.type) {\r\n        template = function(item, groupElement) {\r\n            var text = widget._renderer.text(item.text).attr({\r\n                class: item.cssClass\r\n            }).append({\r\n                element: groupElement\r\n            });\r\n            if (item.width > 0 || item.height > 0) {\r\n                text.setMaxSize(item.width, item.height, {\r\n                    wordWrap: item.wordWrap,\r\n                    textOverflow: item.textOverflow\r\n                })\r\n            }\r\n        }\r\n    } else if (\"image\" === options.type) {\r\n        template = function(item, groupElement) {\r\n            var {\r\n                width: width,\r\n                height: height,\r\n                url: url,\r\n                location: location\r\n            } = item.image || {};\r\n            var {\r\n                width: outerWidth,\r\n                height: outerHeight\r\n            } = item;\r\n            var imageWidth = outerWidth > 0 ? Math.min(width, outerWidth) : width;\r\n            var imageHeight = outerHeight > 0 ? Math.min(height, outerHeight) : height;\r\n            widget._renderer.image(0, 0, imageWidth, imageHeight, url, location || \"center\").append({\r\n                element: groupElement\r\n            })\r\n        }\r\n    } else if (\"custom\" === options.type) {\r\n        template = options.template\r\n    }\r\n    return template\r\n}\r\n\r\nfunction getImageObject(image) {\r\n    return \"string\" === typeof image ? {\r\n        url: image\r\n    } : image\r\n}\r\nexport var createAnnotations = function(widget, items) {\r\n    var commonAnnotationSettings = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\r\n    var customizeAnnotation = arguments.length > 3 ? arguments[3] : void 0;\r\n    var pullOptions = arguments.length > 4 ? arguments[4] : void 0;\r\n    var commonImageOptions = getImageObject(commonAnnotationSettings.image);\r\n    return items.reduce((arr, item) => {\r\n        var currentImageOptions = getImageObject(item.image);\r\n        var customizedItem = isFunction(customizeAnnotation) ? customizeAnnotation(item) : {};\r\n        if (customizedItem) {\r\n            customizedItem.image = getImageObject(customizedItem.image)\r\n        }\r\n        var options = extend(true, {}, commonAnnotationSettings, item, {\r\n            image: commonImageOptions\r\n        }, {\r\n            image: currentImageOptions\r\n        }, customizedItem);\r\n        var templateFunction = getTemplateFunction(options, widget);\r\n        var annotation = templateFunction && extend(true, pullOptions(options), coreAnnotation(options, widget._getTemplate(templateFunction)));\r\n        annotation && arr.push(annotation);\r\n        return arr\r\n    }, [])\r\n};\r\nvar chartPlugin = {\r\n    name: \"annotations_chart\",\r\n    init() {},\r\n    dispose() {},\r\n    members: {\r\n        _getAnnotationCoords(annotation) {\r\n            var _axis, _axis2;\r\n            var coords = {\r\n                offsetX: annotation.offsetX,\r\n                offsetY: annotation.offsetY\r\n            };\r\n            var argCoordName = this._options.silent(\"rotated\") ? \"y\" : \"x\";\r\n            var valCoordName = this._options.silent(\"rotated\") ? \"x\" : \"y\";\r\n            var argAxis = this.getArgumentAxis();\r\n            var argument = argAxis.validateUnit(annotation.argument);\r\n            var axis = this.getValueAxis(annotation.axis);\r\n            var series;\r\n            var pane = null === (_axis = axis) || void 0 === _axis ? void 0 : _axis.pane;\r\n            if (annotation.series) {\r\n                var _series;\r\n                series = this.series.filter(s => s.name === annotation.series)[0];\r\n                axis = null === (_series = series) || void 0 === _series ? void 0 : _series.getValueAxis();\r\n                isDefined(axis) && (pane = axis.pane)\r\n            }\r\n            if (isDefined(argument)) {\r\n                if (series) {\r\n                    var center = series.getPointCenterByArg(argument);\r\n                    center && (coords[argCoordName] = center[argCoordName])\r\n                } else {\r\n                    coords[argCoordName] = argAxis.getTranslator().translate(argument)\r\n                }!isDefined(pane) && (pane = argAxis.pane)\r\n            }\r\n            var value = null === (_axis2 = axis) || void 0 === _axis2 ? void 0 : _axis2.validateUnit(annotation.value);\r\n            if (isDefined(value)) {\r\n                var _axis3;\r\n                coords[valCoordName] = null === (_axis3 = axis) || void 0 === _axis3 ? void 0 : _axis3.getTranslator().translate(value);\r\n                !isDefined(pane) && isDefined(axis) && (pane = axis.pane)\r\n            }\r\n            coords.canvas = this._getCanvasForPane(pane);\r\n            if (isDefined(coords[argCoordName]) && !isDefined(value)) {\r\n                var _series2;\r\n                if (!isDefined(axis) && !isDefined(series)) {\r\n                    coords[valCoordName] = argAxis.getAxisPosition()\r\n                } else if (isDefined(axis) && !isDefined(series)) {\r\n                    coords[valCoordName] = this._argumentAxes.filter(a => a.pane === axis.pane)[0].getAxisPosition()\r\n                } else if (null !== (_series2 = series) && void 0 !== _series2 && _series2.checkSeriesViewportCoord(argAxis, coords[argCoordName])) {\r\n                    coords[valCoordName] = series.getSeriesPairCoord(coords[argCoordName], true)\r\n                }\r\n            }\r\n            if (!isDefined(argument) && isDefined(coords[valCoordName])) {\r\n                if (isDefined(axis) && !isDefined(series)) {\r\n                    coords[argCoordName] = axis.getAxisPosition()\r\n                } else if (isDefined(series)) {\r\n                    if (series.checkSeriesViewportCoord(axis, coords[valCoordName])) {\r\n                        coords[argCoordName] = series.getSeriesPairCoord(coords[valCoordName], false)\r\n                    }\r\n                }\r\n            }\r\n            return coords\r\n        },\r\n        _annotationsPointerEventHandler(event) {\r\n            if (this._disposed) {\r\n                return\r\n            }\r\n            var originalEvent = event.originalEvent || {};\r\n            var touch = originalEvent.touches && originalEvent.touches[0] || {};\r\n            var rootOffset = this._renderer.getRootOffset();\r\n            var coords = {\r\n                x: touch.pageX || originalEvent.pageX || event.pageX,\r\n                y: touch.pageY || originalEvent.pageY || event.pageY\r\n            };\r\n            var annotation = this._annotations.items.filter(a => a.hitTest(coords.x - rootOffset.left, coords.y - rootOffset.top))[0];\r\n            if (!annotation || !annotation.options.tooltipEnabled) {\r\n                this._annotations.hideTooltip();\r\n                return\r\n            }\r\n            this._clear();\r\n            if (annotation.options.allowDragging && event.type === pointerEvents.down) {\r\n                this._annotations._hideToolTipForDrag = true\r\n            }\r\n            if (!this._annotations._hideToolTipForDrag) {\r\n                annotation.showTooltip(this._annotations.tooltip, coords);\r\n                event.stopPropagation()\r\n            }\r\n        },\r\n        _isAnnotationBounded: options => isDefined(options.value) || isDefined(options.argument),\r\n        _pullOptions: options => ({\r\n            type: options.type,\r\n            name: options.name,\r\n            x: options.x,\r\n            y: options.y,\r\n            value: options.value,\r\n            argument: options.argument,\r\n            axis: options.axis,\r\n            series: options.series,\r\n            options: options,\r\n            offsetX: options.offsetX,\r\n            offsetY: options.offsetY\r\n        }),\r\n        _forceAnnotationRender() {\r\n            this._change([\"FORCE_RENDER\"])\r\n        },\r\n        _clear() {\r\n            this.hideTooltip();\r\n            this.clearHover()\r\n        }\r\n    }\r\n};\r\nvar polarChartPlugin = {\r\n    name: \"annotations_polar_chart\",\r\n    init() {},\r\n    dispose() {},\r\n    members: {\r\n        _getAnnotationCoords(annotation) {\r\n            var coords = {\r\n                offsetX: annotation.offsetX,\r\n                offsetY: annotation.offsetY,\r\n                canvas: this._calcCanvas()\r\n            };\r\n            var argAxis = this.getArgumentAxis();\r\n            var argument = argAxis.validateUnit(annotation.argument);\r\n            var value = this.getValueAxis().validateUnit(annotation.value);\r\n            var radius = annotation.radius;\r\n            var angle = annotation.angle;\r\n            var pointCoords;\r\n            var series;\r\n            if (annotation.series) {\r\n                series = this.series.filter(s => s.name === annotation.series)[0]\r\n            }\r\n            extend(true, coords, this.getXYFromPolar(angle, radius, argument, value));\r\n            if (isDefined(series)) {\r\n                if (isDefined(coords.angle) && !isDefined(value) && !isDefined(radius)) {\r\n                    if (!isDefined(argument)) {\r\n                        argument = argAxis.getTranslator().from(isFinite(angle) ? this.getActualAngle(angle) : coords.angle)\r\n                    }\r\n                    pointCoords = series.getSeriesPairCoord({\r\n                        argument: argument,\r\n                        angle: -coords.angle\r\n                    }, true)\r\n                } else if (isDefined(coords.radius) && !isDefined(argument) && !isDefined(angle)) {\r\n                    pointCoords = series.getSeriesPairCoord({\r\n                        radius: coords.radius\r\n                    }, false)\r\n                }\r\n                if (isDefined(pointCoords)) {\r\n                    coords.x = pointCoords.x;\r\n                    coords.y = pointCoords.y\r\n                }\r\n            }\r\n            if (annotation.series && !isDefined(pointCoords)) {\r\n                coords.x = coords.y = void 0\r\n            }\r\n            return coords\r\n        },\r\n        _annotationsPointerEventHandler: chartPlugin.members._annotationsPointerEventHandler,\r\n        _isAnnotationBounded: chartPlugin.members._isAnnotationBounded,\r\n        _pullOptions(options) {\r\n            var polarOptions = extend({}, {\r\n                radius: options.radius,\r\n                angle: options.angle\r\n            }, chartPlugin.members._pullOptions(options));\r\n            delete polarOptions.axis;\r\n            return polarOptions\r\n        },\r\n        _forceAnnotationRender: chartPlugin.members._forceAnnotationRender,\r\n        _clear: chartPlugin.members._clear\r\n    }\r\n};\r\nvar vectorMapPlugin = {\r\n    name: \"annotations_vector_map\",\r\n    init() {},\r\n    dispose() {\r\n        this._annotations._offTracker();\r\n        this._annotations._offTracker = null\r\n    },\r\n    members: {\r\n        _getAnnotationCoords(annotation) {\r\n            var coords = {\r\n                offsetX: annotation.offsetX,\r\n                offsetY: annotation.offsetY\r\n            };\r\n            coords.canvas = this._projection.getCanvas();\r\n            if (annotation.coordinates) {\r\n                var data = this._projection.toScreenPoint(annotation.coordinates);\r\n                coords.x = data[0];\r\n                coords.y = data[1]\r\n            }\r\n            return coords\r\n        },\r\n        _annotationsPointerEventHandler: chartPlugin.members._annotationsPointerEventHandler,\r\n        _isAnnotationBounded: options => isDefined(options.coordinates),\r\n        _pullOptions(options) {\r\n            var vectorMapOptions = extend({}, {\r\n                coordinates: options.coordinates\r\n            }, chartPlugin.members._pullOptions(options));\r\n            delete vectorMapOptions.axis;\r\n            delete vectorMapOptions.series;\r\n            delete vectorMapOptions.argument;\r\n            delete vectorMapOptions.value;\r\n            return vectorMapOptions\r\n        },\r\n        _forceAnnotationRender() {\r\n            this._change([\"EXTRA_ELEMENTS\"])\r\n        },\r\n        _getAnnotationStyles: () => ({\r\n            \"text-anchor\": \"start\"\r\n        }),\r\n        _clear() {}\r\n    },\r\n    extenders: {\r\n        _prepareExtraElements() {\r\n            var that = this;\r\n            var renderElements = () => {\r\n                that._renderExtraElements()\r\n            };\r\n            that._annotations._offTracker = that._tracker.on({\r\n                move: renderElements,\r\n                zoom: renderElements,\r\n                end: renderElements\r\n            })\r\n        }\r\n    }\r\n};\r\nvar pieChartPlugin = {\r\n    name: \"annotations_pie_chart\",\r\n    init() {},\r\n    dispose() {},\r\n    members: {\r\n        _getAnnotationCoords(annotation) {\r\n            var series;\r\n            var coords = {\r\n                offsetX: annotation.offsetX,\r\n                offsetY: annotation.offsetY,\r\n                canvas: this._canvas\r\n            };\r\n            if (annotation.argument) {\r\n                if (annotation.series) {\r\n                    series = this.getSeriesByName(annotation.series)\r\n                } else {\r\n                    series = this.series[0]\r\n                }\r\n                var argument = series.getPointsByArg(annotation.argument)[0];\r\n                var {\r\n                    x: x,\r\n                    y: y\r\n                } = argument.getAnnotationCoords(annotation.location);\r\n                coords.x = x;\r\n                coords.y = y\r\n            }\r\n            return coords\r\n        },\r\n        _isAnnotationBounded: options => options.argument,\r\n        _annotationsPointerEventHandler: chartPlugin.members._annotationsPointerEventHandler,\r\n        _pullOptions(options) {\r\n            var pieChartOptions = extend({}, {\r\n                location: options.location\r\n            }, chartPlugin.members._pullOptions(options));\r\n            delete pieChartOptions.axis;\r\n            return pieChartOptions\r\n        },\r\n        _clear: chartPlugin.members._clear,\r\n        _forceAnnotationRender: chartPlugin.members._forceAnnotationRender\r\n    }\r\n};\r\nvar corePlugin = {\r\n    name: \"annotations_core\",\r\n    init() {\r\n        this._annotations = {\r\n            items: [],\r\n            _hideToolTipForDrag: false,\r\n            tooltip: new Tooltip({\r\n                cssClass: \"\".concat(this._rootClassPrefix, \"-annotation-tooltip\"),\r\n                eventTrigger: this._eventTrigger,\r\n                widgetRoot: this.element(),\r\n                widget: this\r\n            }),\r\n            hideTooltip() {\r\n                this.tooltip.annotation = null;\r\n                this.tooltip.hide()\r\n            },\r\n            clearItems() {\r\n                this.items.forEach(i => i.plaque.clear());\r\n                this.items = []\r\n            }\r\n        };\r\n        this._annotations.tooltip.setRendererOptions(this._getRendererOptions())\r\n    },\r\n    dispose() {\r\n        this._annotationsGroup.linkRemove().linkOff();\r\n        eventsEngine.off(getDocument(), DOT_EVENT_NS);\r\n        this._annotationsGroup.off(DOT_EVENT_NS);\r\n        this._annotations.tooltip && this._annotations.tooltip.dispose()\r\n    },\r\n    extenders: {\r\n        _createHtmlStructure() {\r\n            this._annotationsGroup = this._renderer.g().attr({\r\n                class: \"\".concat(this._rootClassPrefix, \"-annotations\")\r\n            }).css(this._getAnnotationStyles()).linkOn(this._renderer.root, \"annotations\").linkAppend();\r\n            eventsEngine.on(getDocument(), POINTER_ACTION, e => {\r\n                if (this._disposed) {\r\n                    return\r\n                }\r\n                if (!this._annotations.tooltip.isCursorOnTooltip(e.pageX, e.pageY)) {\r\n                    this._annotations.hideTooltip()\r\n                }\r\n            });\r\n            eventsEngine.on(getDocument(), POINTER_UP_EVENT_NAME, event => {\r\n                this._annotations._hideToolTipForDrag = false;\r\n                this._annotationsPointerEventHandler(event)\r\n            });\r\n            this._annotationsGroup.on(POINTER_ACTION, this._annotationsPointerEventHandler.bind(this))\r\n        },\r\n        _renderExtraElements() {\r\n            this._annotationsGroup.clear();\r\n            this._annotations.items.forEach(item => item.draw(this, this._annotationsGroup))\r\n        },\r\n        _stopCurrentHandling() {\r\n            this._annotations.hideTooltip()\r\n        }\r\n    },\r\n    members: {\r\n        _buildAnnotations() {\r\n            this._annotations.clearItems();\r\n            var items = this._getOption(\"annotations\", true);\r\n            if (!(null !== items && void 0 !== items && items.length)) {\r\n                return\r\n            }\r\n            this._annotations.items = createAnnotations(this, items, this._getOption(\"commonAnnotationSettings\"), this._getOption(\"customizeAnnotation\", true), this._pullOptions)\r\n        },\r\n        _setAnnotationTooltipOptions() {\r\n            var tooltipOptions = extend({}, this._getOption(\"tooltip\"));\r\n            tooltipOptions.contentTemplate = tooltipOptions.customizeTooltip = void 0;\r\n            this._annotations.tooltip.update(tooltipOptions)\r\n        },\r\n        _getAnnotationCoords: () => ({}),\r\n        _pullOptions: () => ({}),\r\n        _getAnnotationStyles: () => ({})\r\n    },\r\n    customize(constructor) {\r\n        constructor.addChange({\r\n            code: \"ANNOTATIONITEMS\",\r\n            handler() {\r\n                this._requestChange([\"ANNOTATIONS\"])\r\n            },\r\n            isOptionChange: true,\r\n            option: \"annotations\"\r\n        });\r\n        constructor.addChange({\r\n            code: \"ANNOTATIONSSETTINGS\",\r\n            handler() {\r\n                this._requestChange([\"ANNOTATIONS\"])\r\n            },\r\n            isOptionChange: true,\r\n            option: \"commonAnnotationSettings\"\r\n        });\r\n        constructor.addChange({\r\n            code: \"ANNOTATIONS\",\r\n            handler() {\r\n                this._buildAnnotations();\r\n                this._setAnnotationTooltipOptions();\r\n                this._forceAnnotationRender()\r\n            },\r\n            isThemeDependent: true,\r\n            isOptionChange: true\r\n        })\r\n    },\r\n    fontFields: [\"commonAnnotationSettings.font\"]\r\n};\r\nexport var plugins = {\r\n    core: corePlugin,\r\n    chart: chartPlugin,\r\n    polarChart: polarChartPlugin,\r\n    vectorMap: vectorMapPlugin,\r\n    pieChart: pieChartPlugin\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}