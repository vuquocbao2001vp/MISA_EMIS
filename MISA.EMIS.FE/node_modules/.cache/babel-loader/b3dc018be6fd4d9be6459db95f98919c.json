{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/html_editor/modules/dropImage.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport Quill from \"devextreme-quill\";\nimport eventsEngine from \"../../../events/core/events_engine\";\nimport { addNamespace } from \"../../../events/utils/index\";\nimport { each } from \"../../../core/utils/iterator\";\nimport browser from \"../../../core/utils/browser\";\nimport { getWindow } from \"../../../core/utils/window\";\nimport BaseModule from \"./base\";\nvar DropImageModule = BaseModule;\n\nif (Quill) {\n  DropImageModule = class extends BaseModule {\n    constructor(quill, options) {\n      super(quill, options);\n      var widgetName = this.editorInstance.NAME;\n      eventsEngine.on(this.quill.root, addNamespace(\"drop\", widgetName), this._dropHandler.bind(this));\n      eventsEngine.on(this.quill.root, addNamespace(\"paste\", widgetName), this._pasteHandler.bind(this));\n    }\n\n    _dropHandler(e) {\n      var _dataTransfer$files;\n\n      var dataTransfer = e.originalEvent.dataTransfer;\n      var hasFiles = null === dataTransfer || void 0 === dataTransfer ? void 0 : null === (_dataTransfer$files = dataTransfer.files) || void 0 === _dataTransfer$files ? void 0 : _dataTransfer$files.length;\n      this.saveValueChangeEvent(e);\n      e.preventDefault();\n\n      if (hasFiles) {\n        this._getImage(dataTransfer.files, this._addImage.bind(this));\n      }\n    }\n\n    _pasteHandler(e) {\n      var _clipboardData$items;\n\n      var {\n        clipboardData: clipboardData\n      } = e.originalEvent;\n      this.saveValueChangeEvent(e);\n\n      if (!clipboardData) {\n        return;\n      }\n\n      var hasDataItems = null === (_clipboardData$items = clipboardData.items) || void 0 === _clipboardData$items ? void 0 : _clipboardData$items.length;\n      var isHtmlData = clipboardData.getData(\"text/html\");\n\n      if (!isHtmlData && hasDataItems) {\n        this._getImage(clipboardData.items, imageData => {\n          if (this._isBrowserSupportImagePaste(browser)) {\n            return;\n          }\n\n          this._addImage(imageData);\n        });\n      }\n    }\n\n    _isBrowserSupportImagePaste(_ref) {\n      var {\n        mozilla: mozilla,\n        chrome: chrome,\n        version: version\n      } = _ref;\n      return mozilla || chrome && version > 82;\n    }\n\n    _isImage(file) {\n      return !!file.type.match(/^image\\/(a?png|bmp|gif|p?jpe?g|svg|vnd\\.microsoft\\.icon|webp)/i);\n    }\n\n    _getImage(files, callback) {\n      var window = getWindow();\n      each(files, (index, file) => {\n        if (!this._isImage(file)) {\n          return;\n        }\n\n        var reader = new window.FileReader();\n\n        reader.onload = _ref2 => {\n          var {\n            target: target\n          } = _ref2;\n          callback(target.result);\n        };\n\n        var readableFile = file.getAsFile ? file.getAsFile() : file;\n\n        if (readableFile instanceof window.Blob) {\n          reader.readAsDataURL(readableFile);\n        }\n      });\n    }\n\n    _addImage(data) {\n      var selection = this.quill.getSelection();\n      var pasteIndex = selection ? selection.index : this.quill.getLength();\n      this.quill.insertEmbed(pasteIndex, \"extendedImage\", data, \"user\");\n    }\n\n  };\n}\n\nexport default DropImageModule;","map":{"version":3,"names":["Quill","eventsEngine","addNamespace","each","browser","getWindow","BaseModule","DropImageModule","constructor","quill","options","widgetName","editorInstance","NAME","on","root","_dropHandler","bind","_pasteHandler","e","_dataTransfer$files","dataTransfer","originalEvent","hasFiles","files","length","saveValueChangeEvent","preventDefault","_getImage","_addImage","_clipboardData$items","clipboardData","hasDataItems","items","isHtmlData","getData","imageData","_isBrowserSupportImagePaste","_ref","mozilla","chrome","version","_isImage","file","type","match","callback","window","index","reader","FileReader","onload","_ref2","target","result","readableFile","getAsFile","Blob","readAsDataURL","data","selection","getSelection","pasteIndex","getLength","insertEmbed"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/ui/html_editor/modules/dropImage.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/html_editor/modules/dropImage.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport Quill from \"devextreme-quill\";\r\nimport eventsEngine from \"../../../events/core/events_engine\";\r\nimport {\r\n    addNamespace\r\n} from \"../../../events/utils/index\";\r\nimport {\r\n    each\r\n} from \"../../../core/utils/iterator\";\r\nimport browser from \"../../../core/utils/browser\";\r\nimport {\r\n    getWindow\r\n} from \"../../../core/utils/window\";\r\nimport BaseModule from \"./base\";\r\nvar DropImageModule = BaseModule;\r\nif (Quill) {\r\n    DropImageModule = class extends BaseModule {\r\n        constructor(quill, options) {\r\n            super(quill, options);\r\n            var widgetName = this.editorInstance.NAME;\r\n            eventsEngine.on(this.quill.root, addNamespace(\"drop\", widgetName), this._dropHandler.bind(this));\r\n            eventsEngine.on(this.quill.root, addNamespace(\"paste\", widgetName), this._pasteHandler.bind(this))\r\n        }\r\n        _dropHandler(e) {\r\n            var _dataTransfer$files;\r\n            var dataTransfer = e.originalEvent.dataTransfer;\r\n            var hasFiles = null === dataTransfer || void 0 === dataTransfer ? void 0 : null === (_dataTransfer$files = dataTransfer.files) || void 0 === _dataTransfer$files ? void 0 : _dataTransfer$files.length;\r\n            this.saveValueChangeEvent(e);\r\n            e.preventDefault();\r\n            if (hasFiles) {\r\n                this._getImage(dataTransfer.files, this._addImage.bind(this))\r\n            }\r\n        }\r\n        _pasteHandler(e) {\r\n            var _clipboardData$items;\r\n            var {\r\n                clipboardData: clipboardData\r\n            } = e.originalEvent;\r\n            this.saveValueChangeEvent(e);\r\n            if (!clipboardData) {\r\n                return\r\n            }\r\n            var hasDataItems = null === (_clipboardData$items = clipboardData.items) || void 0 === _clipboardData$items ? void 0 : _clipboardData$items.length;\r\n            var isHtmlData = clipboardData.getData(\"text/html\");\r\n            if (!isHtmlData && hasDataItems) {\r\n                this._getImage(clipboardData.items, imageData => {\r\n                    if (this._isBrowserSupportImagePaste(browser)) {\r\n                        return\r\n                    }\r\n                    this._addImage(imageData)\r\n                })\r\n            }\r\n        }\r\n        _isBrowserSupportImagePaste(_ref) {\r\n            var {\r\n                mozilla: mozilla,\r\n                chrome: chrome,\r\n                version: version\r\n            } = _ref;\r\n            return mozilla || chrome && version > 82\r\n        }\r\n        _isImage(file) {\r\n            return !!file.type.match(/^image\\/(a?png|bmp|gif|p?jpe?g|svg|vnd\\.microsoft\\.icon|webp)/i)\r\n        }\r\n        _getImage(files, callback) {\r\n            var window = getWindow();\r\n            each(files, (index, file) => {\r\n                if (!this._isImage(file)) {\r\n                    return\r\n                }\r\n                var reader = new window.FileReader;\r\n                reader.onload = _ref2 => {\r\n                    var {\r\n                        target: target\r\n                    } = _ref2;\r\n                    callback(target.result)\r\n                };\r\n                var readableFile = file.getAsFile ? file.getAsFile() : file;\r\n                if (readableFile instanceof window.Blob) {\r\n                    reader.readAsDataURL(readableFile)\r\n                }\r\n            })\r\n        }\r\n        _addImage(data) {\r\n            var selection = this.quill.getSelection();\r\n            var pasteIndex = selection ? selection.index : this.quill.getLength();\r\n            this.quill.insertEmbed(pasteIndex, \"extendedImage\", data, \"user\")\r\n        }\r\n    }\r\n}\r\nexport default DropImageModule;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,KAAP,MAAkB,kBAAlB;AACA,OAAOC,YAAP,MAAyB,oCAAzB;AACA,SACIC,YADJ,QAEO,6BAFP;AAGA,SACIC,IADJ,QAEO,8BAFP;AAGA,OAAOC,OAAP,MAAoB,6BAApB;AACA,SACIC,SADJ,QAEO,4BAFP;AAGA,OAAOC,UAAP,MAAuB,QAAvB;AACA,IAAIC,eAAe,GAAGD,UAAtB;;AACA,IAAIN,KAAJ,EAAW;EACPO,eAAe,GAAG,cAAcD,UAAd,CAAyB;IACvCE,WAAW,CAACC,KAAD,EAAQC,OAAR,EAAiB;MACxB,MAAMD,KAAN,EAAaC,OAAb;MACA,IAAIC,UAAU,GAAG,KAAKC,cAAL,CAAoBC,IAArC;MACAZ,YAAY,CAACa,EAAb,CAAgB,KAAKL,KAAL,CAAWM,IAA3B,EAAiCb,YAAY,CAAC,MAAD,EAASS,UAAT,CAA7C,EAAmE,KAAKK,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAAnE;MACAhB,YAAY,CAACa,EAAb,CAAgB,KAAKL,KAAL,CAAWM,IAA3B,EAAiCb,YAAY,CAAC,OAAD,EAAUS,UAAV,CAA7C,EAAoE,KAAKO,aAAL,CAAmBD,IAAnB,CAAwB,IAAxB,CAApE;IACH;;IACDD,YAAY,CAACG,CAAD,EAAI;MACZ,IAAIC,mBAAJ;;MACA,IAAIC,YAAY,GAAGF,CAAC,CAACG,aAAF,CAAgBD,YAAnC;MACA,IAAIE,QAAQ,GAAG,SAASF,YAAT,IAAyB,KAAK,CAAL,KAAWA,YAApC,GAAmD,KAAK,CAAxD,GAA4D,UAAUD,mBAAmB,GAAGC,YAAY,CAACG,KAA7C,KAAuD,KAAK,CAAL,KAAWJ,mBAAlE,GAAwF,KAAK,CAA7F,GAAiGA,mBAAmB,CAACK,MAAhM;MACA,KAAKC,oBAAL,CAA0BP,CAA1B;MACAA,CAAC,CAACQ,cAAF;;MACA,IAAIJ,QAAJ,EAAc;QACV,KAAKK,SAAL,CAAeP,YAAY,CAACG,KAA5B,EAAmC,KAAKK,SAAL,CAAeZ,IAAf,CAAoB,IAApB,CAAnC;MACH;IACJ;;IACDC,aAAa,CAACC,CAAD,EAAI;MACb,IAAIW,oBAAJ;;MACA,IAAI;QACAC,aAAa,EAAEA;MADf,IAEAZ,CAAC,CAACG,aAFN;MAGA,KAAKI,oBAAL,CAA0BP,CAA1B;;MACA,IAAI,CAACY,aAAL,EAAoB;QAChB;MACH;;MACD,IAAIC,YAAY,GAAG,UAAUF,oBAAoB,GAAGC,aAAa,CAACE,KAA/C,KAAyD,KAAK,CAAL,KAAWH,oBAApE,GAA2F,KAAK,CAAhG,GAAoGA,oBAAoB,CAACL,MAA5I;MACA,IAAIS,UAAU,GAAGH,aAAa,CAACI,OAAd,CAAsB,WAAtB,CAAjB;;MACA,IAAI,CAACD,UAAD,IAAeF,YAAnB,EAAiC;QAC7B,KAAKJ,SAAL,CAAeG,aAAa,CAACE,KAA7B,EAAoCG,SAAS,IAAI;UAC7C,IAAI,KAAKC,2BAAL,CAAiCjC,OAAjC,CAAJ,EAA+C;YAC3C;UACH;;UACD,KAAKyB,SAAL,CAAeO,SAAf;QACH,CALD;MAMH;IACJ;;IACDC,2BAA2B,CAACC,IAAD,EAAO;MAC9B,IAAI;QACAC,OAAO,EAAEA,OADT;QAEAC,MAAM,EAAEA,MAFR;QAGAC,OAAO,EAAEA;MAHT,IAIAH,IAJJ;MAKA,OAAOC,OAAO,IAAIC,MAAM,IAAIC,OAAO,GAAG,EAAtC;IACH;;IACDC,QAAQ,CAACC,IAAD,EAAO;MACX,OAAO,CAAC,CAACA,IAAI,CAACC,IAAL,CAAUC,KAAV,CAAgB,gEAAhB,CAAT;IACH;;IACDjB,SAAS,CAACJ,KAAD,EAAQsB,QAAR,EAAkB;MACvB,IAAIC,MAAM,GAAG1C,SAAS,EAAtB;MACAF,IAAI,CAACqB,KAAD,EAAQ,CAACwB,KAAD,EAAQL,IAAR,KAAiB;QACzB,IAAI,CAAC,KAAKD,QAAL,CAAcC,IAAd,CAAL,EAA0B;UACtB;QACH;;QACD,IAAIM,MAAM,GAAG,IAAIF,MAAM,CAACG,UAAX,EAAb;;QACAD,MAAM,CAACE,MAAP,GAAgBC,KAAK,IAAI;UACrB,IAAI;YACAC,MAAM,EAAEA;UADR,IAEAD,KAFJ;UAGAN,QAAQ,CAACO,MAAM,CAACC,MAAR,CAAR;QACH,CALD;;QAMA,IAAIC,YAAY,GAAGZ,IAAI,CAACa,SAAL,GAAiBb,IAAI,CAACa,SAAL,EAAjB,GAAoCb,IAAvD;;QACA,IAAIY,YAAY,YAAYR,MAAM,CAACU,IAAnC,EAAyC;UACrCR,MAAM,CAACS,aAAP,CAAqBH,YAArB;QACH;MACJ,CAfG,CAAJ;IAgBH;;IACD1B,SAAS,CAAC8B,IAAD,EAAO;MACZ,IAAIC,SAAS,GAAG,KAAKnD,KAAL,CAAWoD,YAAX,EAAhB;MACA,IAAIC,UAAU,GAAGF,SAAS,GAAGA,SAAS,CAACZ,KAAb,GAAqB,KAAKvC,KAAL,CAAWsD,SAAX,EAA/C;MACA,KAAKtD,KAAL,CAAWuD,WAAX,CAAuBF,UAAvB,EAAmC,eAAnC,EAAoDH,IAApD,EAA0D,MAA1D;IACH;;EAvEsC,CAA3C;AAyEH;;AACD,eAAepD,eAAf"},"metadata":{},"sourceType":"module"}