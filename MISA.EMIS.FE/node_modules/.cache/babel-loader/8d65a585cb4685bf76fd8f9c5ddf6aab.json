{"ast":null,"code":"/**\r\n * DevExtreme (esm/data/store_helper.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { grep } from \"../core/utils/common\";\nimport { extend } from \"../core/utils/extend\";\nimport { each } from \"../core/utils/iterator\";\nimport arrayQuery from \"./array_query\";\nimport { normalizeSortingInfo } from \"./utils\";\n\nfunction multiLevelGroup(query, groupInfo) {\n  query = query.groupBy(groupInfo[0].selector);\n\n  if (groupInfo.length > 1) {\n    query = query.select(function (g) {\n      return extend({}, g, {\n        items: multiLevelGroup(arrayQuery(g.items), groupInfo.slice(1)).toArray()\n      });\n    });\n  }\n\n  return query;\n}\n\nfunction arrangeSortingInfo(groupInfo, sortInfo) {\n  var filteredGroup = [];\n  each(groupInfo, function (_, group) {\n    var collision = grep(sortInfo, function (sort) {\n      return group.selector === sort.selector;\n    });\n\n    if (collision.length < 1) {\n      filteredGroup.push(group);\n    }\n  });\n  return filteredGroup.concat(sortInfo);\n}\n\nfunction queryByOptions(query, options, isCountQuery) {\n  options = options || {};\n  var filter = options.filter;\n\n  if (filter) {\n    query = query.filter(filter);\n  }\n\n  if (isCountQuery) {\n    return query;\n  }\n\n  var sort = options.sort;\n  var select = options.select;\n  var group = options.group;\n  var skip = options.skip;\n  var take = options.take;\n\n  if (group) {\n    group = normalizeSortingInfo(group);\n    group.keepInitialKeyOrder = !!options.group.keepInitialKeyOrder;\n  }\n\n  if (sort || group) {\n    sort = normalizeSortingInfo(sort || []);\n\n    if (group && !group.keepInitialKeyOrder) {\n      sort = arrangeSortingInfo(group, sort);\n    }\n\n    each(sort, function (index) {\n      query = query[index ? \"thenBy\" : \"sortBy\"](this.selector, this.desc, this.compare);\n    });\n  }\n\n  if (select) {\n    query = query.select(select);\n  }\n\n  if (group) {\n    query = multiLevelGroup(query, group);\n  }\n\n  if (take || skip) {\n    query = query.slice(skip || 0, take);\n  }\n\n  return query;\n}\n\nexport default {\n  multiLevelGroup: multiLevelGroup,\n  arrangeSortingInfo: arrangeSortingInfo,\n  queryByOptions: queryByOptions\n};","map":{"version":3,"names":["grep","extend","each","arrayQuery","normalizeSortingInfo","multiLevelGroup","query","groupInfo","groupBy","selector","length","select","g","items","slice","toArray","arrangeSortingInfo","sortInfo","filteredGroup","_","group","collision","sort","push","concat","queryByOptions","options","isCountQuery","filter","skip","take","keepInitialKeyOrder","index","desc","compare"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/data/store_helper.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/data/store_helper.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    grep\r\n} from \"../core/utils/common\";\r\nimport {\r\n    extend\r\n} from \"../core/utils/extend\";\r\nimport {\r\n    each\r\n} from \"../core/utils/iterator\";\r\nimport arrayQuery from \"./array_query\";\r\nimport {\r\n    normalizeSortingInfo\r\n} from \"./utils\";\r\n\r\nfunction multiLevelGroup(query, groupInfo) {\r\n    query = query.groupBy(groupInfo[0].selector);\r\n    if (groupInfo.length > 1) {\r\n        query = query.select((function(g) {\r\n            return extend({}, g, {\r\n                items: multiLevelGroup(arrayQuery(g.items), groupInfo.slice(1)).toArray()\r\n            })\r\n        }))\r\n    }\r\n    return query\r\n}\r\n\r\nfunction arrangeSortingInfo(groupInfo, sortInfo) {\r\n    var filteredGroup = [];\r\n    each(groupInfo, (function(_, group) {\r\n        var collision = grep(sortInfo, (function(sort) {\r\n            return group.selector === sort.selector\r\n        }));\r\n        if (collision.length < 1) {\r\n            filteredGroup.push(group)\r\n        }\r\n    }));\r\n    return filteredGroup.concat(sortInfo)\r\n}\r\n\r\nfunction queryByOptions(query, options, isCountQuery) {\r\n    options = options || {};\r\n    var filter = options.filter;\r\n    if (filter) {\r\n        query = query.filter(filter)\r\n    }\r\n    if (isCountQuery) {\r\n        return query\r\n    }\r\n    var sort = options.sort;\r\n    var select = options.select;\r\n    var group = options.group;\r\n    var skip = options.skip;\r\n    var take = options.take;\r\n    if (group) {\r\n        group = normalizeSortingInfo(group);\r\n        group.keepInitialKeyOrder = !!options.group.keepInitialKeyOrder\r\n    }\r\n    if (sort || group) {\r\n        sort = normalizeSortingInfo(sort || []);\r\n        if (group && !group.keepInitialKeyOrder) {\r\n            sort = arrangeSortingInfo(group, sort)\r\n        }\r\n        each(sort, (function(index) {\r\n            query = query[index ? \"thenBy\" : \"sortBy\"](this.selector, this.desc, this.compare)\r\n        }))\r\n    }\r\n    if (select) {\r\n        query = query.select(select)\r\n    }\r\n    if (group) {\r\n        query = multiLevelGroup(query, group)\r\n    }\r\n    if (take || skip) {\r\n        query = query.slice(skip || 0, take)\r\n    }\r\n    return query\r\n}\r\nexport default {\r\n    multiLevelGroup: multiLevelGroup,\r\n    arrangeSortingInfo: arrangeSortingInfo,\r\n    queryByOptions: queryByOptions\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}