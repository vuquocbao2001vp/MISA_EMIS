{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/pivot_grid/ui.pivot_grid.summary_display_modes.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { isFunction, isDefined, isObject } from \"../../core/utils/type\";\nimport { extend } from \"../../core/utils/extend\";\nimport { findField, foreachTree, setFieldProperty } from \"./ui.pivot_grid.utils\";\nvar COLUMN = \"column\";\nvar ROW = \"row\";\nvar NULL = null;\n\nvar calculatePercentValue = function (value, totalValue) {\n  var result = value / totalValue;\n\n  if (!isDefined(value) || isNaN(result)) {\n    result = NULL;\n  }\n\n  return result;\n};\n\nvar _percentOfGrandTotal = function (e, dimension) {\n  return calculatePercentValue(e.value(), e.grandTotal(dimension).value());\n};\n\nvar percentOfParent = function (e, dimension) {\n  var parent = e.parent(dimension);\n  var parentValue = parent ? parent.value() : e.value();\n  return calculatePercentValue(e.value(), parentValue);\n};\n\nvar createAbsoluteVariationExp = function (allowCrossGroup) {\n  return function (e) {\n    var prevCell = e.prev(COLUMN, allowCrossGroup);\n    var prevValue = prevCell && prevCell.value();\n\n    if (isDefined(prevValue) && isDefined(e.value())) {\n      return e.value() - prevValue;\n    }\n\n    return NULL;\n  };\n};\n\nvar createPercentVariationExp = function (allowCrossGroup) {\n  var absoluteExp = createAbsoluteVariationExp(allowCrossGroup);\n  return function (e) {\n    var absVar = absoluteExp(e);\n    var prevCell = e.prev(COLUMN, allowCrossGroup);\n    var prevValue = prevCell && prevCell.value();\n    return absVar !== NULL && prevValue ? absVar / prevValue : NULL;\n  };\n};\n\nvar summaryDictionary = {\n  percentOfColumnTotal: function (e) {\n    return percentOfParent(e, ROW);\n  },\n  percentOfRowTotal: function (e) {\n    return percentOfParent(e, COLUMN);\n  },\n  percentOfColumnGrandTotal: function (e) {\n    return _percentOfGrandTotal(e, ROW);\n  },\n  percentOfRowGrandTotal: function (e) {\n    return _percentOfGrandTotal(e, COLUMN);\n  },\n  percentOfGrandTotal: function (e) {\n    return _percentOfGrandTotal(e);\n  }\n};\n\nvar getPrevCellCrossGroup = function getPrevCellCrossGroup(cell, direction) {\n  if (!cell || !cell.parent(direction)) {\n    return;\n  }\n\n  var prevCell = cell.prev(direction);\n\n  if (!prevCell) {\n    prevCell = getPrevCellCrossGroup(cell.parent(direction), direction);\n  }\n\n  return prevCell;\n};\n\nvar createRunningTotalExpr = function (field) {\n  if (!field.runningTotal) {\n    return;\n  }\n\n  var direction = field.runningTotal === COLUMN ? ROW : COLUMN;\n  return function (e) {\n    var prevCell = field.allowCrossGroupCalculation ? getPrevCellCrossGroup(e, direction) : e.prev(direction, false);\n    var value = e.value(true);\n    var prevValue = prevCell && prevCell.value(true);\n\n    if (isDefined(prevValue) && isDefined(value)) {\n      value = prevValue + value;\n    } else if (isDefined(prevValue)) {\n      value = prevValue;\n    }\n\n    return value;\n  };\n};\n\nfunction createCache() {\n  return {\n    fields: {},\n    positions: {}\n  };\n}\n\nfunction getFieldPos(descriptions, field, cache) {\n  var fieldParams = {\n    index: -1\n  };\n\n  if (!isObject(field)) {\n    if (cache.fields[field]) {\n      field = cache[field];\n    } else {\n      var allFields = descriptions.columns.concat(descriptions.rows).concat(descriptions.values);\n      var fieldIndex = findField(allFields, field);\n      field = cache[field] = allFields[fieldIndex];\n    }\n  }\n\n  if (field) {\n    var area = field.area || \"data\";\n    fieldParams = cache.positions[field.index] = cache.positions[field.index] || {\n      area: area,\n      index: descriptions[\"data\" === area ? \"values\" : area + \"s\"].indexOf(field)\n    };\n  }\n\n  return fieldParams;\n}\n\nfunction getPathFieldName(dimension) {\n  return dimension === ROW ? \"_rowPath\" : \"_columnPath\";\n}\n\nvar SummaryCell = function (columnPath, rowPath, data, descriptions, fieldIndex, fieldsCache) {\n  this._columnPath = columnPath;\n  this._rowPath = rowPath;\n  this._fieldIndex = fieldIndex;\n  this._fieldsCache = fieldsCache || createCache();\n  this._data = data;\n  this._descriptions = descriptions;\n  var cell = data.values && data.values[rowPath[0].index] && data.values[rowPath[0].index][columnPath[0].index];\n\n  if (cell) {\n    cell.originalCell = cell.originalCell || cell.slice();\n    cell.postProcessedFlags = cell.postProcessedFlags || [];\n    this._cell = cell;\n  }\n};\n\nSummaryCell.prototype = extend(SummaryCell.prototype, {\n  _getPath: function (dimension) {\n    return this[getPathFieldName(dimension)];\n  },\n  _getDimension: function (dimension) {\n    dimension = dimension === ROW ? \"rows\" : \"columns\";\n    return this._descriptions[dimension];\n  },\n  _createCell: function (config) {\n    return new SummaryCell(config._columnPath || this._columnPath, config._rowPath || this._rowPath, this._data, this._descriptions, this._fieldIndex);\n  },\n  parent: function (direction) {\n    var path = this._getPath(direction).slice();\n\n    var config = {};\n    path.shift();\n\n    if (path.length) {\n      config[getPathFieldName(direction)] = path;\n      return this._createCell(config);\n    }\n\n    return NULL;\n  },\n  children: function (direction) {\n    var path = this._getPath(direction).slice();\n\n    var item = path[0];\n    var result = [];\n    var cellConfig = {};\n\n    if (item.children) {\n      for (var i = 0; i < item.children.length; i++) {\n        cellConfig[getPathFieldName(direction)] = [item.children[i]].concat(path.slice());\n        result.push(this._createCell(cellConfig));\n      }\n    }\n\n    return result;\n  },\n  grandTotal: function (direction) {\n    var config = {};\n    var rowPath = this._rowPath;\n    var columnPath = this._columnPath;\n\n    var dimensionPath = this._getPath(direction);\n\n    var pathFieldName = getPathFieldName(direction);\n\n    if (!direction) {\n      config._rowPath = [rowPath[rowPath.length - 1]];\n      config._columnPath = [columnPath[columnPath.length - 1]];\n    } else {\n      config[pathFieldName] = [dimensionPath[dimensionPath.length - 1]];\n    }\n\n    return this._createCell(config);\n  },\n  next: function (direction, allowCrossGroup) {\n    var currentPath = this._getPath(direction);\n\n    var item = currentPath[0];\n    var parent = this.parent(direction);\n    var siblings;\n\n    if (parent) {\n      var index = currentPath[1].children.indexOf(item);\n      siblings = parent.children(direction);\n\n      if (siblings[index + 1]) {\n        return siblings[index + 1];\n      }\n    }\n\n    if (allowCrossGroup && parent) {\n      do {\n        parent = parent.next(direction, allowCrossGroup);\n        siblings = parent ? parent.children(direction) : [];\n      } while (parent && !siblings.length);\n\n      return siblings[0] || NULL;\n    }\n\n    return NULL;\n  },\n  prev: function (direction, allowCrossGroup) {\n    var currentPath = this._getPath(direction);\n\n    var item = currentPath[0];\n    var parent = this.parent(direction);\n    var siblings;\n\n    if (parent) {\n      var index = currentPath[1].children.indexOf(item);\n      siblings = parent.children(direction);\n\n      if (siblings[index - 1]) {\n        return siblings[index - 1];\n      }\n    }\n\n    if (allowCrossGroup && parent) {\n      do {\n        parent = parent.prev(direction, allowCrossGroup);\n        siblings = parent ? parent.children(direction) : [];\n      } while (parent && !siblings.length);\n\n      return siblings[siblings.length - 1] || NULL;\n    }\n\n    return NULL;\n  },\n  cell: function () {\n    return this._cell;\n  },\n  field: function (area) {\n    if (\"data\" === area) {\n      return this._descriptions.values[this._fieldIndex];\n    }\n\n    var path = this._getPath(area);\n\n    var descriptions = this._getDimension(area);\n\n    var field = descriptions[path.length - 2];\n    return field || NULL;\n  },\n  child: function (direction, fieldValue) {\n    var children = this.children(direction);\n\n    for (var i = 0; i < children.length; i++) {\n      var childLevelField = childLevelField || children[i].field(direction);\n\n      if (children[i].value(childLevelField) === fieldValue) {\n        return children[i];\n      }\n    }\n\n    return NULL;\n  },\n  slice: function (field, value) {\n    var config = {};\n    var fieldPos = getFieldPos(this._descriptions, field, this._fieldsCache);\n    var area = fieldPos.area;\n    var fieldIndex = fieldPos.index;\n    var sliceCell = NULL;\n\n    if (area === ROW || area === COLUMN) {\n      var path = this._getPath(area).slice();\n\n      var level = -1 !== fieldIndex && path.length - 2 - fieldIndex;\n\n      if (path[level]) {\n        [][path.length - 1] = path[path.length - 1];\n\n        for (var i = level; i >= 0; i--) {\n          if (path[i + 1]) {\n            var childItems = path[i + 1].children || [];\n            var currentValue = i === level ? value : path[i].value;\n            path[i] = void 0;\n\n            for (var childIndex = 0; childIndex < childItems.length; childIndex++) {\n              if (childItems[childIndex].value === currentValue) {\n                path[i] = childItems[childIndex];\n                break;\n              }\n            }\n          }\n\n          if (void 0 === path[i]) {\n            return sliceCell;\n          }\n        }\n\n        config[getPathFieldName(area)] = path;\n        sliceCell = this._createCell(config);\n      }\n    }\n\n    return sliceCell;\n  },\n  value: function (arg1, arg2) {\n    var cell = this._cell;\n    var fieldIndex = this._fieldIndex;\n    var fistArgIsBoolean = true === arg1 || false === arg1;\n    var field = !fistArgIsBoolean ? arg1 : NULL;\n    var needCalculatedValue = fistArgIsBoolean && arg1 || arg2;\n\n    if (isDefined(field)) {\n      var fieldPos = getFieldPos(this._descriptions, field, this._fieldsCache);\n      fieldIndex = fieldPos.index;\n\n      if (\"data\" !== fieldPos.area) {\n        var path = this._getPath(fieldPos.area);\n\n        var level = -1 !== fieldIndex && path.length - 2 - fieldIndex;\n        return path[level] && path[level].value;\n      }\n    }\n\n    if (cell && cell.originalCell) {\n      return needCalculatedValue ? cell[fieldIndex] : cell.originalCell[fieldIndex];\n    }\n\n    return NULL;\n  },\n\n  isPostProcessed(field) {\n    var fieldIndex = this._fieldIndex;\n\n    if (isDefined(field)) {\n      var fieldPos = getFieldPos(this._descriptions, field, this._fieldsCache);\n      fieldIndex = fieldPos.index;\n\n      if (\"data\" !== fieldPos.area) {\n        return false;\n      }\n    }\n\n    return !!(this._cell && this._cell.postProcessedFlags[fieldIndex]);\n  }\n\n});\n\nfunction getExpression(field) {\n  var summaryDisplayMode = field.summaryDisplayMode;\n  var crossGroupCalculation = field.allowCrossGroupCalculation;\n  var expression = NULL;\n\n  if (isFunction(field.calculateSummaryValue)) {\n    expression = field.calculateSummaryValue;\n  } else if (summaryDisplayMode) {\n    if (\"absoluteVariation\" === summaryDisplayMode) {\n      expression = createAbsoluteVariationExp(crossGroupCalculation);\n    } else if (\"percentVariation\" === summaryDisplayMode) {\n      expression = createPercentVariationExp(crossGroupCalculation);\n    } else {\n      expression = summaryDictionary[summaryDisplayMode];\n    }\n\n    if (expression && !field.format && -1 !== summaryDisplayMode.indexOf(\"percent\")) {\n      setFieldProperty(field, \"format\", \"percent\");\n    }\n  }\n\n  return expression;\n}\n\nfunction processDataCell(data, rowIndex, columnIndex, isRunningTotalCalculation) {\n  var values = data.values[rowIndex][columnIndex] = data.values[rowIndex][columnIndex] || [];\n  var originalCell = values.originalCell;\n\n  if (!originalCell) {\n    return;\n  }\n\n  if (values.allowResetting || !isRunningTotalCalculation) {\n    data.values[rowIndex][columnIndex] = originalCell.slice();\n  }\n\n  data.values[rowIndex][columnIndex].allowResetting = isRunningTotalCalculation;\n}\n\nexport function applyDisplaySummaryMode(descriptions, data) {\n  var expressions = [];\n  var columnElements = [{\n    index: data.grandTotalColumnIndex,\n    children: data.columns\n  }];\n  var rowElements = [{\n    index: data.grandTotalRowIndex,\n    children: data.rows\n  }];\n  var valueFields = descriptions.values;\n  var fieldsCache = createCache();\n  data.values = data.values || [];\n  foreachTree(columnElements, columnPath => {\n    columnPath[0].isEmpty = [];\n  }, false);\n  foreachTree(rowElements, function (rowPath) {\n    var rowItem = rowPath[0];\n    rowItem.isEmpty = [];\n    data.values[rowItem.index] = data.values[rowItem.index] || [];\n    foreachTree(columnElements, function (columnPath) {\n      var columnItem = columnPath[0];\n      var isEmptyCell;\n      processDataCell(data, rowItem.index, columnItem.index, false);\n\n      for (var i = 0; i < valueFields.length; i++) {\n        var field = valueFields[i];\n        var expression = expressions[i] = void 0 === expressions[i] ? getExpression(field) : expressions[i];\n        isEmptyCell = false;\n\n        if (expression) {\n          var expressionArg = new SummaryCell(columnPath, rowPath, data, descriptions, i, fieldsCache);\n          var cell = expressionArg.cell();\n          var value = cell[i] = expression(expressionArg);\n          cell.postProcessedFlags[i] = true;\n          isEmptyCell = null === value || void 0 === value;\n        }\n\n        if (void 0 === columnItem.isEmpty[i]) {\n          columnItem.isEmpty[i] = true;\n        }\n\n        if (void 0 === rowItem.isEmpty[i]) {\n          rowItem.isEmpty[i] = true;\n        }\n\n        if (!isEmptyCell) {\n          rowItem.isEmpty[i] = columnItem.isEmpty[i] = false;\n        }\n      }\n    }, false);\n  }, false);\n  data.isEmptyGrandTotalRow = rowElements[0].isEmpty;\n  data.isEmptyGrandTotalColumn = columnElements[0].isEmpty;\n}\nexport function applyRunningTotal(descriptions, data) {\n  var expressions = [];\n  var columnElements = [{\n    index: data.grandTotalColumnIndex,\n    children: data.columns\n  }];\n  var rowElements = [{\n    index: data.grandTotalRowIndex,\n    children: data.rows\n  }];\n  var valueFields = descriptions.values;\n  var fieldsCache = createCache();\n  data.values = data.values || [];\n  foreachTree(rowElements, function (rowPath) {\n    var rowItem = rowPath[0];\n    data.values[rowItem.index] = data.values[rowItem.index] || [];\n    foreachTree(columnElements, function (columnPath) {\n      var columnItem = columnPath[0];\n      processDataCell(data, rowItem.index, columnItem.index, true);\n\n      for (var i = 0; i < valueFields.length; i++) {\n        var field = valueFields[i];\n        var expression = expressions[i] = void 0 === expressions[i] ? createRunningTotalExpr(field) : expressions[i];\n\n        if (expression) {\n          var expressionArg = new SummaryCell(columnPath, rowPath, data, descriptions, i, fieldsCache);\n          var cell = expressionArg.cell();\n          cell[i] = expression(expressionArg);\n          cell.postProcessedFlags[i] = true;\n        }\n      }\n    }, false);\n  }, false);\n}\nexport function createMockSummaryCell(descriptions, fields, indices) {\n  var summaryCell = new SummaryCell([], [], {}, descriptions, 0);\n\n  summaryCell.value = function (fieldId) {\n    if (isDefined(fieldId)) {\n      var index = findField(fields, fieldId);\n      var field = fields[index];\n\n      if (!indices[index] && field && !isDefined(field.area)) {\n        descriptions.values.push(field);\n        indices[index] = true;\n      }\n    }\n  };\n\n  summaryCell.grandTotal = function () {\n    return this;\n  };\n\n  summaryCell.children = function () {\n    return [];\n  };\n\n  return summaryCell;\n}","map":{"version":3,"names":["isFunction","isDefined","isObject","extend","findField","foreachTree","setFieldProperty","COLUMN","ROW","NULL","calculatePercentValue","value","totalValue","result","isNaN","_percentOfGrandTotal","e","dimension","grandTotal","percentOfParent","parent","parentValue","createAbsoluteVariationExp","allowCrossGroup","prevCell","prev","prevValue","createPercentVariationExp","absoluteExp","absVar","summaryDictionary","percentOfColumnTotal","percentOfRowTotal","percentOfColumnGrandTotal","percentOfRowGrandTotal","percentOfGrandTotal","getPrevCellCrossGroup","cell","direction","createRunningTotalExpr","field","runningTotal","allowCrossGroupCalculation","createCache","fields","positions","getFieldPos","descriptions","cache","fieldParams","index","allFields","columns","concat","rows","values","fieldIndex","area","indexOf","getPathFieldName","SummaryCell","columnPath","rowPath","data","fieldsCache","_columnPath","_rowPath","_fieldIndex","_fieldsCache","_data","_descriptions","originalCell","slice","postProcessedFlags","_cell","prototype","_getPath","_getDimension","_createCell","config","path","shift","length","children","item","cellConfig","i","push","dimensionPath","pathFieldName","next","currentPath","siblings","child","fieldValue","childLevelField","fieldPos","sliceCell","level","childItems","currentValue","childIndex","arg1","arg2","fistArgIsBoolean","needCalculatedValue","isPostProcessed","getExpression","summaryDisplayMode","crossGroupCalculation","expression","calculateSummaryValue","format","processDataCell","rowIndex","columnIndex","isRunningTotalCalculation","allowResetting","applyDisplaySummaryMode","expressions","columnElements","grandTotalColumnIndex","rowElements","grandTotalRowIndex","valueFields","isEmpty","rowItem","columnItem","isEmptyCell","expressionArg","isEmptyGrandTotalRow","isEmptyGrandTotalColumn","applyRunningTotal","createMockSummaryCell","indices","summaryCell","fieldId"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/ui/pivot_grid/ui.pivot_grid.summary_display_modes.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/pivot_grid/ui.pivot_grid.summary_display_modes.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    isFunction,\r\n    isDefined,\r\n    isObject\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    findField,\r\n    foreachTree,\r\n    setFieldProperty\r\n} from \"./ui.pivot_grid.utils\";\r\nvar COLUMN = \"column\";\r\nvar ROW = \"row\";\r\nvar NULL = null;\r\nvar calculatePercentValue = function(value, totalValue) {\r\n    var result = value / totalValue;\r\n    if (!isDefined(value) || isNaN(result)) {\r\n        result = NULL\r\n    }\r\n    return result\r\n};\r\nvar _percentOfGrandTotal = function(e, dimension) {\r\n    return calculatePercentValue(e.value(), e.grandTotal(dimension).value())\r\n};\r\nvar percentOfParent = function(e, dimension) {\r\n    var parent = e.parent(dimension);\r\n    var parentValue = parent ? parent.value() : e.value();\r\n    return calculatePercentValue(e.value(), parentValue)\r\n};\r\nvar createAbsoluteVariationExp = function(allowCrossGroup) {\r\n    return function(e) {\r\n        var prevCell = e.prev(COLUMN, allowCrossGroup);\r\n        var prevValue = prevCell && prevCell.value();\r\n        if (isDefined(prevValue) && isDefined(e.value())) {\r\n            return e.value() - prevValue\r\n        }\r\n        return NULL\r\n    }\r\n};\r\nvar createPercentVariationExp = function(allowCrossGroup) {\r\n    var absoluteExp = createAbsoluteVariationExp(allowCrossGroup);\r\n    return function(e) {\r\n        var absVar = absoluteExp(e);\r\n        var prevCell = e.prev(COLUMN, allowCrossGroup);\r\n        var prevValue = prevCell && prevCell.value();\r\n        return absVar !== NULL && prevValue ? absVar / prevValue : NULL\r\n    }\r\n};\r\nvar summaryDictionary = {\r\n    percentOfColumnTotal: function(e) {\r\n        return percentOfParent(e, ROW)\r\n    },\r\n    percentOfRowTotal: function(e) {\r\n        return percentOfParent(e, COLUMN)\r\n    },\r\n    percentOfColumnGrandTotal: function(e) {\r\n        return _percentOfGrandTotal(e, ROW)\r\n    },\r\n    percentOfRowGrandTotal: function(e) {\r\n        return _percentOfGrandTotal(e, COLUMN)\r\n    },\r\n    percentOfGrandTotal: function(e) {\r\n        return _percentOfGrandTotal(e)\r\n    }\r\n};\r\nvar getPrevCellCrossGroup = function getPrevCellCrossGroup(cell, direction) {\r\n    if (!cell || !cell.parent(direction)) {\r\n        return\r\n    }\r\n    var prevCell = cell.prev(direction);\r\n    if (!prevCell) {\r\n        prevCell = getPrevCellCrossGroup(cell.parent(direction), direction)\r\n    }\r\n    return prevCell\r\n};\r\nvar createRunningTotalExpr = function(field) {\r\n    if (!field.runningTotal) {\r\n        return\r\n    }\r\n    var direction = field.runningTotal === COLUMN ? ROW : COLUMN;\r\n    return function(e) {\r\n        var prevCell = field.allowCrossGroupCalculation ? getPrevCellCrossGroup(e, direction) : e.prev(direction, false);\r\n        var value = e.value(true);\r\n        var prevValue = prevCell && prevCell.value(true);\r\n        if (isDefined(prevValue) && isDefined(value)) {\r\n            value = prevValue + value\r\n        } else if (isDefined(prevValue)) {\r\n            value = prevValue\r\n        }\r\n        return value\r\n    }\r\n};\r\n\r\nfunction createCache() {\r\n    return {\r\n        fields: {},\r\n        positions: {}\r\n    }\r\n}\r\n\r\nfunction getFieldPos(descriptions, field, cache) {\r\n    var fieldParams = {\r\n        index: -1\r\n    };\r\n    if (!isObject(field)) {\r\n        if (cache.fields[field]) {\r\n            field = cache[field]\r\n        } else {\r\n            var allFields = descriptions.columns.concat(descriptions.rows).concat(descriptions.values);\r\n            var fieldIndex = findField(allFields, field);\r\n            field = cache[field] = allFields[fieldIndex]\r\n        }\r\n    }\r\n    if (field) {\r\n        var area = field.area || \"data\";\r\n        fieldParams = cache.positions[field.index] = cache.positions[field.index] || {\r\n            area: area,\r\n            index: descriptions[\"data\" === area ? \"values\" : area + \"s\"].indexOf(field)\r\n        }\r\n    }\r\n    return fieldParams\r\n}\r\n\r\nfunction getPathFieldName(dimension) {\r\n    return dimension === ROW ? \"_rowPath\" : \"_columnPath\"\r\n}\r\nvar SummaryCell = function(columnPath, rowPath, data, descriptions, fieldIndex, fieldsCache) {\r\n    this._columnPath = columnPath;\r\n    this._rowPath = rowPath;\r\n    this._fieldIndex = fieldIndex;\r\n    this._fieldsCache = fieldsCache || createCache();\r\n    this._data = data;\r\n    this._descriptions = descriptions;\r\n    var cell = data.values && data.values[rowPath[0].index] && data.values[rowPath[0].index][columnPath[0].index];\r\n    if (cell) {\r\n        cell.originalCell = cell.originalCell || cell.slice();\r\n        cell.postProcessedFlags = cell.postProcessedFlags || [];\r\n        this._cell = cell\r\n    }\r\n};\r\nSummaryCell.prototype = extend(SummaryCell.prototype, {\r\n    _getPath: function(dimension) {\r\n        return this[getPathFieldName(dimension)]\r\n    },\r\n    _getDimension: function(dimension) {\r\n        dimension = dimension === ROW ? \"rows\" : \"columns\";\r\n        return this._descriptions[dimension]\r\n    },\r\n    _createCell: function(config) {\r\n        return new SummaryCell(config._columnPath || this._columnPath, config._rowPath || this._rowPath, this._data, this._descriptions, this._fieldIndex)\r\n    },\r\n    parent: function(direction) {\r\n        var path = this._getPath(direction).slice();\r\n        var config = {};\r\n        path.shift();\r\n        if (path.length) {\r\n            config[getPathFieldName(direction)] = path;\r\n            return this._createCell(config)\r\n        }\r\n        return NULL\r\n    },\r\n    children: function(direction) {\r\n        var path = this._getPath(direction).slice();\r\n        var item = path[0];\r\n        var result = [];\r\n        var cellConfig = {};\r\n        if (item.children) {\r\n            for (var i = 0; i < item.children.length; i++) {\r\n                cellConfig[getPathFieldName(direction)] = [item.children[i]].concat(path.slice());\r\n                result.push(this._createCell(cellConfig))\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    grandTotal: function(direction) {\r\n        var config = {};\r\n        var rowPath = this._rowPath;\r\n        var columnPath = this._columnPath;\r\n        var dimensionPath = this._getPath(direction);\r\n        var pathFieldName = getPathFieldName(direction);\r\n        if (!direction) {\r\n            config._rowPath = [rowPath[rowPath.length - 1]];\r\n            config._columnPath = [columnPath[columnPath.length - 1]]\r\n        } else {\r\n            config[pathFieldName] = [dimensionPath[dimensionPath.length - 1]]\r\n        }\r\n        return this._createCell(config)\r\n    },\r\n    next: function(direction, allowCrossGroup) {\r\n        var currentPath = this._getPath(direction);\r\n        var item = currentPath[0];\r\n        var parent = this.parent(direction);\r\n        var siblings;\r\n        if (parent) {\r\n            var index = currentPath[1].children.indexOf(item);\r\n            siblings = parent.children(direction);\r\n            if (siblings[index + 1]) {\r\n                return siblings[index + 1]\r\n            }\r\n        }\r\n        if (allowCrossGroup && parent) {\r\n            do {\r\n                parent = parent.next(direction, allowCrossGroup);\r\n                siblings = parent ? parent.children(direction) : []\r\n            } while (parent && !siblings.length);\r\n            return siblings[0] || NULL\r\n        }\r\n        return NULL\r\n    },\r\n    prev: function(direction, allowCrossGroup) {\r\n        var currentPath = this._getPath(direction);\r\n        var item = currentPath[0];\r\n        var parent = this.parent(direction);\r\n        var siblings;\r\n        if (parent) {\r\n            var index = currentPath[1].children.indexOf(item);\r\n            siblings = parent.children(direction);\r\n            if (siblings[index - 1]) {\r\n                return siblings[index - 1]\r\n            }\r\n        }\r\n        if (allowCrossGroup && parent) {\r\n            do {\r\n                parent = parent.prev(direction, allowCrossGroup);\r\n                siblings = parent ? parent.children(direction) : []\r\n            } while (parent && !siblings.length);\r\n            return siblings[siblings.length - 1] || NULL\r\n        }\r\n        return NULL\r\n    },\r\n    cell: function() {\r\n        return this._cell\r\n    },\r\n    field: function(area) {\r\n        if (\"data\" === area) {\r\n            return this._descriptions.values[this._fieldIndex]\r\n        }\r\n        var path = this._getPath(area);\r\n        var descriptions = this._getDimension(area);\r\n        var field = descriptions[path.length - 2];\r\n        return field || NULL\r\n    },\r\n    child: function(direction, fieldValue) {\r\n        var children = this.children(direction);\r\n        for (var i = 0; i < children.length; i++) {\r\n            var childLevelField = childLevelField || children[i].field(direction);\r\n            if (children[i].value(childLevelField) === fieldValue) {\r\n                return children[i]\r\n            }\r\n        }\r\n        return NULL\r\n    },\r\n    slice: function(field, value) {\r\n        var config = {};\r\n        var fieldPos = getFieldPos(this._descriptions, field, this._fieldsCache);\r\n        var area = fieldPos.area;\r\n        var fieldIndex = fieldPos.index;\r\n        var sliceCell = NULL;\r\n        if (area === ROW || area === COLUMN) {\r\n            var path = this._getPath(area).slice();\r\n            var level = -1 !== fieldIndex && path.length - 2 - fieldIndex;\r\n            if (path[level]) {\r\n                [][path.length - 1] = path[path.length - 1];\r\n                for (var i = level; i >= 0; i--) {\r\n                    if (path[i + 1]) {\r\n                        var childItems = path[i + 1].children || [];\r\n                        var currentValue = i === level ? value : path[i].value;\r\n                        path[i] = void 0;\r\n                        for (var childIndex = 0; childIndex < childItems.length; childIndex++) {\r\n                            if (childItems[childIndex].value === currentValue) {\r\n                                path[i] = childItems[childIndex];\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n                    if (void 0 === path[i]) {\r\n                        return sliceCell\r\n                    }\r\n                }\r\n                config[getPathFieldName(area)] = path;\r\n                sliceCell = this._createCell(config)\r\n            }\r\n        }\r\n        return sliceCell\r\n    },\r\n    value: function(arg1, arg2) {\r\n        var cell = this._cell;\r\n        var fieldIndex = this._fieldIndex;\r\n        var fistArgIsBoolean = true === arg1 || false === arg1;\r\n        var field = !fistArgIsBoolean ? arg1 : NULL;\r\n        var needCalculatedValue = fistArgIsBoolean && arg1 || arg2;\r\n        if (isDefined(field)) {\r\n            var fieldPos = getFieldPos(this._descriptions, field, this._fieldsCache);\r\n            fieldIndex = fieldPos.index;\r\n            if (\"data\" !== fieldPos.area) {\r\n                var path = this._getPath(fieldPos.area);\r\n                var level = -1 !== fieldIndex && path.length - 2 - fieldIndex;\r\n                return path[level] && path[level].value\r\n            }\r\n        }\r\n        if (cell && cell.originalCell) {\r\n            return needCalculatedValue ? cell[fieldIndex] : cell.originalCell[fieldIndex]\r\n        }\r\n        return NULL\r\n    },\r\n    isPostProcessed(field) {\r\n        var fieldIndex = this._fieldIndex;\r\n        if (isDefined(field)) {\r\n            var fieldPos = getFieldPos(this._descriptions, field, this._fieldsCache);\r\n            fieldIndex = fieldPos.index;\r\n            if (\"data\" !== fieldPos.area) {\r\n                return false\r\n            }\r\n        }\r\n        return !!(this._cell && this._cell.postProcessedFlags[fieldIndex])\r\n    }\r\n});\r\n\r\nfunction getExpression(field) {\r\n    var summaryDisplayMode = field.summaryDisplayMode;\r\n    var crossGroupCalculation = field.allowCrossGroupCalculation;\r\n    var expression = NULL;\r\n    if (isFunction(field.calculateSummaryValue)) {\r\n        expression = field.calculateSummaryValue\r\n    } else if (summaryDisplayMode) {\r\n        if (\"absoluteVariation\" === summaryDisplayMode) {\r\n            expression = createAbsoluteVariationExp(crossGroupCalculation)\r\n        } else if (\"percentVariation\" === summaryDisplayMode) {\r\n            expression = createPercentVariationExp(crossGroupCalculation)\r\n        } else {\r\n            expression = summaryDictionary[summaryDisplayMode]\r\n        }\r\n        if (expression && !field.format && -1 !== summaryDisplayMode.indexOf(\"percent\")) {\r\n            setFieldProperty(field, \"format\", \"percent\")\r\n        }\r\n    }\r\n    return expression\r\n}\r\n\r\nfunction processDataCell(data, rowIndex, columnIndex, isRunningTotalCalculation) {\r\n    var values = data.values[rowIndex][columnIndex] = data.values[rowIndex][columnIndex] || [];\r\n    var originalCell = values.originalCell;\r\n    if (!originalCell) {\r\n        return\r\n    }\r\n    if (values.allowResetting || !isRunningTotalCalculation) {\r\n        data.values[rowIndex][columnIndex] = originalCell.slice()\r\n    }\r\n    data.values[rowIndex][columnIndex].allowResetting = isRunningTotalCalculation\r\n}\r\nexport function applyDisplaySummaryMode(descriptions, data) {\r\n    var expressions = [];\r\n    var columnElements = [{\r\n        index: data.grandTotalColumnIndex,\r\n        children: data.columns\r\n    }];\r\n    var rowElements = [{\r\n        index: data.grandTotalRowIndex,\r\n        children: data.rows\r\n    }];\r\n    var valueFields = descriptions.values;\r\n    var fieldsCache = createCache();\r\n    data.values = data.values || [];\r\n    foreachTree(columnElements, columnPath => {\r\n        columnPath[0].isEmpty = []\r\n    }, false);\r\n    foreachTree(rowElements, (function(rowPath) {\r\n        var rowItem = rowPath[0];\r\n        rowItem.isEmpty = [];\r\n        data.values[rowItem.index] = data.values[rowItem.index] || [];\r\n        foreachTree(columnElements, (function(columnPath) {\r\n            var columnItem = columnPath[0];\r\n            var isEmptyCell;\r\n            processDataCell(data, rowItem.index, columnItem.index, false);\r\n            for (var i = 0; i < valueFields.length; i++) {\r\n                var field = valueFields[i];\r\n                var expression = expressions[i] = void 0 === expressions[i] ? getExpression(field) : expressions[i];\r\n                isEmptyCell = false;\r\n                if (expression) {\r\n                    var expressionArg = new SummaryCell(columnPath, rowPath, data, descriptions, i, fieldsCache);\r\n                    var cell = expressionArg.cell();\r\n                    var value = cell[i] = expression(expressionArg);\r\n                    cell.postProcessedFlags[i] = true;\r\n                    isEmptyCell = null === value || void 0 === value\r\n                }\r\n                if (void 0 === columnItem.isEmpty[i]) {\r\n                    columnItem.isEmpty[i] = true\r\n                }\r\n                if (void 0 === rowItem.isEmpty[i]) {\r\n                    rowItem.isEmpty[i] = true\r\n                }\r\n                if (!isEmptyCell) {\r\n                    rowItem.isEmpty[i] = columnItem.isEmpty[i] = false\r\n                }\r\n            }\r\n        }), false)\r\n    }), false);\r\n    data.isEmptyGrandTotalRow = rowElements[0].isEmpty;\r\n    data.isEmptyGrandTotalColumn = columnElements[0].isEmpty\r\n}\r\nexport function applyRunningTotal(descriptions, data) {\r\n    var expressions = [];\r\n    var columnElements = [{\r\n        index: data.grandTotalColumnIndex,\r\n        children: data.columns\r\n    }];\r\n    var rowElements = [{\r\n        index: data.grandTotalRowIndex,\r\n        children: data.rows\r\n    }];\r\n    var valueFields = descriptions.values;\r\n    var fieldsCache = createCache();\r\n    data.values = data.values || [];\r\n    foreachTree(rowElements, (function(rowPath) {\r\n        var rowItem = rowPath[0];\r\n        data.values[rowItem.index] = data.values[rowItem.index] || [];\r\n        foreachTree(columnElements, (function(columnPath) {\r\n            var columnItem = columnPath[0];\r\n            processDataCell(data, rowItem.index, columnItem.index, true);\r\n            for (var i = 0; i < valueFields.length; i++) {\r\n                var field = valueFields[i];\r\n                var expression = expressions[i] = void 0 === expressions[i] ? createRunningTotalExpr(field) : expressions[i];\r\n                if (expression) {\r\n                    var expressionArg = new SummaryCell(columnPath, rowPath, data, descriptions, i, fieldsCache);\r\n                    var cell = expressionArg.cell();\r\n                    cell[i] = expression(expressionArg);\r\n                    cell.postProcessedFlags[i] = true\r\n                }\r\n            }\r\n        }), false)\r\n    }), false)\r\n}\r\nexport function createMockSummaryCell(descriptions, fields, indices) {\r\n    var summaryCell = new SummaryCell([], [], {}, descriptions, 0);\r\n    summaryCell.value = function(fieldId) {\r\n        if (isDefined(fieldId)) {\r\n            var index = findField(fields, fieldId);\r\n            var field = fields[index];\r\n            if (!indices[index] && field && !isDefined(field.area)) {\r\n                descriptions.values.push(field);\r\n                indices[index] = true\r\n            }\r\n        }\r\n    };\r\n    summaryCell.grandTotal = function() {\r\n        return this\r\n    };\r\n    summaryCell.children = function() {\r\n        return []\r\n    };\r\n    return summaryCell\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}