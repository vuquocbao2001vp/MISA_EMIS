{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/file_manager/ui.file_manager.dialog.folder_chooser.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport { extend } from \"../../core/utils/extend\";\nimport messageLocalization from \"../../localization/message\";\nimport { getMapFromObject } from \"./ui.file_manager.common\";\nimport FileManagerDialogBase from \"./ui.file_manager.dialog\";\nimport FileManagerFilesTreeView from \"./ui.file_manager.files_tree_view\";\nvar FILE_MANAGER_DIALOG_FOLDER_CHOOSER = \"dx-filemanager-dialog-folder-chooser\";\nvar FILE_MANAGER_DIALOG_FOLDER_CHOOSER_POPUP = \"dx-filemanager-dialog-folder-chooser-popup\";\n\nclass FileManagerFolderChooserDialog extends FileManagerDialogBase {\n  show() {\n    var _this$_filesTreeView;\n\n    this._setSelectedDirInfo(null);\n\n    null === (_this$_filesTreeView = this._filesTreeView) || void 0 === _this$_filesTreeView ? void 0 : _this$_filesTreeView.refresh();\n    super.show();\n  }\n\n  switchToCopyDialog(targetItemInfos) {\n    this._targetItemInfos = targetItemInfos;\n\n    this._setTitle(messageLocalization.format(\"dxFileManager-dialogDirectoryChooserCopyTitle\"));\n\n    this._setApplyButtonOptions({\n      text: messageLocalization.format(\"dxFileManager-dialogDirectoryChooserCopyButtonText\"),\n      disabled: true\n    });\n  }\n\n  switchToMoveDialog(targetItemInfos) {\n    this._targetItemInfos = targetItemInfos;\n\n    this._setTitle(messageLocalization.format(\"dxFileManager-dialogDirectoryChooserMoveTitle\"));\n\n    this._setApplyButtonOptions({\n      text: messageLocalization.format(\"dxFileManager-dialogDirectoryChooserMoveButtonText\"),\n      disabled: true\n    });\n  }\n\n  _getDialogOptions() {\n    return extend(super._getDialogOptions(), {\n      contentCssClass: FILE_MANAGER_DIALOG_FOLDER_CHOOSER,\n      popupCssClass: FILE_MANAGER_DIALOG_FOLDER_CHOOSER_POPUP\n    });\n  }\n\n  _createContentTemplate(element) {\n    super._createContentTemplate(element);\n\n    this._filesTreeView = this._createComponent($(\"<div>\"), FileManagerFilesTreeView, {\n      getDirectories: this.option(\"getDirectories\"),\n      getCurrentDirectory: () => this._getDialogSelectedDirectory(),\n      onDirectoryClick: e => this._onFilesTreeViewDirectoryClick(e),\n      onFilesTreeViewContentReady: () => this._toggleUnavailableLocationsDisabled(true)\n    });\n\n    this._$contentElement.append(this._filesTreeView.$element());\n  }\n\n  _getDialogResult() {\n    var result = this._getDialogSelectedDirectory();\n\n    return result ? {\n      folder: result\n    } : result;\n  }\n\n  _getDefaultOptions() {\n    return extend(super._getDefaultOptions(), {\n      getItems: null\n    });\n  }\n\n  _getDialogSelectedDirectory() {\n    return this._selectedDirectoryInfo;\n  }\n\n  _onFilesTreeViewDirectoryClick(_ref) {\n    var {\n      itemData: itemData\n    } = _ref;\n\n    this._setSelectedDirInfo(itemData);\n\n    this._filesTreeView.updateCurrentDirectory();\n  }\n\n  _setSelectedDirInfo(dirInfo) {\n    this._selectedDirectoryInfo = dirInfo;\n\n    this._setApplyButtonOptions({\n      disabled: !dirInfo\n    });\n  }\n\n  _onPopupShown() {\n    this._toggleUnavailableLocationsDisabled(true);\n\n    super._onPopupShown();\n  }\n\n  _onPopupHidden() {\n    this._toggleUnavailableLocationsDisabled(false);\n\n    super._onPopupHidden();\n  }\n\n  _toggleUnavailableLocationsDisabled(isDisabled) {\n    if (!this._filesTreeView) {\n      return;\n    }\n\n    var locations = this._getLocationsToProcess(isDisabled);\n\n    this._filesTreeView.toggleDirectoryExpandedStateRecursive(locations.locationsToExpand[0], isDisabled).then(() => this._filesTreeView.toggleDirectoryLineExpandedState(locations.locationsToCollapse, !isDisabled).then(() => locations.locationKeysToDisable.forEach(key => this._filesTreeView.toggleNodeDisabledState(key, isDisabled))));\n  }\n\n  _getLocationsToProcess(isDisabled) {\n    var expandLocations = {};\n    var collapseLocations = {};\n\n    this._targetItemInfos.forEach(itemInfo => {\n      if (itemInfo.parentDirectory) {\n        expandLocations[itemInfo.parentDirectory.getInternalKey()] = itemInfo.parentDirectory;\n      }\n\n      if (itemInfo.fileItem.isDirectory) {\n        collapseLocations[itemInfo.getInternalKey()] = itemInfo;\n      }\n    });\n\n    var expandMap = getMapFromObject(expandLocations);\n    var collapseMap = getMapFromObject(collapseLocations);\n    return {\n      locationsToExpand: isDisabled ? expandMap.values : [],\n      locationsToCollapse: isDisabled ? collapseMap.values : [],\n      locationKeysToDisable: expandMap.keys.concat(...collapseMap.keys)\n    };\n  }\n\n}\n\nexport default FileManagerFolderChooserDialog;","map":{"version":3,"names":["$","extend","messageLocalization","getMapFromObject","FileManagerDialogBase","FileManagerFilesTreeView","FILE_MANAGER_DIALOG_FOLDER_CHOOSER","FILE_MANAGER_DIALOG_FOLDER_CHOOSER_POPUP","FileManagerFolderChooserDialog","show","_this$_filesTreeView","_setSelectedDirInfo","_filesTreeView","refresh","switchToCopyDialog","targetItemInfos","_targetItemInfos","_setTitle","format","_setApplyButtonOptions","text","disabled","switchToMoveDialog","_getDialogOptions","contentCssClass","popupCssClass","_createContentTemplate","element","_createComponent","getDirectories","option","getCurrentDirectory","_getDialogSelectedDirectory","onDirectoryClick","e","_onFilesTreeViewDirectoryClick","onFilesTreeViewContentReady","_toggleUnavailableLocationsDisabled","_$contentElement","append","$element","_getDialogResult","result","folder","_getDefaultOptions","getItems","_selectedDirectoryInfo","_ref","itemData","updateCurrentDirectory","dirInfo","_onPopupShown","_onPopupHidden","isDisabled","locations","_getLocationsToProcess","toggleDirectoryExpandedStateRecursive","locationsToExpand","then","toggleDirectoryLineExpandedState","locationsToCollapse","locationKeysToDisable","forEach","key","toggleNodeDisabledState","expandLocations","collapseLocations","itemInfo","parentDirectory","getInternalKey","fileItem","isDirectory","expandMap","collapseMap","values","keys","concat"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/ui/file_manager/ui.file_manager.dialog.folder_chooser.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/file_manager/ui.file_manager.dialog.folder_chooser.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport messageLocalization from \"../../localization/message\";\r\nimport {\r\n    getMapFromObject\r\n} from \"./ui.file_manager.common\";\r\nimport FileManagerDialogBase from \"./ui.file_manager.dialog\";\r\nimport FileManagerFilesTreeView from \"./ui.file_manager.files_tree_view\";\r\nvar FILE_MANAGER_DIALOG_FOLDER_CHOOSER = \"dx-filemanager-dialog-folder-chooser\";\r\nvar FILE_MANAGER_DIALOG_FOLDER_CHOOSER_POPUP = \"dx-filemanager-dialog-folder-chooser-popup\";\r\nclass FileManagerFolderChooserDialog extends FileManagerDialogBase {\r\n    show() {\r\n        var _this$_filesTreeView;\r\n        this._setSelectedDirInfo(null);\r\n        null === (_this$_filesTreeView = this._filesTreeView) || void 0 === _this$_filesTreeView ? void 0 : _this$_filesTreeView.refresh();\r\n        super.show()\r\n    }\r\n    switchToCopyDialog(targetItemInfos) {\r\n        this._targetItemInfos = targetItemInfos;\r\n        this._setTitle(messageLocalization.format(\"dxFileManager-dialogDirectoryChooserCopyTitle\"));\r\n        this._setApplyButtonOptions({\r\n            text: messageLocalization.format(\"dxFileManager-dialogDirectoryChooserCopyButtonText\"),\r\n            disabled: true\r\n        })\r\n    }\r\n    switchToMoveDialog(targetItemInfos) {\r\n        this._targetItemInfos = targetItemInfos;\r\n        this._setTitle(messageLocalization.format(\"dxFileManager-dialogDirectoryChooserMoveTitle\"));\r\n        this._setApplyButtonOptions({\r\n            text: messageLocalization.format(\"dxFileManager-dialogDirectoryChooserMoveButtonText\"),\r\n            disabled: true\r\n        })\r\n    }\r\n    _getDialogOptions() {\r\n        return extend(super._getDialogOptions(), {\r\n            contentCssClass: FILE_MANAGER_DIALOG_FOLDER_CHOOSER,\r\n            popupCssClass: FILE_MANAGER_DIALOG_FOLDER_CHOOSER_POPUP\r\n        })\r\n    }\r\n    _createContentTemplate(element) {\r\n        super._createContentTemplate(element);\r\n        this._filesTreeView = this._createComponent($(\"<div>\"), FileManagerFilesTreeView, {\r\n            getDirectories: this.option(\"getDirectories\"),\r\n            getCurrentDirectory: () => this._getDialogSelectedDirectory(),\r\n            onDirectoryClick: e => this._onFilesTreeViewDirectoryClick(e),\r\n            onFilesTreeViewContentReady: () => this._toggleUnavailableLocationsDisabled(true)\r\n        });\r\n        this._$contentElement.append(this._filesTreeView.$element())\r\n    }\r\n    _getDialogResult() {\r\n        var result = this._getDialogSelectedDirectory();\r\n        return result ? {\r\n            folder: result\r\n        } : result\r\n    }\r\n    _getDefaultOptions() {\r\n        return extend(super._getDefaultOptions(), {\r\n            getItems: null\r\n        })\r\n    }\r\n    _getDialogSelectedDirectory() {\r\n        return this._selectedDirectoryInfo\r\n    }\r\n    _onFilesTreeViewDirectoryClick(_ref) {\r\n        var {\r\n            itemData: itemData\r\n        } = _ref;\r\n        this._setSelectedDirInfo(itemData);\r\n        this._filesTreeView.updateCurrentDirectory()\r\n    }\r\n    _setSelectedDirInfo(dirInfo) {\r\n        this._selectedDirectoryInfo = dirInfo;\r\n        this._setApplyButtonOptions({\r\n            disabled: !dirInfo\r\n        })\r\n    }\r\n    _onPopupShown() {\r\n        this._toggleUnavailableLocationsDisabled(true);\r\n        super._onPopupShown()\r\n    }\r\n    _onPopupHidden() {\r\n        this._toggleUnavailableLocationsDisabled(false);\r\n        super._onPopupHidden()\r\n    }\r\n    _toggleUnavailableLocationsDisabled(isDisabled) {\r\n        if (!this._filesTreeView) {\r\n            return\r\n        }\r\n        var locations = this._getLocationsToProcess(isDisabled);\r\n        this._filesTreeView.toggleDirectoryExpandedStateRecursive(locations.locationsToExpand[0], isDisabled).then(() => this._filesTreeView.toggleDirectoryLineExpandedState(locations.locationsToCollapse, !isDisabled).then(() => locations.locationKeysToDisable.forEach(key => this._filesTreeView.toggleNodeDisabledState(key, isDisabled))))\r\n    }\r\n    _getLocationsToProcess(isDisabled) {\r\n        var expandLocations = {};\r\n        var collapseLocations = {};\r\n        this._targetItemInfos.forEach(itemInfo => {\r\n            if (itemInfo.parentDirectory) {\r\n                expandLocations[itemInfo.parentDirectory.getInternalKey()] = itemInfo.parentDirectory\r\n            }\r\n            if (itemInfo.fileItem.isDirectory) {\r\n                collapseLocations[itemInfo.getInternalKey()] = itemInfo\r\n            }\r\n        });\r\n        var expandMap = getMapFromObject(expandLocations);\r\n        var collapseMap = getMapFromObject(collapseLocations);\r\n        return {\r\n            locationsToExpand: isDisabled ? expandMap.values : [],\r\n            locationsToCollapse: isDisabled ? collapseMap.values : [],\r\n            locationKeysToDisable: expandMap.keys.concat(...collapseMap.keys)\r\n        }\r\n    }\r\n}\r\nexport default FileManagerFolderChooserDialog;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}