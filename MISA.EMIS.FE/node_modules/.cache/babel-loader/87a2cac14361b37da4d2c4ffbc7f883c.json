{"ast":null,"code":"import dateutil from '../dateutil';\nimport { pymod, isPresent, includes } from '../helpers';\nexport function buildPoslist(bysetpos, timeset, start, end, ii, dayset) {\n  var poslist = [];\n\n  for (var j = 0; j < bysetpos.length; j++) {\n    var daypos = void 0;\n    var timepos = void 0;\n    var pos = bysetpos[j];\n\n    if (pos < 0) {\n      daypos = Math.floor(pos / timeset.length);\n      timepos = pymod(pos, timeset.length);\n    } else {\n      daypos = Math.floor((pos - 1) / timeset.length);\n      timepos = pymod(pos - 1, timeset.length);\n    }\n\n    var tmp = [];\n\n    for (var k = start; k < end; k++) {\n      var val = dayset[k];\n      if (!isPresent(val)) continue;\n      tmp.push(val);\n    }\n\n    var i = void 0;\n\n    if (daypos < 0) {\n      i = tmp.slice(daypos)[0];\n    } else {\n      i = tmp[daypos];\n    }\n\n    var time = timeset[timepos];\n    var date = dateutil.fromOrdinal(ii.yearordinal + i);\n    var res = dateutil.combine(date, time); // XXX: can this ever be in the array?\n    // - compare the actual date instead?\n\n    if (!includes(poslist, res)) poslist.push(res);\n  }\n\n  dateutil.sort(poslist);\n  return poslist;\n}","map":{"version":3,"mappings":"AAAA,OAAOA,QAAP,MAAqB,aAArB;AAEA,SAASC,KAAT,EAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,YAA3C;AAGA,OAAM,SAAUC,YAAV,CAAwBC,QAAxB,EAA4CC,OAA5C,EAA6DC,KAA7D,EAA4EC,GAA5E,EAAyFC,EAAzF,EAAuGC,MAAvG,EAAgI;EACpI,IAAMC,OAAO,GAAW,EAAxB;;EAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGP,QAAQ,CAACQ,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;IACxC,IAAIE,MAAM,SAAV;IACA,IAAIC,OAAO,SAAX;IACA,IAAMC,GAAG,GAAGX,QAAQ,CAACO,CAAD,CAApB;;IAEA,IAAII,GAAG,GAAG,CAAV,EAAa;MACXF,MAAM,GAAGG,IAAI,CAACC,KAAL,CAAWF,GAAG,GAAGV,OAAO,CAACO,MAAzB,CAAT;MACAE,OAAO,GAAGd,KAAK,CAACe,GAAD,EAAMV,OAAO,CAACO,MAAd,CAAf;IACD,CAHD,MAGO;MACLC,MAAM,GAAGG,IAAI,CAACC,KAAL,CAAW,CAACF,GAAG,GAAG,CAAP,IAAYV,OAAO,CAACO,MAA/B,CAAT;MACAE,OAAO,GAAGd,KAAK,CAACe,GAAG,GAAG,CAAP,EAAUV,OAAO,CAACO,MAAlB,CAAf;IACD;;IAED,IAAMM,GAAG,GAAG,EAAZ;;IACA,KAAK,IAAIC,CAAC,GAAGb,KAAb,EAAoBa,CAAC,GAAGZ,GAAxB,EAA6BY,CAAC,EAA9B,EAAkC;MAChC,IAAMC,GAAG,GAAGX,MAAM,CAACU,CAAD,CAAlB;MACA,IAAI,CAAClB,SAAS,CAACmB,GAAD,CAAd,EAAqB;MACrBF,GAAG,CAACG,IAAJ,CAASD,GAAT;IACD;;IACD,IAAIE,CAAC,SAAL;;IACA,IAAIT,MAAM,GAAG,CAAb,EAAgB;MACdS,CAAC,GAAGJ,GAAG,CAACK,KAAJ,CAAUV,MAAV,EAAkB,CAAlB,CAAJ;IACD,CAFD,MAEO;MACLS,CAAC,GAAGJ,GAAG,CAACL,MAAD,CAAP;IACD;;IAED,IAAMW,IAAI,GAAGnB,OAAO,CAACS,OAAD,CAApB;IACA,IAAMW,IAAI,GAAG1B,QAAQ,CAAC2B,WAAT,CAAqBlB,EAAE,CAACmB,WAAH,GAAiBL,CAAtC,CAAb;IACA,IAAMM,GAAG,GAAG7B,QAAQ,CAAC8B,OAAT,CAAiBJ,IAAjB,EAAuBD,IAAvB,CAAZ,CA5BwC,CA6BxC;IACA;;IACA,IAAI,CAACtB,QAAQ,CAACQ,OAAD,EAAUkB,GAAV,CAAb,EAA6BlB,OAAO,CAACW,IAAR,CAAaO,GAAb;EAC9B;;EAED7B,QAAQ,CAAC+B,IAAT,CAAcpB,OAAd;EAEA,OAAOA,OAAP;AACD","names":["dateutil","pymod","isPresent","includes","buildPoslist","bysetpos","timeset","start","end","ii","dayset","poslist","j","length","daypos","timepos","pos","Math","floor","tmp","k","val","push","i","slice","time","date","fromOrdinal","yearordinal","res","combine","sort"],"sourceRoot":"","sources":["../../../../src/iter/poslist.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}