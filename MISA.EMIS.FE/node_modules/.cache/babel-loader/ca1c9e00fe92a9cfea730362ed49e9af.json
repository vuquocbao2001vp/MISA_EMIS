{"ast":null,"code":"import axios from \"axios\";\nimport MISAEnum from \"@/script/constants/MISAEnum.js\";\nimport MISAResource from \"../../script/constants/MISAResource.js\";\nimport DxSelectBox from \"devextreme-vue/select-box\";\nimport DxTagBox from \"devextreme-vue/tag-box\";\nimport DxDateBox from \"devextreme-vue/date-box\";\nimport BasePopupChange from \"../base/BasePopupChange.vue\";\nimport BaseApi from '../../script/constants/BaseApi';\nexport default {\n  components: {\n    DxSelectBox,\n    DxTagBox,\n    DxDateBox,\n    BasePopupChange\n  },\n  props: [\"isShow\", \"staffSelected\", \"staffSelectedId\", \"btnSaveMode\", \"dialogName\"],\n\n  data() {\n    return {\n      isHideLoader: true,\n      isHidePopup: true,\n      popupTitle: \"\",\n      popupText: \"\",\n      staff: {},\n      isTrained: null,\n      isWorking: null,\n      quitWorkDate: null,\n      departments: {},\n      subjects: {},\n      subjectIdList: [],\n      teacherSubject: {},\n      rooms: {},\n      roomIdList: [],\n      teacherRoom: {},\n      isChangeData: false,\n      oldTeacher: {},\n      errorCode: \"\",\n      errorName: \"\",\n      errorPhone: \"\",\n      errorEmail: \"\",\n      isShowError: []\n    };\n  },\n\n  created() {\n    this.Resource = MISAResource;\n    var me = this;\n    /**\r\n     * Gọi api lấy dữ liệu các môn học\r\n     * Author: VQBao - 15/8/2022\r\n     */\n\n    axios.get(BaseApi.SubjectApi).then(function (response) {\n      me.subjects = response.data;\n    }).catch(function (err) {\n      console.log(err);\n    });\n    /**\r\n     * Gọi api lấy dữ liệu các tổ bộ môn\r\n     * Author: VQBao - 15/8/2022\r\n     */\n\n    axios.get(BaseApi.DepartmentApi).then(function (response) {\n      me.departments = response.data;\n    }).catch(function (err) {\n      console.log(err);\n    });\n    /**\r\n     * Gọi api lấy dữ liệu các kho phòng\r\n     * Author: VQBao - 15/8/2022\r\n     */\n\n    axios.get(BaseApi.RoomApi).then(function (response) {\n      me.rooms = response.data;\n    }).catch(function (err) {\n      console.log(err);\n    });\n  },\n\n  watch: {\n    isShow: function (value) {\n      // khi form thông tin chi tiết mở ra, focus vào ô input đầu tiên\n      if (value == true) {\n        this.$nextTick(() => {\n          this.$refs.staffCode.focus();\n        }); // khi mở form, reset lại các trường thông tin\n\n        this.errorCode = \"\";\n        this.errorName = \"\";\n        this.errorPhone = \"\";\n        this.errorEmail = \"\";\n\n        if (this.btnSaveMode == MISAEnum.EditMode.Add) {\n          this.isTrained = false;\n          this.isWorking = false;\n          this.quitWorkDate = null;\n          this.roomIdList = [];\n          this.subjectIdList = [];\n        }\n\n        this.isChangeData = false;\n      }\n    },\n    staffSelected: function (value) {\n      this.staff = value;\n    },\n    staffSelectedId: function (value) {\n      var me = this; // biến danh sách các id của môn học, kho phòng\n\n      var subjectList = [];\n      var roomList = [];\n\n      if (value) {\n        /**\r\n         * gọi api lấy dữ liệu thông tin chi tiết 1 giáo viên\r\n         * Author: VQBao - 21/7/2022\r\n         */\n        axios.get(BaseApi.TeacherApi + `/${me.staffSelectedId}`).then(function (response) {\n          switch (response.status) {\n            case 200:\n              me.staff = response.data.teacher;\n              me.isTrained = response.data.teacher.isTrained;\n              me.isWorking = response.data.teacher.isWorking;\n              me.quitWorkDate = response.data.teacher.quitWorkDate;\n              me.teacherRoom = response.data.room;\n              me.teacherSubject = response.data.subject;\n\n              for (let i = 0; i < me.teacherSubject.length; i++) {\n                subjectList.push(me.teacherSubject[i].subjectId);\n              }\n\n              me.subjectIdList = subjectList;\n\n              for (let i = 0; i < me.teacherRoom.length; i++) {\n                roomList.push(me.teacherRoom[i].roomId);\n              }\n\n              me.roomIdList = roomList; // xây dựng object lưu thông tin khi api trả về chưa thay đổi\n\n              me.oldTeacher = {\n                teacherCode: response.data.teacher.teacherCode,\n                fullName: response.data.teacher.fullName,\n                phoneNumber: response.data.teacher.phoneNumber,\n                email: response.data.teacher.email,\n                departmentId: response.data.teacher.departmentId,\n                isTrained: response.data.teacher.isTrained,\n                isWorking: response.data.teacher.isWorking,\n                quitWorkDate: response.data.teacher.quitWorkDate,\n                roomList: me.roomIdList,\n                subjectList: me.subjectIdList\n              };\n              break;\n          }\n        }).catch(function (res) {\n          switch (res.status) {\n            case 404:\n              console.log(\"404 Not Found\");\n              break;\n          }\n        });\n      }\n    }\n  },\n  methods: {\n    /**\r\n     * Hiển thị toast thành công\r\n     * Author: VQBao - 15/8/2022\r\n     */\n    showToast() {\n      if (this.btnSaveMode == MISAEnum.EditMode.Edit) {\n        this.$emit(\"hideToastMessage\", MISAResource.TOAST.Edit.Title, MISAResource.TOAST.Edit.Message);\n      } else {\n        this.$emit(\"hideToastMessage\", MISAResource.TOAST.Add.Title, MISAResource.TOAST.Add.Message);\n      }\n    },\n\n    /**\r\n     * Ẩn form thông tin chi tiết\r\n     * Author: VQBao - 15/8/2022\r\n     */\n    hideDialog() {\n      this.$emit(\"isShowStaffDialog\", false);\n    },\n\n    /**\r\n     * Ẩn popup thông báo\r\n     * Author: VQBao - 15/8/2022\r\n     */\n    hidePopup(isHide) {\n      this.isHidePopup = isHide;\n    },\n\n    /**\r\n     * khi click vào nút đóng thì đóng form giáo viên chi tiết\r\n     * Author: VQBao - 21/7/2022\r\n     */\n    btnCloseOnClick() {\n      // nếu đang sửa thì check thôn tin hiện tại có thay đổi so với thông tin ban đầu không, nếu có thì hiển thị popup\n      if (this.btnSaveMode == MISAEnum.EditMode.Edit) {\n        var isRoomChange = false;\n        var countRoom = 0;\n        var countSubject = 0;\n        if (this.oldTeacher.roomList.length != this.roomIdList.length) isRoomChange = true;else {\n          for (let i = 0; i < this.oldTeacher.roomList.length; i++) {\n            for (let j = 0; j < this.oldTeacher.roomList.length; j++) {\n              if (this.oldTeacher.roomList[i] == this.roomIdList[j]) countRoom++;\n            }\n          }\n\n          if (countRoom < this.oldTeacher.roomList.length) isRoomChange = true;\n        }\n        if (this.oldTeacher.subjectList.length != this.subjectIdList.length) isRoomChange = true;else {\n          for (let i = 0; i < this.oldTeacher.subjectList.length; i++) {\n            for (let j = 0; j < this.oldTeacher.subjectList.length; j++) {\n              if (this.oldTeacher.subjectList[i] == this.subjectIdList[j]) countSubject++;\n            }\n          }\n\n          if (countSubject < this.oldTeacher.subjectList.length) isRoomChange = true;\n        }\n\n        if (this.oldTeacher.teacherCode != this.staff.teacherCode || this.oldTeacher.fullName != this.staff.fullName || this.oldTeacher.phoneNumber != this.staff.phoneNumber && this.oldTeacher.phoneNumber != null || this.oldTeacher.email != this.staff.email && this.oldTeacher.email != null || this.oldTeacher.departmentId != this.staff.departmentId || this.oldTeacher.isTrained != this.isTrained || this.oldTeacher.isWorking != this.isWorking || this.oldTeacher.quitWorkDate != this.quitWorkDate || isRoomChange == true) {\n          this.popupTitle = MISAResource.POPUP.Edit.Title;\n          this.popupText = MISAResource.POPUP.Edit.IsChange;\n          this.isHidePopup = false;\n        } else {\n          this.$emit(\"isShowStaffDialog\", false);\n        }\n      } // nếu đang thêm mới thì kiểm tra có trường thông tin nào khác rỗng không, nếu có thì hiển thị popup\n      else {\n        var isChange = false;\n\n        for (let key in this.staff) {\n          if (this.staff[key] != \"\") isChange = true;\n        }\n\n        if (isChange == true || this.isTrained == true || this.isWorking == true || this.quitWorkDate != null || this.roomIdList.length > 0 || this.subjectIdList.length > 0) {\n          this.popupTitle = MISAResource.POPUP.Edit.Title;\n          this.popupText = MISAResource.POPUP.Edit.IsChange;\n          this.isHidePopup = false;\n        } else {\n          this.$emit(\"isShowStaffDialog\", false);\n        }\n      }\n    },\n\n    /**\r\n     * Thực hiện quay lại giá trị ban đầu khi không đồng ý sửa thông tin giáo viên\r\n     * Author: VQBao - 15/8/2022\r\n     */\n    rollBackOldTeacher() {\n      this.staff.teacherCode = this.oldTeacher.teacherCode;\n      this.staff.fullName = this.oldTeacher.fullName;\n      this.staff.phoneNumber = this.oldTeacher.phoneNumber;\n      this.staff.email = this.oldTeacher.email;\n      this.staff.departmentId = this.oldTeacher.departmentId;\n      this.staff.isTrained = this.oldTeacher.isTrained;\n      this.staff.isWorking = this.oldTeacher.isWorking;\n      this.quitWorkDate = this.oldTeacher.quitWorkDate;\n      this.roomIdList = this.oldTeacher.roomList;\n      this.subjectIdList = this.oldTeacher.subjectList;\n    },\n\n    /**\r\n     * Thực hiện cất dữ liệu\r\n     * Author: VQBao - 21/7/2022\r\n     */\n    saveStaffOnClick() {\n      var me = this;\n\n      if (me.isTrained) {\n        me.staff.isTrained = 1;\n      } else {\n        me.staff.isTrained = 0;\n      }\n\n      if (me.isWorking) {\n        me.staff.isWorking = 1;\n      } else {\n        me.staff.isWorking = 0;\n      }\n\n      me.staff.roomId = me.roomIdList;\n      me.staff.subjectId = me.subjectIdList; // 1. validate dữ liệu, nếu dữ liệu hợp lệ thì gọi api thêm mới giáo viên\n\n      var isValid = me.validateStaffData();\n\n      if (isValid) {\n        me.isHideLoader = false; // 2. gọi api thực hiên thêm mới dữ liệu\n        // nếu saveMode là Add thì thực hiện thêm mới, không thì thực hiện sửa\n\n        if (this.btnSaveMode == MISAEnum.EditMode.Add) {\n          if (me.quitWorkDate != null) {\n            me.quitWorkDate.setDate(me.quitWorkDate.getDate() + 1);\n            me.staff.quitWorkDate = me.quitWorkDate;\n          }\n\n          axios.post(BaseApi.TeacherApi, me.staff).then(function () {\n            // ẩn loading\n            me.isHideLoader = true;\n            me.isHidePopup = true; // tắt form sửa thông tin\n\n            me.$emit(\"isShowStaffDialog\", false); // load lại dữ liệu của bảng\n\n            me.$emit(\"loadData\", 25, 1, \"\"); // hiển thị toast message thành công\n\n            me.$emit(\"hideToastMessage\", MISAResource.TOAST.Add.Title, MISAResource.TOAST.Add.Message);\n          }).catch(function (err) {\n            if (err.response.data.errorMsg == \"Mã giáo viên đã tồn tại trong hệ thống\") {\n              me.$refs.staffCode.classList.add(\"input-error\");\n              me.errorCode = MISAResource.ERROR.DuplicatedCode;\n              me.$nextTick(() => {\n                me.$refs.staffCode.focus();\n              });\n              me.isHideLoader = true;\n            } else {\n              me.isHideLoader = true;\n            }\n          });\n        } else {\n          if (me.staffSelected.quitWorkDate == null && me.quitWorkDate != null) {\n            me.quitWorkDate.setDate(me.quitWorkDate.getDate() + 1);\n            me.staff.quitWorkDate = me.quitWorkDate;\n          } else {\n            me.staff.quitWorkDate = me.quitWorkDate;\n          }\n\n          axios.put(BaseApi.TeacherApi + `/${me.staffSelectedId}`, me.staff).then(function () {\n            // ẩn loading\n            me.isHideLoader = true; // tắt form sửa thông tin\n\n            me.$emit(\"isShowStaffDialog\", false); // load lại dữ liệu của bảng\n\n            me.$emit(\"loadData\", 25, 1, \"\"); // hiển thị toast message thành công\n\n            me.$emit(\"hideToastMessage\", MISAResource.TOAST.Edit.Title, MISAResource.TOAST.Edit.Message);\n          }).catch(function (err) {\n            if (err.response.data.errorMsg == \"Mã giáo viên đã tồn tại trong hệ thống\") {\n              me.$refs.staffCode.classList.add(\"input-error\");\n              me.errorCode = MISAResource.ERROR.DuplicatedCode;\n              me.$nextTick(() => {\n                me.$refs.staffCode.focus();\n              });\n              me.isHideLoader = true;\n            } else {\n              me.isHideLoader = true;\n            }\n          });\n        }\n      } else {\n        // focus vào input đầu tien bị lỗi\n        if (me.errorCode != '') {\n          me.$nextTick(() => {\n            me.$refs.staffCode.focus();\n          });\n        } else {\n          if (me.errorName != '') {\n            me.$nextTick(() => {\n              me.$refs.staffName.focus();\n            });\n          } else {\n            if (me.errorPhone != '') {\n              me.$nextTick(() => {\n                me.$refs.staffPhone.focus();\n              });\n            } else {\n              me.$nextTick(() => {\n                me.$refs.staffEmail.focus();\n              });\n            }\n          }\n        }\n      }\n    },\n\n    /**\r\n     * Khi blur, nếu mã giáo viên để trống thì hiện lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\n    validateStaffCode() {\n      if (!this.staff.teacherCode) {\n        this.$refs.staffCode.classList.add(\"input-error\");\n        this.errorCode = MISAResource.ERROR.EmptyStaffCode;\n      } else if (this.staff.teacherCode.length > 20) {\n        this.$refs.staffCode.classList.add(\"input-error\");\n        this.errorCode = MISAResource.ERROR.LongStaffCode;\n      } else {\n        this.$refs.staffCode.classList.remove(\"input-error\");\n        this.errorCode = '';\n        this.imageStaffCode = this.staff.teacherCode;\n      }\n    },\n\n    /**\r\n     * Khi blur khỏi input Họ tên, nếu họ tên trống hoặc quá dài thì báo lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\n    validateFullName() {\n      if (!this.staff.fullName) {\n        this.$refs.staffName.classList.add(\"input-error\");\n        this.errorName = MISAResource.ERROR.EmptyFullName;\n      } else if (this.staff.fullName.length > 30) {\n        this.$refs.staffName.classList.add(\"input-error\");\n        this.errorName = MISAResource.ERROR.LongFullName;\n      } else {\n        this.$refs.staffName.classList.remove(\"input-error\");\n        this.errorName = '';\n        this.imageStaffName = this.staff.fullName;\n      }\n    },\n\n    /**\r\n     * Khi blur, nếu email không đúng định dạng thì báo lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\n    validateEmail() {\n      var email = event.currentTarget.value;\n\n      if (email) {\n        var emailFormat = /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\n\n        if (!emailFormat.test(email)) {\n          event.currentTarget.classList.add(\"input-error\");\n          this.errorEmail = MISAResource.ERROR.InValidEmail;\n        } else {\n          event.currentTarget.classList.remove(\"input-error\");\n          this.errorEmail = '';\n        }\n      } else {\n        event.currentTarget.classList.remove(\"input-error\");\n        this.errorEmail = '';\n      }\n    },\n\n    /**\r\n     * Kiểm tra độ dài số điện thoại\r\n     * Author: VQBao - 27/7/2022\r\n     */\n    validatePhoneNumber() {\n      var phone = event.currentTarget.value;\n\n      if (phone.length < 10 && phone.length > 0 || phone.length > 11) {\n        event.currentTarget.classList.add(\"input-error\");\n        this.errorPhone = MISAResource.ERROR.ShortPhoneLength;\n      } else {\n        event.currentTarget.classList.remove(\"input-error\");\n        this.errorPhone = '';\n      }\n    },\n\n    /**\r\n     * Thực hiện validate dữ liệu\r\n     * Author: VQBao - 27/7/2022\r\n     */\n    validateStaffData() {\n      var isValid = true; // validate mã giáo viên bỏ trống\n\n      if (!this.staff.teacherCode) {\n        isValid = false;\n        this.$refs.staffCode.classList.add(\"input-error\");\n        this.errorCode = MISAResource.ERROR.EmptyStaffCode;\n      } // validate mã giáo viên quá dài\n\n\n      if (this.staff.teacherCode.length > 20) {\n        isValid = false;\n        this.$refs.staffCode.classList.add(\"input-error\");\n        this.errorCode = MISAResource.ERROR.LongStaffCode;\n      } // validate họ và tên để trống\n\n\n      if (!this.staff.fullName) {\n        isValid = false;\n        this.$refs.staffName.classList.add(\"input-error\");\n        this.errorName = MISAResource.ERROR.EmptyFullName;\n      } // validate họ tên quá dài\n\n\n      if (this.staff.fullName.length > 30) {\n        isValid = false;\n        this.$refs.staffName.classList.add(\"input-error\");\n        this.errorName = MISAResource.ERROR.LongFullName;\n      } // validate email\n\n\n      if (this.staff.email) {\n        var email = this.staff.email;\n\n        if (email) {\n          var emailFormat = /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\n\n          if (!emailFormat.test(email)) {\n            isValid = false;\n            this.$refs.staffEmail.classList.add(\"input-error\");\n            this.errorEmail = MISAResource.ERROR.InValidEmail;\n          }\n        }\n      } // validate số điện thoại\n\n\n      if (this.staff.phoneNumber) {\n        var phone = this.staff.phoneNumber;\n\n        if (phone.length < 10 && phone.length > 0 || phone.length > 11) {\n          isValid = false;\n          this.$refs.staffPhone.classList.add(\"input-error\");\n          this.errorPhone = MISAResource.ERROR.ShortPhoneLength;\n        }\n      }\n\n      return isValid;\n    },\n\n    /**\r\n     * Hàm check trình độ quản lý thiết bị\r\n     * Author: VQBao - 28/7/2022\r\n     */\n    checkIsTrained() {\n      this.isTrained = !this.isTrained;\n    },\n\n    /**\r\n     * Hàm check trạng thái làm việc\r\n     * Author: VQBao - 28/7/2022\r\n     */\n    checkIsWorking() {\n      this.isWorking = !this.isWorking;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","MISAEnum","MISAResource","DxSelectBox","DxTagBox","DxDateBox","BasePopupChange","BaseApi","components","props","data","isHideLoader","isHidePopup","popupTitle","popupText","staff","isTrained","isWorking","quitWorkDate","departments","subjects","subjectIdList","teacherSubject","rooms","roomIdList","teacherRoom","isChangeData","oldTeacher","errorCode","errorName","errorPhone","errorEmail","isShowError","created","Resource","me","get","SubjectApi","then","response","catch","err","console","log","DepartmentApi","RoomApi","watch","isShow","value","$nextTick","$refs","staffCode","focus","btnSaveMode","EditMode","Add","staffSelected","staffSelectedId","subjectList","roomList","TeacherApi","status","teacher","room","subject","i","length","push","subjectId","roomId","teacherCode","fullName","phoneNumber","email","departmentId","res","methods","showToast","Edit","$emit","TOAST","Title","Message","hideDialog","hidePopup","isHide","btnCloseOnClick","isRoomChange","countRoom","countSubject","j","POPUP","IsChange","isChange","key","rollBackOldTeacher","saveStaffOnClick","isValid","validateStaffData","setDate","getDate","post","errorMsg","classList","add","ERROR","DuplicatedCode","put","staffName","staffPhone","staffEmail","validateStaffCode","EmptyStaffCode","LongStaffCode","remove","imageStaffCode","validateFullName","EmptyFullName","LongFullName","imageStaffName","validateEmail","event","currentTarget","emailFormat","test","InValidEmail","validatePhoneNumber","phone","ShortPhoneLength","checkIsTrained","checkIsWorking"],"sourceRoot":"","sources":["E:\\MisaProject\\W2022_06\\MISA.EMIS.FE\\src\\components\\dialog\\DialogStaffDetail.vue"],"sourcesContent":["<template>\r\n  <BaseLoader :isHideLoader=\"isHideLoader\" />\r\n  <div class=\"dialog\" v-if=\"isShow\" :class=\"{ isShowDialog: isShow }\">\r\n    <div class=\"dialog-avatar\">\r\n      <div class=\"avatar-image icon-center icon-default-avatar\"></div>\r\n      <BaseButton\r\n        class=\"avatar-button-picker\"\r\n        buttonName=\"Chọn ảnh\"\r\n        buttonType=\"button-green\"\r\n      />\r\n      <span\r\n        class=\"avatar-name\"\r\n        v-text=\"\r\n          staff.fullName === '' || staff.fullName == null\r\n            ? 'Họ và tên'\r\n            : staff.fullName\r\n        \"\r\n        :title=\"staff.fullName\"\r\n      ></span>\r\n      <span\r\n        class=\"avatar-code\"\r\n        v-text=\"\r\n          staff.teacherCode === '' || staff.teacherCode == null\r\n            ? 'Số hiệu cán bộ'\r\n            : staff.teacherCode\r\n        \"\r\n        :title=\"staff.teacherCode\"\r\n      ></span>\r\n    </div>\r\n    <div class=\"space\"><div class=\"space-border\"></div></div>\r\n    <div class=\"dialog-content\">\r\n      <div\r\n        @click=\"btnCloseOnClick\"\r\n        class=\"content-icon icon-center icon-X-2\"\r\n      ></div>\r\n      <div class=\"dialog-body\">\r\n        <div class=\"dialog-body-text\">{{dialogName}}</div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item body-col-left\">\r\n            <div class=\"body-item-text\">\r\n              {{ Resource.STAFF_INFO.StaffCode\r\n              }}<span class=\"requiredInput\">*</span>\r\n            </div>\r\n            <input\r\n              :tabindex=\"1\"\r\n              type=\"text\"\r\n              class=\"body-item-input\"\r\n              v-model=\"staff.teacherCode\"\r\n              maxlength=\"20\"\r\n              ref=\"staffCode\"\r\n              @blur=\"validateStaffCode\"\r\n              @mouseover=\"isShowError[0] = true\"\r\n              @mouseleave=\"isShowError[0] = false\"\r\n            />\r\n            <div class=\"input-validate-error\" v-if=\"errorCode!=''\" :class=\"{'show-validate-error': isShowError[0]}\">\r\n              <div class=\"validate-error-arrow\"></div>\r\n              <span class=\"validate-error-text\">{{errorCode}}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"dialog-body-item body-col-right\">\r\n            <div class=\"body-item-text\">\r\n              {{ Resource.STAFF_INFO.FullName\r\n              }}<span class=\"requiredInput\">*</span>\r\n            </div>\r\n            <input\r\n              :tabindex=\"2\"\r\n              type=\"text\"\r\n              class=\"body-item-input\"\r\n              ref=\"staffName\"\r\n              maxlength=\"30\"\r\n              v-model=\"staff.fullName\"\r\n              @blur=\"validateFullName\"\r\n              @mouseover=\"isShowError[1] = true\"\r\n              @mouseleave=\"isShowError[1] = false\"\r\n            />\r\n            <div class=\"input-validate-error\" v-if=\"errorName!=''\" :class=\"{'show-validate-error': isShowError[1]}\">\r\n              <span class=\"validate-error-text\">{{errorName}}</span>\r\n              <div class=\"validate-error-arrow\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item body-col-left\">\r\n            <div class=\"body-item-text\">\r\n              {{ Resource.STAFF_INFO.PhoneNumber }}\r\n            </div>\r\n            <input\r\n              :tabindex=\"3\"\r\n              type=\"text\"\r\n              class=\"body-item-input\"\r\n              ref=\"staffPhone\"\r\n              v-model=\"staff.phoneNumber\"\r\n              @blur=\"validatePhoneNumber\"\r\n              @mouseover=\"isShowError[2] = true\"\r\n              @mouseleave=\"isShowError[2] = false\"\r\n              maxlength=\"20\"\r\n            />\r\n            <div class=\"input-validate-error\" v-if=\"errorPhone!=''\" :class=\"{'show-validate-error': isShowError[2]}\">\r\n              <div class=\"validate-error-arrow\"></div>\r\n              <div class=\"validate-error-text\">{{errorPhone}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"dialog-body-item body-col-right\">\r\n            <div class=\"body-item-text\">{{ Resource.STAFF_INFO.Email }}</div>\r\n            <input\r\n              :tabindex=\"4\"\r\n              type=\"text\"\r\n              class=\"body-item-input\"\r\n              ref=\"staffEmail\"\r\n              v-model=\"staff.email\"\r\n              @blur=\"validateEmail\"\r\n              @mouseover=\"isShowError[3] = true\"\r\n              @mouseleave=\"isShowError[3] = false\"\r\n            />\r\n            <div class=\"input-validate-error\" v-if=\"errorEmail!=''\" :class=\"{'show-validate-error': isShowError[3]}\">\r\n              <div class=\"validate-error-text\">{{errorEmail}}</div>\r\n              <div class=\"validate-error-arrow\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item body-col-left\">\r\n            <div class=\"body-item-text\">\r\n              {{ Resource.STAFF_INFO.Department }}\r\n            </div>\r\n            <div class=\"select-box\">\r\n              <DxSelectBox\r\n                :search-enabled=\"true\"\r\n                :items=\"departments\"\r\n                display-expr=\"departmentName\"\r\n                value-expr=\"departmentId\"\r\n                placeholder=\"\"\r\n                v-model:value=\"staff.departmentId\"\r\n                :tabIndex=\"5\"\r\n                noDataText=\"Không có dữ liệu\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div class=\"dialog-body-item body-col-right\">\r\n            <div\r\n              class=\"body-item-text\"\r\n              :title=\"Resource.TITLE.SubjectManagement\"\r\n            >\r\n              {{ Resource.STAFF_INFO.Subject }}\r\n            </div>\r\n            <div class=\"tag-box\">\r\n              <DxTagBox\r\n                :search-enabled=\"true\"\r\n                :show-selection-controls=\"true\"\r\n                :max-display-tag=\"3\"\r\n                :multiline=\"false\"\r\n                :showDropDownButton=\"true\"\r\n                :items=\"subjects\"\r\n                display-expr=\"subjectName\"\r\n                value-expr=\"subjectId\"\r\n                placeholder=\"\"\r\n                :tabIndex=\"6\"\r\n                selectAllText=\"Tất cả\"\r\n                noDataText=\"Không có dữ liệu\"\r\n                v-model:value=\"subjectIdList\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item body-col-left\">\r\n            <div class=\"body-item-text\" :title=\"Resource.TITLE.RoomManagement\">\r\n              {{ Resource.STAFF_INFO.Room }}\r\n            </div>\r\n            <div class=\"tag-box tag-box-room\">\r\n              <DxTagBox\r\n                :search-enabled=\"true\"\r\n                :show-selection-controls=\"true\"\r\n                :max-display-tag=\"3\"\r\n                :multiline=\"false\"\r\n                :showDropDownButton=\"true\"\r\n                :items=\"rooms\"\r\n                display-expr=\"roomName\"\r\n                value-expr=\"roomId\"\r\n                placeholder=\"\"\r\n                :tabIndex=\"7\"\r\n                selectAllText=\"Tất cả\"\r\n                noDataText=\"Không có dữ liệu\"\r\n                v-model:value=\"roomIdList\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item\">\r\n            <BaseCheckbox\r\n              :tabindex=\"8\"\r\n              :class=\"isTrained ? 'checkbox-active' : 'checkbox-inactive'\"\r\n              @click=\"checkIsTrained\"\r\n              @keyup.space=\"checkIsTrained\"\r\n              @keyup.enter=\"checkIsTrained\"\r\n            />\r\n            <div\r\n              class=\"body-item-text row-item-checkbox\"\r\n              :title=\"Resource.TITLE.TrainedQualify\"\r\n            >\r\n              {{ Resource.STAFF_INFO.TrainingQualification }}\r\n            </div>\r\n          </div>\r\n          <div class=\"dialog-body-item\">\r\n            <BaseCheckbox\r\n              :tabindex=\"9\"\r\n              :class=\"isWorking ? 'checkbox-active' : 'checkbox-inactive'\"\r\n              @click=\"checkIsWorking\"\r\n              @keyup.space=\"checkIsWorking\"\r\n              @keyup.enter=\"checkIsWorking\"\r\n            />\r\n            <div class=\"body-item-text row-item-checkbox\">\r\n              {{ Resource.STAFF_INFO.IsWorking }}\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"dialog-body-item\"\r\n            style=\"position: absolute; right: 24px\"\r\n            v-show=\"!isWorking\"\r\n          >\r\n            <div class=\"body-item-text\" style=\"margin-right: 8px\">\r\n              {{ Resource.STAFF_INFO.DayQuitWork }}\r\n            </div>\r\n            <div class=\"day-quit-work\">\r\n              <DxDateBox\r\n                v-model:value=\"quitWorkDate\"\r\n                type=\"date\"\r\n                :tabIndex=\"10\"\r\n                display-format=\"dd/MM/yyyy\"\r\n                invalidDateMessage=\"Ngày nghỉ việc không đúng định dạng\"\r\n                :use-mask-behavior=\"true\"\r\n                placeholder=\"dd/mm/yyyy\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"dialog-footer\">\r\n        <BaseButton\r\n          :tabindex=\"12\"\r\n          id=\"btnClose\"\r\n          buttonName=\"Đóng\"\r\n          buttonType=\"button-white\"\r\n          @click=\"btnCloseOnClick\"\r\n        />\r\n        <BaseButton\r\n          :tabindex=\"11\"\r\n          id=\"btnSave\"\r\n          buttonName=\"Lưu\"\r\n          buttonType=\"button-green\"\r\n          @click=\"saveStaffOnClick\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <BasePopupChange\r\n    :isHidePopup=\"isHidePopup\"\r\n    :title=\"popupTitle\"\r\n    :text=\"popupText\"\r\n    :btnSaveMode=\"btnSaveMode\"\r\n    @hidePopup=\"hidePopup\"\r\n    @hideDialog=\"hideDialog\"\r\n    @saveStaffOnClick=\"saveStaffOnClick\"\r\n    @showToast=\"showToast\"\r\n    @rollBackOldTeacher=\"rollBackOldTeacher\"\r\n  />\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport MISAEnum from \"@/script/constants/MISAEnum.js\";\r\nimport MISAResource from \"../../script/constants/MISAResource.js\";\r\nimport DxSelectBox from \"devextreme-vue/select-box\";\r\nimport DxTagBox from \"devextreme-vue/tag-box\";\r\nimport DxDateBox from \"devextreme-vue/date-box\";\r\nimport BasePopupChange from \"../base/BasePopupChange.vue\";\r\nimport BaseApi from '../../script/constants/BaseApi'\r\nexport default {\r\n  components: {\r\n    DxSelectBox,\r\n    DxTagBox,\r\n    DxDateBox,\r\n    BasePopupChange,\r\n  },\r\n  props: [\"isShow\", \"staffSelected\", \"staffSelectedId\", \"btnSaveMode\", \"dialogName\"],\r\n  data() {\r\n    return {\r\n      isHideLoader: true,\r\n      isHidePopup: true,\r\n      popupTitle: \"\",\r\n      popupText: \"\",\r\n      staff: {},\r\n      isTrained: null,\r\n      isWorking: null,\r\n      quitWorkDate: null,\r\n      departments: {},\r\n      subjects: {},\r\n      subjectIdList: [],\r\n      teacherSubject: {},\r\n      rooms: {},\r\n      roomIdList: [],\r\n      teacherRoom: {},\r\n      isChangeData: false,\r\n      oldTeacher: {},\r\n      errorCode: \"\",\r\n      errorName: \"\",\r\n      errorPhone: \"\",\r\n      errorEmail: \"\",\r\n      isShowError: [],\r\n    };\r\n  },\r\n  created() {\r\n    this.Resource = MISAResource;\r\n    var me = this;\r\n    /**\r\n     * Gọi api lấy dữ liệu các môn học\r\n     * Author: VQBao - 15/8/2022\r\n     */\r\n    axios\r\n      .get(BaseApi.SubjectApi)\r\n      .then(function (response) {\r\n        me.subjects = response.data;\r\n      })\r\n      .catch(function (err) {\r\n        console.log(err);\r\n      });\r\n    /**\r\n     * Gọi api lấy dữ liệu các tổ bộ môn\r\n     * Author: VQBao - 15/8/2022\r\n     */\r\n    axios\r\n      .get(BaseApi.DepartmentApi)\r\n      .then(function (response) {\r\n        me.departments = response.data;\r\n      })\r\n      .catch(function (err) {\r\n        console.log(err);\r\n      });\r\n    /**\r\n     * Gọi api lấy dữ liệu các kho phòng\r\n     * Author: VQBao - 15/8/2022\r\n     */\r\n    axios\r\n      .get(BaseApi.RoomApi)\r\n      .then(function (response) {\r\n        me.rooms = response.data;\r\n      })\r\n      .catch(function (err) {\r\n        console.log(err);\r\n      });\r\n  },\r\n  watch: {\r\n    isShow: function (value) {\r\n      // khi form thông tin chi tiết mở ra, focus vào ô input đầu tiên\r\n      if (value == true) {\r\n        this.$nextTick(() => {\r\n          this.$refs.staffCode.focus();\r\n        });\r\n        // khi mở form, reset lại các trường thông tin\r\n        this.errorCode = \"\";\r\n        this.errorName = \"\";\r\n        this.errorPhone = \"\";\r\n        this.errorEmail = \"\";\r\n        if (this.btnSaveMode == MISAEnum.EditMode.Add) {\r\n          this.isTrained = false;\r\n          this.isWorking = false;\r\n          this.quitWorkDate = null;\r\n          this.roomIdList = [];\r\n          this.subjectIdList = [];\r\n        }\r\n        this.isChangeData = false;\r\n      }\r\n    },\r\n    staffSelected: function (value) {\r\n      this.staff = value;\r\n    },\r\n    staffSelectedId: function (value) {\r\n      var me = this;\r\n      // biến danh sách các id của môn học, kho phòng\r\n      var subjectList = [];\r\n      var roomList = [];\r\n      if (value) {\r\n        /**\r\n         * gọi api lấy dữ liệu thông tin chi tiết 1 giáo viên\r\n         * Author: VQBao - 21/7/2022\r\n         */\r\n        axios\r\n          .get(BaseApi.TeacherApi + `/${me.staffSelectedId}`)\r\n          .then(function (response) {\r\n            switch (response.status) {\r\n              case 200:\r\n                me.staff = response.data.teacher;\r\n                me.isTrained = response.data.teacher.isTrained;\r\n                me.isWorking = response.data.teacher.isWorking;\r\n                me.quitWorkDate = response.data.teacher.quitWorkDate;\r\n\r\n                me.teacherRoom = response.data.room;\r\n                me.teacherSubject = response.data.subject;\r\n                for (let i = 0; i < me.teacherSubject.length; i++) {\r\n                  subjectList.push(me.teacherSubject[i].subjectId);\r\n                }\r\n                me.subjectIdList = subjectList;\r\n                for (let i = 0; i < me.teacherRoom.length; i++) {\r\n                  roomList.push(me.teacherRoom[i].roomId);\r\n                }\r\n                me.roomIdList = roomList;\r\n\r\n                // xây dựng object lưu thông tin khi api trả về chưa thay đổi\r\n                me.oldTeacher = {\r\n                    teacherCode: response.data.teacher.teacherCode,\r\n                    fullName: response.data.teacher.fullName,\r\n                    phoneNumber: response.data.teacher.phoneNumber,\r\n                    email: response.data.teacher.email,\r\n                    departmentId: response.data.teacher.departmentId,\r\n                    isTrained: response.data.teacher.isTrained,\r\n                    isWorking: response.data.teacher.isWorking,\r\n                    quitWorkDate: response.data.teacher.quitWorkDate,\r\n                  \r\n                  roomList: me.roomIdList,\r\n                  subjectList: me.subjectIdList,\r\n                };\r\n                break;\r\n            }\r\n          })\r\n          .catch(function (res) {\r\n            switch (res.status) {\r\n              case 404:\r\n                console.log(\"404 Not Found\");\r\n                break;\r\n            }\r\n          });\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    /**\r\n     * Hiển thị toast thành công\r\n     * Author: VQBao - 15/8/2022\r\n     */\r\n    showToast() {\r\n      if (this.btnSaveMode == MISAEnum.EditMode.Edit) {\r\n        this.$emit(\r\n          \"hideToastMessage\",\r\n          MISAResource.TOAST.Edit.Title,\r\n          MISAResource.TOAST.Edit.Message\r\n        );\r\n      } else {\r\n        this.$emit(\r\n          \"hideToastMessage\",\r\n          MISAResource.TOAST.Add.Title,\r\n          MISAResource.TOAST.Add.Message\r\n        );\r\n      }\r\n    },\r\n    /**\r\n     * Ẩn form thông tin chi tiết\r\n     * Author: VQBao - 15/8/2022\r\n     */\r\n    hideDialog() {\r\n      this.$emit(\"isShowStaffDialog\", false);\r\n    },\r\n    /**\r\n     * Ẩn popup thông báo\r\n     * Author: VQBao - 15/8/2022\r\n     */\r\n    hidePopup(isHide) {\r\n      this.isHidePopup = isHide;\r\n    },\r\n    /**\r\n     * khi click vào nút đóng thì đóng form giáo viên chi tiết\r\n     * Author: VQBao - 21/7/2022\r\n     */\r\n    btnCloseOnClick() {\r\n      // nếu đang sửa thì check thôn tin hiện tại có thay đổi so với thông tin ban đầu không, nếu có thì hiển thị popup\r\n      if (this.btnSaveMode == MISAEnum.EditMode.Edit) {\r\n        var isRoomChange = false;\r\n        var countRoom = 0;\r\n        var countSubject = 0;\r\n        if(this.oldTeacher.roomList.length != this.roomIdList.length) isRoomChange=true;\r\n        else {\r\n          for(let i=0; i<this.oldTeacher.roomList.length; i++){\r\n            for(let j=0; j<this.oldTeacher.roomList.length; j++){\r\n              if(this.oldTeacher.roomList[i] == this.roomIdList[j]) countRoom++;\r\n            }\r\n          }\r\n          if(countRoom < this.oldTeacher.roomList.length) isRoomChange=true;\r\n        }\r\n        if(this.oldTeacher.subjectList.length != this.subjectIdList.length) isRoomChange=true;\r\n        else {\r\n          for(let i=0; i<this.oldTeacher.subjectList.length; i++){\r\n            for(let j=0; j<this.oldTeacher.subjectList.length; j++){\r\n              if(this.oldTeacher.subjectList[i] == this.subjectIdList[j]) countSubject++;\r\n            }\r\n          }\r\n          if(countSubject < this.oldTeacher.subjectList.length) isRoomChange=true;\r\n        }\r\n        if (\r\n          this.oldTeacher.teacherCode != this.staff.teacherCode ||\r\n          this.oldTeacher.fullName != this.staff.fullName ||\r\n          ((this.oldTeacher.phoneNumber != this.staff.phoneNumber) && this.oldTeacher.phoneNumber != null) ||\r\n          ((this.oldTeacher.email != this.staff.email) && this.oldTeacher.email!= null) ||\r\n          this.oldTeacher.departmentId != this.staff.departmentId ||\r\n          this.oldTeacher.isTrained != this.isTrained ||\r\n          this.oldTeacher.isWorking != this.isWorking ||\r\n          this.oldTeacher.quitWorkDate != this.quitWorkDate ||\r\n          isRoomChange == true\r\n        ) {\r\n          this.popupTitle = MISAResource.POPUP.Edit.Title;\r\n          this.popupText = MISAResource.POPUP.Edit.IsChange;\r\n          this.isHidePopup = false;\r\n        } else {\r\n          this.$emit(\"isShowStaffDialog\", false);\r\n        }\r\n      }\r\n      // nếu đang thêm mới thì kiểm tra có trường thông tin nào khác rỗng không, nếu có thì hiển thị popup\r\n      else {\r\n        var isChange = false;\r\n        for(let key in this.staff){\r\n          if(this.staff[key] != \"\") isChange=true;\r\n        }\r\n        if (\r\n          isChange==true ||\r\n          this.isTrained == true ||\r\n          this.isWorking == true ||\r\n          this.quitWorkDate != null ||\r\n          this.roomIdList.length > 0 ||\r\n          this.subjectIdList.length > 0\r\n        ) {\r\n          this.popupTitle = MISAResource.POPUP.Edit.Title;\r\n          this.popupText = MISAResource.POPUP.Edit.IsChange;\r\n          this.isHidePopup = false;\r\n        } else {\r\n          this.$emit(\"isShowStaffDialog\", false);\r\n        }\r\n      }\r\n    },\r\n    /**\r\n     * Thực hiện quay lại giá trị ban đầu khi không đồng ý sửa thông tin giáo viên\r\n     * Author: VQBao - 15/8/2022\r\n     */\r\n    rollBackOldTeacher() {\r\n      this.staff.teacherCode = this.oldTeacher.teacherCode;\r\n      this.staff.fullName = this.oldTeacher.fullName;\r\n      this.staff.phoneNumber = this.oldTeacher.phoneNumber;\r\n      this.staff.email = this.oldTeacher.email;\r\n      this.staff.departmentId = this.oldTeacher.departmentId;\r\n      this.staff.isTrained = this.oldTeacher.isTrained;\r\n      this.staff.isWorking = this.oldTeacher.isWorking;\r\n      this.quitWorkDate = this.oldTeacher.quitWorkDate;\r\n      this.roomIdList = this.oldTeacher.roomList;\r\n      this.subjectIdList = this.oldTeacher.subjectList;\r\n    },\r\n    /**\r\n     * Thực hiện cất dữ liệu\r\n     * Author: VQBao - 21/7/2022\r\n     */\r\n    saveStaffOnClick() {\r\n      var me = this;\r\n      if (me.isTrained) {\r\n        me.staff.isTrained = 1;\r\n      } else {\r\n        me.staff.isTrained = 0;\r\n      }\r\n      if (me.isWorking) {\r\n        me.staff.isWorking = 1;\r\n      } else {\r\n        me.staff.isWorking = 0;\r\n      }\r\n      me.staff.roomId = me.roomIdList;\r\n      me.staff.subjectId = me.subjectIdList;\r\n      // 1. validate dữ liệu, nếu dữ liệu hợp lệ thì gọi api thêm mới giáo viên\r\n      var isValid = me.validateStaffData();\r\n      if (isValid) {\r\n        me.isHideLoader = false;\r\n        // 2. gọi api thực hiên thêm mới dữ liệu\r\n        // nếu saveMode là Add thì thực hiện thêm mới, không thì thực hiện sửa\r\n        if (this.btnSaveMode == MISAEnum.EditMode.Add) {\r\n          if(me.quitWorkDate != null){\r\n            me.quitWorkDate.setDate(me.quitWorkDate.getDate() + 1);\r\n            me.staff.quitWorkDate = me.quitWorkDate;\r\n          }\r\n          axios\r\n            .post(BaseApi.TeacherApi, me.staff)\r\n            .then(function () {\r\n              // ẩn loading\r\n              me.isHideLoader = true;\r\n              me.isHidePopup = true;\r\n              // tắt form sửa thông tin\r\n              me.$emit(\"isShowStaffDialog\", false);\r\n              // load lại dữ liệu của bảng\r\n              me.$emit(\"loadData\", 25, 1, \"\");\r\n              // hiển thị toast message thành công\r\n              me.$emit(\r\n                \"hideToastMessage\",\r\n                MISAResource.TOAST.Add.Title,\r\n                MISAResource.TOAST.Add.Message\r\n              );\r\n              \r\n            })\r\n            .catch(function (err) {\r\n              if(err.response.data.errorMsg == \"Mã giáo viên đã tồn tại trong hệ thống\"){\r\n                me.$refs.staffCode.classList.add(\"input-error\");\r\n                me.errorCode = MISAResource.ERROR.DuplicatedCode;\r\n                me.$nextTick(() => {me.$refs.staffCode.focus()});\r\n                me.isHideLoader = true;\r\n              } else {\r\n                me.isHideLoader = true;\r\n              }\r\n            });\r\n        } else {\r\n          if(me.staffSelected.quitWorkDate == null && me.quitWorkDate != null){\r\n            me.quitWorkDate.setDate(me.quitWorkDate.getDate() + 1);\r\n            me.staff.quitWorkDate = me.quitWorkDate;\r\n          } else {\r\n            me.staff.quitWorkDate = me.quitWorkDate;\r\n          }\r\n          axios\r\n            .put(BaseApi.TeacherApi + `/${me.staffSelectedId}`, me.staff)\r\n            .then(function () {\r\n              // ẩn loading\r\n              me.isHideLoader = true;\r\n              // tắt form sửa thông tin\r\n              me.$emit(\"isShowStaffDialog\", false);\r\n              // load lại dữ liệu của bảng\r\n              me.$emit(\"loadData\", 25, 1, \"\");\r\n              // hiển thị toast message thành công\r\n              me.$emit(\r\n                \"hideToastMessage\",\r\n                MISAResource.TOAST.Edit.Title,\r\n                MISAResource.TOAST.Edit.Message\r\n              );\r\n            })\r\n            .catch(function (err) {\r\n              if(err.response.data.errorMsg == \"Mã giáo viên đã tồn tại trong hệ thống\"){\r\n                me.$refs.staffCode.classList.add(\"input-error\");\r\n                me.errorCode = MISAResource.ERROR.DuplicatedCode;\r\n                me.$nextTick(() => {me.$refs.staffCode.focus()});\r\n                me.isHideLoader = true;\r\n              } else {\r\n                me.isHideLoader = true;\r\n              }\r\n            });\r\n        }\r\n      } else {\r\n        // focus vào input đầu tien bị lỗi\r\n        if(me.errorCode != ''){\r\n          me.$nextTick(() => {me.$refs.staffCode.focus()});\r\n        } else {\r\n          if(me.errorName != ''){\r\n            me.$nextTick(() => {me.$refs.staffName.focus()});\r\n          } else {\r\n            if(me.errorPhone != '') {\r\n              me.$nextTick(() => {me.$refs.staffPhone.focus()});\r\n            } else {\r\n              me.$nextTick(() => {me.$refs.staffEmail.focus()});\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    /**\r\n     * Khi blur, nếu mã giáo viên để trống thì hiện lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\r\n    validateStaffCode() {\r\n      if (!this.staff.teacherCode) {\r\n        this.$refs.staffCode.classList.add(\"input-error\");\r\n        this.errorCode = MISAResource.ERROR.EmptyStaffCode;\r\n      } \r\n      else if(this.staff.teacherCode.length > 20){\r\n        this.$refs.staffCode.classList.add(\"input-error\");\r\n        this.errorCode = MISAResource.ERROR.LongStaffCode;\r\n      }\r\n      else {\r\n        this.$refs.staffCode.classList.remove(\"input-error\");\r\n        this.errorCode = '';\r\n        this.imageStaffCode = this.staff.teacherCode;\r\n      }\r\n    },\r\n    /**\r\n     * Khi blur khỏi input Họ tên, nếu họ tên trống hoặc quá dài thì báo lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\r\n    validateFullName() {\r\n      if (!this.staff.fullName) {\r\n        this.$refs.staffName.classList.add(\"input-error\");\r\n        this.errorName = MISAResource.ERROR.EmptyFullName;\r\n      } \r\n      else if (this.staff.fullName.length > 30) {\r\n        this.$refs.staffName.classList.add(\"input-error\");\r\n        this.errorName = MISAResource.ERROR.LongFullName;\r\n      }\r\n      else {\r\n        this.$refs.staffName.classList.remove(\"input-error\");\r\n        this.errorName = '';\r\n        this.imageStaffName = this.staff.fullName;\r\n      }\r\n    },\r\n    /**\r\n     * Khi blur, nếu email không đúng định dạng thì báo lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\r\n    validateEmail() {\r\n      var email = event.currentTarget.value;\r\n      if (email) {\r\n        var emailFormat =\r\n          /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\r\n        if (!emailFormat.test(email)) {\r\n          event.currentTarget.classList.add(\"input-error\");\r\n          this.errorEmail = MISAResource.ERROR.InValidEmail;\r\n        } else {\r\n          event.currentTarget.classList.remove(\"input-error\");\r\n          this.errorEmail = '';\r\n        }\r\n      } else {\r\n        event.currentTarget.classList.remove(\"input-error\");\r\n        this.errorEmail = '';\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Kiểm tra độ dài số điện thoại\r\n     * Author: VQBao - 27/7/2022\r\n     */\r\n    validatePhoneNumber() {\r\n      var phone = event.currentTarget.value;\r\n      if ((phone.length < 10 && phone.length > 0) || phone.length > 11) {\r\n        event.currentTarget.classList.add(\"input-error\");\r\n        this.errorPhone = MISAResource.ERROR.ShortPhoneLength;\r\n      } else {\r\n        event.currentTarget.classList.remove(\"input-error\");\r\n        this.errorPhone = '';\r\n      }\r\n    },\r\n    /**\r\n     * Thực hiện validate dữ liệu\r\n     * Author: VQBao - 27/7/2022\r\n     */\r\n    validateStaffData() {\r\n      var isValid = true;\r\n      // validate mã giáo viên bỏ trống\r\n      if (!this.staff.teacherCode) {\r\n        isValid = false;\r\n        this.$refs.staffCode.classList.add(\"input-error\");\r\n        this.errorCode = MISAResource.ERROR.EmptyStaffCode;\r\n      }\r\n      // validate mã giáo viên quá dài\r\n      if (this.staff.teacherCode.length > 20) {\r\n        isValid = false;\r\n        this.$refs.staffCode.classList.add(\"input-error\");\r\n        this.errorCode = MISAResource.ERROR.LongStaffCode;\r\n      }\r\n      // validate họ và tên để trống\r\n      if (!this.staff.fullName) {\r\n        isValid = false;\r\n        this.$refs.staffName.classList.add(\"input-error\");        \r\n        this.errorName = MISAResource.ERROR.EmptyFullName;\r\n      }\r\n      // validate họ tên quá dài\r\n      if (this.staff.fullName.length > 30) {\r\n        isValid = false;\r\n        this.$refs.staffName.classList.add(\"input-error\");        \r\n        this.errorName = MISAResource.ERROR.LongFullName;\r\n      }\r\n      // validate email\r\n      if (this.staff.email) {\r\n        var email = this.staff.email;\r\n        if (email) {\r\n          var emailFormat =\r\n            /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\r\n          if (!emailFormat.test(email)) {\r\n            isValid = false;\r\n            this.$refs.staffEmail.classList.add(\"input-error\");\r\n            this.errorEmail = MISAResource.ERROR.InValidEmail;\r\n          }\r\n        }\r\n      }\r\n      // validate số điện thoại\r\n      if (this.staff.phoneNumber) {\r\n        var phone = this.staff.phoneNumber;\r\n        if ((phone.length < 10 && phone.length > 0) || phone.length > 11) {\r\n          isValid = false;\r\n          this.$refs.staffPhone.classList.add(\"input-error\");\r\n          this.errorPhone = MISAResource.ERROR.ShortPhoneLength;\r\n        }\r\n      }           \r\n      return isValid;\r\n    },\r\n    /**\r\n     * Hàm check trình độ quản lý thiết bị\r\n     * Author: VQBao - 28/7/2022\r\n     */\r\n    checkIsTrained() {\r\n      this.isTrained = !this.isTrained;\r\n    },\r\n    /**\r\n     * Hàm check trạng thái làm việc\r\n     * Author: VQBao - 28/7/2022\r\n     */\r\n    checkIsWorking() {\r\n      this.isWorking = !this.isWorking;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.isShowDialog {\r\n  display: flex !important;\r\n}\r\n\r\n.dialog {\r\n  position: fixed;\r\n  align-items: center;\r\n  justify-content: center;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.24);\r\n  display: none;\r\n}\r\n\r\n.dialog-avatar {\r\n  width: 224px;\r\n  height: 384px;\r\n  background-color: var(--white-background);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  box-sizing: border-box;\r\n  border-color: var(--button-border);\r\n}\r\n\r\n.avatar-image {\r\n  width: 160px;\r\n  height: 160px;\r\n  background-color: #ccc;\r\n  margin-top: 24px;\r\n  border-radius: 2px 2px 0 0;\r\n  box-sizing: border-box;\r\n  background-size: 160px 160px;\r\n}\r\n\r\n.img-avatar {\r\n  width: 160px;\r\n  height: 160px;\r\n}\r\n\r\n.avatar-button-picker {\r\n  width: 160px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.avatar-name {\r\n  margin-top: 16px;\r\n  font-size: 16px;\r\n  max-width: 180px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n\r\n.avatar-code {\r\n  font-size: 12px;\r\n  margin-top: 4px;\r\n  max-width: 140px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n\r\n.dialog-content {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: var(--white-background);\r\n}\r\n.content-icon {\r\n  position: absolute;\r\n  width: 36px;\r\n  height: 36px;\r\n  top: 0;\r\n  right: 0;\r\n  cursor: pointer;\r\n}\r\n.dialog-body {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.dialog-body-text {\r\n  background-color: var(--white-backgound);\r\n  font-family: OpenSans-Semibold;\r\n  font-size: 20px;\r\n  width: 400px;\r\n  height: 26px;\r\n  margin-top: 18px;\r\n  margin-left: 32px;\r\n}\r\n\r\n.dialog-body-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-left: 24px;\r\n  margin-top: 24px;\r\n  height: 32px;\r\n  box-sizing: border-box;\r\n  position: relative;\r\n}\r\n\r\n.body-item-text {\r\n  color: #8d8d8d;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.body-item-input {\r\n  width: 200px;\r\n}\r\n\r\n.show-validate-error {\r\n  display: flex !important;\r\n}\r\n.input-validate-error {\r\n  position: absolute;\r\n  z-index: 2;\r\n  display: none;\r\n  align-items: center;\r\n}\r\n\r\n.validate-error-arrow {\r\n  width: 16px;\r\n  height: 16px;\r\n  transform: rotate(45deg);\r\n  background-color: var(--delete-icon-hover);\r\n}\r\n\r\n.validate-error-text {\r\n  color: var(--white-text);\r\n  background-color: var(--delete-icon-hover);\r\n  border-radius: 4px;\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  display: flex;\r\n  align-items: center;\r\n  height: 28px;\r\n  z-index: 3;\r\n  width: max-content;\r\n}\r\n\r\n.body-col-left .input-validate-error {\r\n  left: 306px;\r\n}\r\n\r\n.body-col-left .input-validate-error .validate-error-text {\r\n  margin-left: -14px;\r\n}\r\n\r\n.body-col-right .input-validate-error {\r\n  right: 202px;\r\n}\r\n\r\n.body-col-right .input-validate-error .validate-error-arrow {\r\n  margin-left: -14px;\r\n}\r\n\r\n.body-row {\r\n  width: 100%;\r\n  display: flex;\r\n  margin-right: 24px;\r\n  position: relative;\r\n}\r\n\r\n.body-col-left .body-item-text {\r\n  width: 104px;\r\n}\r\n\r\n.body-col-right .body-item-text {\r\n  width: 86px;\r\n}\r\n\r\n.row-item-checkbox {\r\n  color: var(--button-black-text);\r\n  margin-left: 8px;\r\n}\r\n\r\n.dialog-footer {\r\n  width: 100%;\r\n  height: 60px;\r\n  display: flex;\r\n  position: relative;\r\n}\r\n\r\n#btnPickImage {\r\n  border-radius: 0 0 2px 2px;\r\n}\r\n\r\n#btnClose {\r\n  position: absolute;\r\n  right: 128px;\r\n  top: 14px;\r\n}\r\n\r\n#btnSave {\r\n  position: absolute;\r\n  right: 24px;\r\n  top: 14px;\r\n}\r\n\r\n.day-quit-work {\r\n  width: 150px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n#btnDialogClose {\r\n  width: 24px;\r\n  height: 24px;\r\n  position: absolute;\r\n  right: 8px;\r\n  top: 8px;\r\n  cursor: pointer;\r\n}\r\n\r\n.requiredInput {\r\n  color: red;\r\n  margin-left: 4px;\r\n}\r\n\r\n.input-error {\r\n  border-color: var(--delete-icon-hover);\r\n}\r\n\r\ninput {\r\n  min-width: 120px;\r\n  height: 32px;\r\n  outline: none;\r\n  border: 1px solid #cccccc;\r\n  border-radius: 4px;\r\n  box-sizing: border-box;\r\n  padding: 0 32px 0 16px;\r\n}\r\n\r\ninput:focus {\r\n  border-color: #08bf1e;\r\n}\r\n\r\ninput::placeholder {\r\n  color: var(--button-grey-text);\r\n}\r\n\r\n.select-box {\r\n  width: 200px;\r\n  box-sizing: border-box;\r\n}\r\n.tag-box {\r\n  width: 200px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.tag-box-room {\r\n  width: 510px;\r\n}\r\n\r\n.space {\r\n  height: 384px;\r\n  width: 2px;\r\n  background-color: #fff;\r\n  display: flex;\r\n  align-items: center;\r\n  box-sizing: border-box;\r\n}\r\n.space-border {\r\n  height: 336px;\r\n  width: 2px;\r\n  background-color: var(--button-border);\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}