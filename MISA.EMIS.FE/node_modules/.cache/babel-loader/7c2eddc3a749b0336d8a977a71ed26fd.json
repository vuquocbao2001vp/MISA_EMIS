{"ast":null,"code":"import axios from \"axios\";\nimport BaseCombobox from \"../base/BaseCombobox.vue\";\nimport BaseTagbox from \"../base/BaseTagboxCustom.vue\";\nimport MISAEnum from \"@/script/constants/MISAEnum.js\";\nexport default {\n  components: {\n    BaseCombobox,\n    BaseTagbox\n  },\n  props: [\"isShow\", \"staffSelected\", \"staffSelectedId\", \"btnSaveMode\"],\n\n  data() {\n    return {\n      imageStaffName: \"Họ và tên\",\n      imageStaffCode: \"Số hiệu cán bộ\",\n      staff: {},\n      isCheckCheckbox: [false, false],\n      showDayQuitJob: true\n    };\n  },\n\n  watch: {\n    isShow: function (value) {\n      // khi form thông tin chi tiết mở ra, focus vào ô input đầu tiên\n      if (value == true) {\n        this.isCheckCheckbox[0] = false;\n        this.isCheckCheckbox[1] = false;\n        this.$nextTick(() => {\n          this.$refs.staffCode.focus();\n        });\n      }\n    },\n    staffSelected: function (value) {\n      this.staff = value;\n    },\n    staffSelectedId: function (value) {\n      var me = this;\n\n      if (value) {\n        /**\r\n         * gọi api lấy dữ liệu thông tin chi tiết 1 giáo viên\r\n         * Author: VQBao - 21/7/2022\r\n         */\n        axios.get(`https://localhost:7070/api/v1/Teachers/${me.staffSelectedId}`).then(function (response) {\n          switch (response.status) {\n            case 200:\n              me.staff = response.data;\n              break;\n          }\n        }).catch(function (res) {\n          switch (res.status) {\n            case 404:\n              console.log(\"404 Not Found\");\n              break;\n          }\n        });\n      }\n    }\n  },\n  methods: {\n    /**\r\n     * khi click vào nút đóng thì đóng form giáo viên chi tiết\r\n     * Author: VQBao - 21/7/2022\r\n     */\n    btnCloseOnClick() {\n      this.$emit(\"isShowStaffDialog\", false);\n    },\n\n    /**\r\n     * Thực hiện cất dữ liệu\r\n     * Author: VQBao - 21/7/2022\r\n     */\n    saveStaffOnClick() {\n      var me = this;\n      console.log(me.staff); // 1. validate dữ liệu, nếu dữ liệu hợp lệ thì gọi api thêm mới giáo viên\n\n      var isValid = me.validateStaffData();\n\n      if (isValid) {\n        // 2. gọi api thực hiên thêm mới dữ liệu\n        // nếu saveMode là 1 thì thực hiện thêm mới, là 0 thì thực hiện sửa\n        if (this.btnSaveMode == MISAEnum.EditMode.Add) {\n          axios.post(\"https://localhost:7070/api/v1/Teachers\", me.staff).then(function () {\n            console.log(\"Thêm mới thành công\"); // tắt form sửa thông tin\n\n            me.$emit(\"isShowStaffDialog\", false); // hiển thị toast message thành công\n            // load lại dữ liệu của bảng\n\n            me.$emit(\"loadData\");\n          }).catch(function (err) {\n            console.log(err);\n            let response = err.response;\n\n            switch (response.status) {\n              case 400:\n              case 500:\n                var userMsg = response.data[\"userMsg\"];\n                alert(userMsg);\n                break;\n            }\n          });\n        } else {\n          axios.put(`https://localhost:7070/api/v1/Teachers/${me.staffSelectedId}`, me.staff).then(function () {\n            console.log(\"Sửa thành công\"); // tắt form sửa thông tin\n\n            me.$emit(\"isShowStaffDialog\", false); // load lại dữ liệu của bảng\n\n            me.$emit(\"loadData\");\n          }).catch(function (err) {\n            console.log(err);\n          });\n        }\n      }\n    },\n\n    /**\r\n     * Khi blur, nếu mã giáo viên để trống thì hiện lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\n    validateStaffCode() {\n      if (!this.staff.teacherCode) {\n        this.$refs.staffCode.classList.add(\"input-error\");\n        this.$refs.staffCode.setAttribute(\"title\", \"Mã giáo viên không được phép để trống\");\n        this.imageStaffCode = \"Số hiệu cán bộ\";\n      } else {\n        this.$refs.staffCode.classList.remove(\"input-error\");\n        this.$refs.staffCode.setAttribute(\"title\", \"\");\n        this.imageStaffCode = this.staff.teacherCode;\n      }\n    },\n\n    /**\r\n     * Khi blur khỏi input Họ tên, nếu họ tên trống thì báo lỗi\r\n     */\n    validateFullName() {\n      if (!this.staff.fullName) {\n        this.$refs.staffName.classList.add(\"input-error\");\n        this.$refs.staffName.setAttribute(\"title\", \"Họ tên không được phép để trống\");\n        this.imageStaffName = \"Họ và tên\";\n      } else {\n        this.$refs.staffName.classList.remove(\"input-error\");\n        this.$refs.staffName.setAttribute(\"title\", \"\");\n        this.imageStaffName = this.staff.fullName;\n      }\n    },\n\n    /**\r\n     * Khi blur, nếu email không đúng định dạng thì báo lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\n    validateEmail() {\n      var email = event.currentTarget.value;\n\n      if (email) {\n        var emailFormat = /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\n\n        if (!emailFormat.test(email)) {\n          event.currentTarget.classList.add(\"input-error\");\n          event.currentTarget.setAttribute(\"title\", \"Email không đúng định dạng\");\n        } else {\n          event.currentTarget.classList.remove(\"input-error\");\n          event.currentTarget.setAttribute(\"title\", \"\");\n        }\n      } else {\n        event.currentTarget.classList.remove(\"input-error\");\n        event.currentTarget.setAttribute(\"title\", \"\");\n      }\n    },\n\n    /**\r\n     * Thực hiện validate dữ liệu\r\n     * Author: VQBao - 27/7/2022\r\n     */\n    validateStaffData() {\n      var isValid = true;\n\n      if (!this.staff.teacherCode) {\n        isValid = false;\n        this.$refs.staffCode.classList.add(\"input-error\");\n        this.$refs.staffCode.setAttribute(\"title\", \"Mã giáo viên không được phép để trống\");\n      }\n\n      if (!this.staff.fullName) {\n        isValid = false;\n        this.$refs.staffName.classList.add(\"input-error\");\n        this.$refs.staffName.setAttribute(\"title\", \"Họ tên không được phép để trống\");\n      }\n\n      if (this.staff.email) {\n        var email = this.staff.email;\n\n        if (email) {\n          var emailFormat = /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\n\n          if (!emailFormat.test(email)) {\n            isValid = false;\n            this.$refs.staffEmail.classList.add(\"input-error\");\n            this.$refs.staffEmail.setAttribute(\"title\", \"Email không đúng định dạng\");\n          }\n        }\n      }\n\n      return isValid;\n    },\n\n    /**\r\n     * xử lý khi click vào ô checkbox\r\n     * Author: VQBao - 28/7/2022\r\n     */\n    checkCheckbox(index) {\n      if (!this.isCheckCheckbox[index]) {\n        this.isCheckCheckbox[index] = true;\n\n        if (index == 1) {\n          this.showDayQuitJob = false;\n        }\n      } else {\n        this.isCheckCheckbox[index] = false;\n\n        if (index == 1) {\n          this.showDayQuitJob = true;\n        }\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAqLA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,QAAP,MAAqB,gCAArB;AACA,eAAe;EACbC,UAAU,EAAE;IACVH,YADU;IAEVC;EAFU,CADC;EAKbG,KAAK,EAAE,CAAC,QAAD,EAAW,eAAX,EAA4B,iBAA5B,EAA+C,aAA/C,CALM;;EAMbC,IAAI,GAAG;IACL,OAAO;MACLC,cAAc,EAAE,WADX;MAELC,cAAc,EAAE,gBAFX;MAGLC,KAAK,EAAE,EAHF;MAILC,eAAe,EAAE,CAAC,KAAD,EAAQ,KAAR,CAJZ;MAKLC,cAAc,EAAE;IALX,CAAP;EAOD,CAdY;;EAebC,KAAK,EAAE;IACLC,MAAM,EAAE,UAAUC,KAAV,EAAiB;MACvB;MACA,IAAIA,KAAI,IAAK,IAAb,EAAmB;QACjB,KAAKJ,eAAL,CAAqB,CAArB,IAA0B,KAA1B;QACA,KAAKA,eAAL,CAAqB,CAArB,IAA0B,KAA1B;QACA,KAAKK,SAAL,CAAe,MAAM;UACnB,KAAKC,KAAL,CAAWC,SAAX,CAAqBC,KAArB;QACD,CAFD;MAGF;IACD,CAVI;IAWLC,aAAa,EAAE,UAAUL,KAAV,EAAiB;MAC9B,KAAKL,KAAL,GAAaK,KAAb;IACD,CAbI;IAcLM,eAAe,EAAE,UAAUN,KAAV,EAAiB;MAChC,IAAIO,EAAC,GAAI,IAAT;;MACA,IAAIP,KAAJ,EAAW;QACT;;;;QAIAd,KAAI,CACDsB,GADH,CAEK,0CAAyCD,EAAE,CAACD,eAAgB,EAFjE,EAIGG,IAJH,CAIQ,UAAUC,QAAV,EAAoB;UACxB,QAAQA,QAAQ,CAACC,MAAjB;YACE,KAAK,GAAL;cACEJ,EAAE,CAACZ,KAAH,GAAWe,QAAQ,CAAClB,IAApB;cACA;UAHJ;QAKD,CAVH,EAWGoB,KAXH,CAWS,UAAUC,GAAV,EAAe;UACpB,QAAQA,GAAG,CAACF,MAAZ;YACE,KAAK,GAAL;cACEG,OAAO,CAACC,GAAR,CAAY,eAAZ;cACA;UAHJ;QAKD,CAjBH;MAkBF;IACD;EAxCI,CAfM;EAyDbC,OAAO,EAAE;IACP;;;;IAIAC,eAAe,GAAG;MAChB,KAAKC,KAAL,CAAW,mBAAX,EAAgC,KAAhC;IACD,CAPM;;IAQP;;;;IAIAC,gBAAgB,GAAG;MACjB,IAAIZ,EAAC,GAAI,IAAT;MACAO,OAAO,CAACC,GAAR,CAAYR,EAAE,CAACZ,KAAf,EAFiB,CAGjB;;MACA,IAAIyB,OAAM,GAAIb,EAAE,CAACc,iBAAH,EAAd;;MACA,IAAID,OAAJ,EAAa;QACX;QACA;QACA,IAAI,KAAKE,WAAL,IAAoBjC,QAAQ,CAACkC,QAAT,CAAkBC,GAA1C,EAA+C;UAC7CtC,KAAI,CACDuC,IADH,CACQ,wCADR,EACkDlB,EAAE,CAACZ,KADrD,EAEGc,IAFH,CAEQ,YAAY;YAChBK,OAAO,CAACC,GAAR,CAAY,qBAAZ,EADgB,CAEhB;;YACAR,EAAE,CAACW,KAAH,CAAS,mBAAT,EAA8B,KAA9B,EAHgB,CAIhB;YACA;;YACAX,EAAE,CAACW,KAAH,CAAS,UAAT;UACD,CATH,EAUGN,KAVH,CAUS,UAAUc,GAAV,EAAe;YACpBZ,OAAO,CAACC,GAAR,CAAYW,GAAZ;YACA,IAAIhB,QAAO,GAAIgB,GAAG,CAAChB,QAAnB;;YACA,QAAQA,QAAQ,CAACC,MAAjB;cACE,KAAK,GAAL;cACA,KAAK,GAAL;gBACE,IAAIgB,OAAM,GAAIjB,QAAQ,CAAClB,IAAT,CAAc,SAAd,CAAd;gBACAoC,KAAK,CAACD,OAAD,CAAL;gBACA;YALJ;UAOD,CApBH;QAqBF,CAtBA,MAsBO;UACLzC,KAAI,CACD2C,GADH,CAEK,0CAAyCtB,EAAE,CAACD,eAAgB,EAFjE,EAGIC,EAAE,CAACZ,KAHP,EAKGc,IALH,CAKQ,YAAY;YAChBK,OAAO,CAACC,GAAR,CAAY,gBAAZ,EADgB,CAEhB;;YACAR,EAAE,CAACW,KAAH,CAAS,mBAAT,EAA8B,KAA9B,EAHgB,CAIhB;;YACAX,EAAE,CAACW,KAAH,CAAS,UAAT;UACD,CAXH,EAYGN,KAZH,CAYS,UAAUc,GAAV,EAAe;YACpBZ,OAAO,CAACC,GAAR,CAAYW,GAAZ;UACD,CAdH;QAeF;MACF;IACD,CA5DM;;IA8DP;;;;IAIAI,iBAAiB,GAAG;MAClB,IAAI,CAAC,KAAKnC,KAAL,CAAWoC,WAAhB,EAA6B;QAC3B,KAAK7B,KAAL,CAAWC,SAAX,CAAqB6B,SAArB,CAA+BC,GAA/B,CAAmC,aAAnC;QACA,KAAK/B,KAAL,CAAWC,SAAX,CAAqB+B,YAArB,CACE,OADF,EAEE,uCAFF;QAIA,KAAKxC,cAAL,GAAsB,gBAAtB;MACF,CAPA,MAOO;QACL,KAAKQ,KAAL,CAAWC,SAAX,CAAqB6B,SAArB,CAA+BG,MAA/B,CAAsC,aAAtC;QACA,KAAKjC,KAAL,CAAWC,SAAX,CAAqB+B,YAArB,CAAkC,OAAlC,EAA2C,EAA3C;QACA,KAAKxC,cAAL,GAAsB,KAAKC,KAAL,CAAWoC,WAAjC;MACF;IACD,CA/EM;;IAgFP;;;IAGAK,gBAAgB,GAAG;MACjB,IAAI,CAAC,KAAKzC,KAAL,CAAW0C,QAAhB,EAA0B;QACxB,KAAKnC,KAAL,CAAWoC,SAAX,CAAqBN,SAArB,CAA+BC,GAA/B,CAAmC,aAAnC;QACA,KAAK/B,KAAL,CAAWoC,SAAX,CAAqBJ,YAArB,CACE,OADF,EAEE,iCAFF;QAIA,KAAKzC,cAAL,GAAsB,WAAtB;MACF,CAPA,MAOO;QACL,KAAKS,KAAL,CAAWoC,SAAX,CAAqBN,SAArB,CAA+BG,MAA/B,CAAsC,aAAtC;QACA,KAAKjC,KAAL,CAAWoC,SAAX,CAAqBJ,YAArB,CAAkC,OAAlC,EAA2C,EAA3C;QACA,KAAKzC,cAAL,GAAsB,KAAKE,KAAL,CAAW0C,QAAjC;MACF;IACD,CAhGM;;IAiGP;;;;IAIAE,aAAa,GAAG;MACd,IAAIC,KAAI,GAAIC,KAAK,CAACC,aAAN,CAAoB1C,KAAhC;;MACA,IAAIwC,KAAJ,EAAW;QACT,IAAIG,WAAU,GACZ,0DADF;;QAEA,IAAI,CAACA,WAAW,CAACC,IAAZ,CAAiBJ,KAAjB,CAAL,EAA8B;UAC5BC,KAAK,CAACC,aAAN,CAAoBV,SAApB,CAA8BC,GAA9B,CAAkC,aAAlC;UACAQ,KAAK,CAACC,aAAN,CAAoBR,YAApB,CACE,OADF,EAEE,4BAFF;QAIF,CANA,MAMO;UACLO,KAAK,CAACC,aAAN,CAAoBV,SAApB,CAA8BG,MAA9B,CAAqC,aAArC;UACAM,KAAK,CAACC,aAAN,CAAoBR,YAApB,CAAiC,OAAjC,EAA0C,EAA1C;QACF;MACF,CAbA,MAaO;QACLO,KAAK,CAACC,aAAN,CAAoBV,SAApB,CAA8BG,MAA9B,CAAqC,aAArC;QACAM,KAAK,CAACC,aAAN,CAAoBR,YAApB,CAAiC,OAAjC,EAA0C,EAA1C;MACF;IACD,CAxHM;;IAyHP;;;;IAIAb,iBAAiB,GAAG;MAClB,IAAID,OAAM,GAAI,IAAd;;MACA,IAAI,CAAC,KAAKzB,KAAL,CAAWoC,WAAhB,EAA6B;QAC3BX,OAAM,GAAI,KAAV;QACA,KAAKlB,KAAL,CAAWC,SAAX,CAAqB6B,SAArB,CAA+BC,GAA/B,CAAmC,aAAnC;QACA,KAAK/B,KAAL,CAAWC,SAAX,CAAqB+B,YAArB,CACE,OADF,EAEE,uCAFF;MAIF;;MACA,IAAI,CAAC,KAAKvC,KAAL,CAAW0C,QAAhB,EAA0B;QACxBjB,OAAM,GAAI,KAAV;QACA,KAAKlB,KAAL,CAAWoC,SAAX,CAAqBN,SAArB,CAA+BC,GAA/B,CAAmC,aAAnC;QACA,KAAK/B,KAAL,CAAWoC,SAAX,CAAqBJ,YAArB,CACE,OADF,EAEE,iCAFF;MAIF;;MACA,IAAI,KAAKvC,KAAL,CAAW6C,KAAf,EAAsB;QACpB,IAAIA,KAAI,GAAI,KAAK7C,KAAL,CAAW6C,KAAvB;;QACA,IAAIA,KAAJ,EAAW;UACT,IAAIG,WAAU,GACZ,0DADF;;UAEA,IAAI,CAACA,WAAW,CAACC,IAAZ,CAAiBJ,KAAjB,CAAL,EAA8B;YAC5BpB,OAAM,GAAI,KAAV;YACA,KAAKlB,KAAL,CAAW2C,UAAX,CAAsBb,SAAtB,CAAgCC,GAAhC,CAAoC,aAApC;YACA,KAAK/B,KAAL,CAAW2C,UAAX,CAAsBX,YAAtB,CACE,OADF,EAEE,4BAFF;UAIF;QACF;MACF;;MACA,OAAOd,OAAP;IACD,CA/JM;;IAgKP;;;;IAIA0B,aAAa,CAACC,KAAD,EAAQ;MACnB,IAAI,CAAC,KAAKnD,eAAL,CAAqBmD,KAArB,CAAL,EAAkC;QAChC,KAAKnD,eAAL,CAAqBmD,KAArB,IAA8B,IAA9B;;QACA,IAAIA,KAAI,IAAK,CAAb,EAAgB;UACd,KAAKlD,cAAL,GAAsB,KAAtB;QACF;MACF,CALA,MAKO;QACL,KAAKD,eAAL,CAAqBmD,KAArB,IAA8B,KAA9B;;QACA,IAAIA,KAAI,IAAK,CAAb,EAAgB;UACd,KAAKlD,cAAL,GAAsB,IAAtB;QACF;MACF;IACD;;EAhLM;AAzDI,CAAf","names":["axios","BaseCombobox","BaseTagbox","MISAEnum","components","props","data","imageStaffName","imageStaffCode","staff","isCheckCheckbox","showDayQuitJob","watch","isShow","value","$nextTick","$refs","staffCode","focus","staffSelected","staffSelectedId","me","get","then","response","status","catch","res","console","log","methods","btnCloseOnClick","$emit","saveStaffOnClick","isValid","validateStaffData","btnSaveMode","EditMode","Add","post","err","userMsg","alert","put","validateStaffCode","teacherCode","classList","add","setAttribute","remove","validateFullName","fullName","staffName","validateEmail","email","event","currentTarget","emailFormat","test","staffEmail","checkCheckbox","index"],"sourceRoot":"","sources":["E:\\MisaProject\\W2022_06\\misa_emis\\src\\components\\dialog\\DialogStaffDetail.vue"],"sourcesContent":["<template>\r\n  <div class=\"dialog\" v-if=\"isShow\" :class=\"{ isShowDialog: isShow }\">\r\n    <div class=\"dialog-avatar\">\r\n      <div class=\"avatar-image icon-center icon-avatar\"></div>\r\n      <BaseButton\r\n        class=\"avatar-button-picker\"\r\n        buttonName=\"Chọn ảnh\"\r\n        buttonType=\"button-green\"\r\n      />\r\n      <span class=\"avatar-name\">{{ imageStaffName }}</span>\r\n      <span class=\"avatar-code\">{{ imageStaffCode }}</span>\r\n    </div>\r\n    <div class=\"dialog-content\">\r\n      <div\r\n        @click=\"btnCloseOnClick\"\r\n        class=\"content-icon icon-center icon-X-2\"\r\n      ></div>\r\n      <div class=\"dialog-body\">\r\n        <div class=\"dialog-body-text\">Thêm hồ sơ Cán bộ, giáo viên</div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item body-col-left\">\r\n            <div class=\"body-item-text\">\r\n              Số hiệu cán bộ<span class=\"requiredInput\">*</span>\r\n            </div>\r\n            <input\r\n              tabindex=\"1\"\r\n              type=\"text\"\r\n              class=\"body-item-input\"\r\n              v-model=\"staff.teacherCode\"\r\n              ref=\"staffCode\"\r\n              @blur=\"validateStaffCode\"\r\n            />\r\n            <div class=\"input-validate-error\">\r\n              <div class=\"validate-error-arrow\"></div>\r\n              <div class=\"validate-error-text\">\r\n                Số hiệu cán bộ không được bỏ trống\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"dialog-body-item body-col-right\">\r\n            <div class=\"body-item-text\">\r\n              Họ và tên<span class=\"requiredInput\">*</span>\r\n            </div>\r\n            <input\r\n              tabindex=\"2\"\r\n              type=\"text\"\r\n              class=\"body-item-input\"\r\n              ref=\"staffName\"\r\n              v-model=\"staff.fullName\"\r\n              @blur=\"validateFullName\"\r\n            />\r\n            <div class=\"input-validate-error\">\r\n              <div class=\"validate-error-text\">Họ tên không được bỏ trống</div>\r\n              <div class=\"validate-error-arrow\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item body-col-left\">\r\n            <div class=\"body-item-text\">Số điện thoại</div>\r\n            <input\r\n              tabindex=\"3\"\r\n              type=\"text\"\r\n              class=\"body-item-input\"\r\n              ref=\"staffPhone\"\r\n              v-model=\"staff.phoneNumber\"\r\n            />\r\n            <div class=\"input-validate-error\">\r\n              <div class=\"validate-error-arrow\"></div>\r\n              <div class=\"validate-error-text\">\r\n                Số điện thoại không đủ độ dài\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"dialog-body-item body-col-right\">\r\n            <div class=\"body-item-text\">Email</div>\r\n            <input\r\n              tabindex=\"4\"\r\n              type=\"text\"\r\n              class=\"body-item-input\"\r\n              ref=\"staffEmail\"\r\n              v-model=\"staff.email\"\r\n              @blur=\"validateEmail\"\r\n            />\r\n            <div class=\"input-validate-error\">\r\n              <div class=\"validate-error-text\">Email không đúng định dạng</div>\r\n              <div class=\"validate-error-arrow\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item body-col-left\">\r\n            <div class=\"body-item-text\">Tổ bộ môn</div>\r\n            <BaseCombobox\r\n              tabindex=\"5\"\r\n              :url=\"'https://localhost:7070/api/v1/Departments'\"\r\n              :propKey=\"'departmentId'\"\r\n              :propValue=\"'departmentName'\"\r\n            />\r\n          </div>\r\n          <div class=\"dialog-body-item body-col-right\">\r\n            <div class=\"body-item-text\">QL theo môn</div>\r\n            <BaseTagbox\r\n              tabindex=\"6\"\r\n              :url=\"'https://localhost:7070/api/v1/Subjects'\"\r\n              :propKey=\"'subjectId'\"\r\n              :propValue=\"'subjectName'\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item body-col-left\">\r\n            <div class=\"body-item-text\">QL kho, phòng</div>\r\n            <BaseTagbox\r\n              class=\"room-tagbox\"\r\n              tabindex=\"7\"\r\n              :url=\"'https://localhost:7070/api/v1/Rooms'\"\r\n              :propKey=\"'roomId'\"\r\n              :propValue=\"'roomName'\"/>\r\n          </div>\r\n        </div>\r\n        <div class=\"body-row\">\r\n          <div class=\"dialog-body-item\">\r\n            <BaseCheckbox\r\n              tabindex=\"8\"\r\n              :class=\"\r\n                isCheckCheckbox[0] ? 'checkbox-active' : 'checkbox-inactive',\r\n                {''}\r\n              \"\r\n              @click=\"checkCheckbox(0)\"\r\n              @keyup.space=\"checkCheckbox(0)\"\r\n              @keyup.enter=\"checkCheckbox(0)\"\r\n            />\r\n            <div class=\"body-item-text row-item-checkbox\">\r\n              Trình độ nghiệp vụ QLTB\r\n            </div>\r\n          </div>\r\n          <div class=\"dialog-body-item\">\r\n            <BaseCheckbox\r\n              tabindex=\"9\"\r\n              :class=\"\r\n                isCheckCheckbox[1] ? 'checkbox-active' : 'checkbox-inactive'\r\n              \"\r\n              @click=\"checkCheckbox(1)\"\r\n              @keyup.space=\"checkCheckbox(1)\"\r\n              @keyup.enter=\"checkCheckbox(1)\"\r\n            />\r\n            <div class=\"body-item-text row-item-checkbox\">Đang làm việc</div>\r\n          </div>\r\n          <div\r\n            class=\"dialog-body-item\"\r\n            style=\"position: absolute; right: 24px\"\r\n            v-show=\"showDayQuitJob == true\"\r\n          >\r\n            <div class=\"body-item-text\" style=\"margin-right: 8px\">\r\n              Ngày nghỉ việc\r\n            </div>\r\n            <input tabindex=\"10\" id=\"dtDayOff\" class=\"input\" type=\"date\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"dialog-footer\">\r\n        <BaseButton\r\n          tabindex=\"11\"\r\n          id=\"btnClose\"\r\n          buttonName=\"Đóng\"\r\n          buttonType=\"button-white\"\r\n          @click=\"btnCloseOnClick\"\r\n        />\r\n        <BaseButton\r\n          tabindex=\"12\"\r\n          id=\"btnSave\"\r\n          buttonName=\"Lưu\"\r\n          buttonType=\"button-green\"\r\n          @click=\"saveStaffOnClick\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport BaseCombobox from \"../base/BaseCombobox.vue\";\r\nimport BaseTagbox from \"../base/BaseTagboxCustom.vue\";\r\nimport MISAEnum from \"@/script/constants/MISAEnum.js\";\r\nexport default {\r\n  components: {\r\n    BaseCombobox,\r\n    BaseTagbox,\r\n  },\r\n  props: [\"isShow\", \"staffSelected\", \"staffSelectedId\", \"btnSaveMode\"],\r\n  data() {\r\n    return {\r\n      imageStaffName: \"Họ và tên\",\r\n      imageStaffCode: \"Số hiệu cán bộ\",\r\n      staff: {},\r\n      isCheckCheckbox: [false, false],\r\n      showDayQuitJob: true,\r\n    };\r\n  },\r\n  watch: {\r\n    isShow: function (value) {\r\n      // khi form thông tin chi tiết mở ra, focus vào ô input đầu tiên\r\n      if (value == true) {\r\n        this.isCheckCheckbox[0] = false;\r\n        this.isCheckCheckbox[1] = false;\r\n        this.$nextTick(() => {\r\n          this.$refs.staffCode.focus();\r\n        });\r\n      }\r\n    },\r\n    staffSelected: function (value) {\r\n      this.staff = value;\r\n    },\r\n    staffSelectedId: function (value) {\r\n      var me = this;\r\n      if (value) {\r\n        /**\r\n         * gọi api lấy dữ liệu thông tin chi tiết 1 giáo viên\r\n         * Author: VQBao - 21/7/2022\r\n         */\r\n        axios\r\n          .get(\r\n            `https://localhost:7070/api/v1/Teachers/${me.staffSelectedId}`\r\n          )\r\n          .then(function (response) {\r\n            switch (response.status) {\r\n              case 200:\r\n                me.staff = response.data;\r\n                break;\r\n            }\r\n          })\r\n          .catch(function (res) {\r\n            switch (res.status) {\r\n              case 404:\r\n                console.log(\"404 Not Found\");\r\n                break;\r\n            }\r\n          });\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    /**\r\n     * khi click vào nút đóng thì đóng form giáo viên chi tiết\r\n     * Author: VQBao - 21/7/2022\r\n     */\r\n    btnCloseOnClick() {\r\n      this.$emit(\"isShowStaffDialog\", false);\r\n    },\r\n    /**\r\n     * Thực hiện cất dữ liệu\r\n     * Author: VQBao - 21/7/2022\r\n     */\r\n    saveStaffOnClick() {\r\n      var me = this;\r\n      console.log(me.staff);\r\n      // 1. validate dữ liệu, nếu dữ liệu hợp lệ thì gọi api thêm mới giáo viên\r\n      var isValid = me.validateStaffData();\r\n      if (isValid) {\r\n        // 2. gọi api thực hiên thêm mới dữ liệu\r\n        // nếu saveMode là 1 thì thực hiện thêm mới, là 0 thì thực hiện sửa\r\n        if (this.btnSaveMode == MISAEnum.EditMode.Add) {\r\n          axios\r\n            .post(\"https://localhost:7070/api/v1/Teachers\", me.staff)\r\n            .then(function () {\r\n              console.log(\"Thêm mới thành công\");\r\n              // tắt form sửa thông tin\r\n              me.$emit(\"isShowStaffDialog\", false);\r\n              // hiển thị toast message thành công\r\n              // load lại dữ liệu của bảng\r\n              me.$emit(\"loadData\");\r\n            })\r\n            .catch(function (err) {\r\n              console.log(err);\r\n              let response = err.response;\r\n              switch (response.status) {\r\n                case 400:\r\n                case 500:\r\n                  var userMsg = response.data[\"userMsg\"];\r\n                  alert(userMsg);\r\n                  break;\r\n              }\r\n            });\r\n        } else {\r\n          axios\r\n            .put(\r\n              `https://localhost:7070/api/v1/Teachers/${me.staffSelectedId}`,\r\n              me.staff\r\n            )\r\n            .then(function () {\r\n              console.log(\"Sửa thành công\");\r\n              // tắt form sửa thông tin\r\n              me.$emit(\"isShowStaffDialog\", false);\r\n              // load lại dữ liệu của bảng\r\n              me.$emit(\"loadData\");\r\n            })\r\n            .catch(function (err) {\r\n              console.log(err);\r\n            });\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Khi blur, nếu mã giáo viên để trống thì hiện lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\r\n    validateStaffCode() {\r\n      if (!this.staff.teacherCode) {\r\n        this.$refs.staffCode.classList.add(\"input-error\");\r\n        this.$refs.staffCode.setAttribute(\r\n          \"title\",\r\n          \"Mã giáo viên không được phép để trống\"\r\n        );\r\n        this.imageStaffCode = \"Số hiệu cán bộ\";\r\n      } else {\r\n        this.$refs.staffCode.classList.remove(\"input-error\");\r\n        this.$refs.staffCode.setAttribute(\"title\", \"\");\r\n        this.imageStaffCode = this.staff.teacherCode;\r\n      }\r\n    },\r\n    /**\r\n     * Khi blur khỏi input Họ tên, nếu họ tên trống thì báo lỗi\r\n     */\r\n    validateFullName() {\r\n      if (!this.staff.fullName) {\r\n        this.$refs.staffName.classList.add(\"input-error\");\r\n        this.$refs.staffName.setAttribute(\r\n          \"title\",\r\n          \"Họ tên không được phép để trống\"\r\n        );\r\n        this.imageStaffName = \"Họ và tên\";\r\n      } else {\r\n        this.$refs.staffName.classList.remove(\"input-error\");\r\n        this.$refs.staffName.setAttribute(\"title\", \"\");\r\n        this.imageStaffName = this.staff.fullName;\r\n      }\r\n    },\r\n    /**\r\n     * Khi blur, nếu email không đúng định dạng thì báo lỗi\r\n     * Author: VQBao - 27/7/2022\r\n     */\r\n    validateEmail() {\r\n      var email = event.currentTarget.value;\r\n      if (email) {\r\n        var emailFormat =\r\n          /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\r\n        if (!emailFormat.test(email)) {\r\n          event.currentTarget.classList.add(\"input-error\");\r\n          event.currentTarget.setAttribute(\r\n            \"title\",\r\n            \"Email không đúng định dạng\"\r\n          );\r\n        } else {\r\n          event.currentTarget.classList.remove(\"input-error\");\r\n          event.currentTarget.setAttribute(\"title\", \"\");\r\n        }\r\n      } else {\r\n        event.currentTarget.classList.remove(\"input-error\");\r\n        event.currentTarget.setAttribute(\"title\", \"\");\r\n      }\r\n    },\r\n    /**\r\n     * Thực hiện validate dữ liệu\r\n     * Author: VQBao - 27/7/2022\r\n     */\r\n    validateStaffData() {\r\n      var isValid = true;\r\n      if (!this.staff.teacherCode) {\r\n        isValid = false;\r\n        this.$refs.staffCode.classList.add(\"input-error\");\r\n        this.$refs.staffCode.setAttribute(\r\n          \"title\",\r\n          \"Mã giáo viên không được phép để trống\"\r\n        );\r\n      }\r\n      if (!this.staff.fullName) {\r\n        isValid = false;\r\n        this.$refs.staffName.classList.add(\"input-error\");\r\n        this.$refs.staffName.setAttribute(\r\n          \"title\",\r\n          \"Họ tên không được phép để trống\"\r\n        );\r\n      }\r\n      if (this.staff.email) {\r\n        var email = this.staff.email;\r\n        if (email) {\r\n          var emailFormat =\r\n            /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\r\n          if (!emailFormat.test(email)) {\r\n            isValid = false;\r\n            this.$refs.staffEmail.classList.add(\"input-error\");\r\n            this.$refs.staffEmail.setAttribute(\r\n              \"title\",\r\n              \"Email không đúng định dạng\"\r\n            );\r\n          }\r\n        }\r\n      }\r\n      return isValid;\r\n    },\r\n    /**\r\n     * xử lý khi click vào ô checkbox\r\n     * Author: VQBao - 28/7/2022\r\n     */\r\n    checkCheckbox(index) {\r\n      if (!this.isCheckCheckbox[index]) {\r\n        this.isCheckCheckbox[index] = true;\r\n        if (index == 1) {\r\n          this.showDayQuitJob = false;\r\n        }\r\n      } else {\r\n        this.isCheckCheckbox[index] = false;\r\n        if (index == 1) {\r\n          this.showDayQuitJob = true;\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.isShowDialog {\r\n  display: flex !important;\r\n}\r\n\r\n.dialog {\r\n  position: fixed;\r\n  align-items: center;\r\n  justify-content: center;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.24);\r\n  display: none;\r\n}\r\n\r\n.dialog-avatar {\r\n  width: 224px;\r\n  height: 384px;\r\n  background-color: var(--white-background);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  box-sizing: border-box;\r\n  border-right: 2px solid;\r\n  border-color: var(--button-border);\r\n}\r\n\r\n.avatar-image {\r\n  width: 160px;\r\n  height: 160px;\r\n  background-color: #ccc;\r\n  margin-top: 24px;\r\n  border-radius: 2px 2px 0 0;\r\n  background-size: 160px 160px;\r\n}\r\n\r\n.avatar-button-picker {\r\n  width: 160px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.avatar-name {\r\n  margin-top: 16px;\r\n  font-size: 16px;\r\n}\r\n\r\n.avatar-code {\r\n  font-size: 12px;\r\n  margin-top: 4px;\r\n}\r\n\r\n.dialog-content {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: var(--white-background);\r\n}\r\n.content-icon {\r\n  position: absolute;\r\n  width: 36px;\r\n  height: 36px;\r\n  top: 0;\r\n  right: 0;\r\n  cursor: pointer;\r\n}\r\n.dialog-body {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.dialog-body-text {\r\n  background-color: var(--white-backgound);\r\n  font-family: OpenSans-Semibold;\r\n  font-size: 20px;\r\n  width: 400px;\r\n  height: 26px;\r\n  margin-top: 18px;\r\n  margin-left: 32px;\r\n}\r\n\r\n.dialog-body-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-left: 24px;\r\n  margin-top: 24px;\r\n  height: 32px;\r\n  box-sizing: border-box;\r\n  position: relative;\r\n}\r\n\r\n.body-item-text {\r\n  color: #8d8d8d;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.body-item-input {\r\n  width: 200px;\r\n}\r\n\r\n.input-validate-error {\r\n  position: absolute;\r\n  z-index: 2;\r\n  /* display: flex; */\r\n  display: none;\r\n  align-items: center;\r\n  width: fit-content;\r\n}\r\n\r\n.validate-error-arrow {\r\n  width: 16px;\r\n  height: 16px;\r\n  transform: rotate(45deg);\r\n  background-color: var(--delete-icon-hover);\r\n}\r\n\r\n.validate-error-text {\r\n  color: var(--white-text);\r\n  background-color: var(--delete-icon-hover);\r\n  border-radius: 4px;\r\n  display: flex;\r\n  align-items: center;\r\n  padding-left: 8px;\r\n  padding-right: 8px;\r\n  z-index: 3;\r\n  height: 28px;\r\n}\r\n\r\n.body-col-left .input-validate-error {\r\n  left: 306px;\r\n}\r\n\r\n.body-col-left .input-validate-error .validate-error-text {\r\n  margin-left: -14px;\r\n}\r\n\r\n.body-col-right .input-validate-error {\r\n  right: 202px;\r\n}\r\n\r\n.body-col-right .input-validate-error .validate-error-arrow {\r\n  margin-left: -14px;\r\n}\r\n\r\n.body-row {\r\n  width: 100%;\r\n  display: flex;\r\n  margin-right: 24px;\r\n  position: relative;\r\n}\r\n\r\n.body-col-left .body-item-text {\r\n  width: 104px;\r\n}\r\n\r\n.body-col-right .body-item-text {\r\n  width: 86px;\r\n}\r\n\r\n.row-item-checkbox {\r\n  color: var(--button-black-text);\r\n  margin-left: 8px;\r\n}\r\n\r\n.dialog-footer {\r\n  width: 100%;\r\n  height: 60px;\r\n  display: flex;\r\n  position: relative;\r\n}\r\n\r\n#btnPickImage {\r\n  border-radius: 0 0 2px 2px;\r\n}\r\n\r\n#btnClose {\r\n  position: absolute;\r\n  right: 128px;\r\n  top: 14px;\r\n}\r\n\r\n#btnSave {\r\n  position: absolute;\r\n  right: 24px;\r\n  top: 14px;\r\n}\r\n\r\n#dtDayOff {\r\n  width: 150px;\r\n  padding: 0 16px;\r\n}\r\n\r\n#btnDialogClose {\r\n  width: 24px;\r\n  height: 24px;\r\n  position: absolute;\r\n  right: 8px;\r\n  top: 8px;\r\n  cursor: pointer;\r\n}\r\n\r\n.room-tagbox {\r\n  width: 510px;\r\n}\r\n\r\n.requiredInput {\r\n  color: red;\r\n  margin-left: 4px;\r\n}\r\n\r\n.input-error {\r\n  border-color: var(--delete-icon-hover);\r\n}\r\n\r\ninput {\r\n  min-width: 120px;\r\n  height: 32px;\r\n  outline: none;\r\n  border: 1px solid #cccccc;\r\n  border-radius: 4px;\r\n  box-sizing: border-box;\r\n  padding: 0 32px 0 16px;\r\n}\r\n\r\ninput:focus {\r\n  border-color: #08bf1e;\r\n}\r\n\r\ninput::placeholder {\r\n  color: var(--button-grey-text);\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}