{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\n/**\r\n * DevExtreme (esm/ui/selection/selection.strategy.standard.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getKeyHash } from \"../../core/utils/common\";\nimport { isDefined, isObject } from \"../../core/utils/type\";\nimport { removeDuplicates, getUniqueValues } from \"../../core/utils/array\";\nimport { isKeysEqual } from \"../../core/utils/array_compare\";\nimport dataQuery from \"../../data/query\";\nimport { Deferred, when } from \"../../core/utils/deferred\";\nimport { SelectionFilterCreator } from \"../../core/utils/selection_filter\";\nimport errors from \"../widget/ui.errors\";\nimport SelectionStrategy from \"./selection.strategy\";\nexport default SelectionStrategy.inherit({\n  ctor: function (options) {\n    this.callBase(options);\n\n    this._initSelectedItemKeyHash();\n  },\n  _initSelectedItemKeyHash: function () {\n    this._setOption(\"keyHashIndices\", this.options.equalByReference ? null : {});\n  },\n  getSelectedItemKeys: function () {\n    return this.options.selectedItemKeys.slice(0);\n  },\n  getSelectedItems: function () {\n    return this.options.selectedItems.slice(0);\n  },\n  _preserveSelectionUpdate: function (items, isDeselect) {\n    var keyOf = this.options.keyOf;\n    var keyIndicesToRemoveMap;\n    var keyIndex;\n    var i;\n\n    if (!keyOf) {\n      return;\n    }\n\n    var isBatchDeselect = isDeselect && items.length > 1 && !this.options.equalByReference;\n\n    if (isBatchDeselect) {\n      keyIndicesToRemoveMap = {};\n    }\n\n    for (i = 0; i < items.length; i++) {\n      var item = items[i];\n      var key = keyOf(item);\n\n      if (isDeselect) {\n        keyIndex = this.removeSelectedItem(key, keyIndicesToRemoveMap, null === item || void 0 === item ? void 0 : item.disabled);\n\n        if (keyIndicesToRemoveMap && keyIndex >= 0) {\n          keyIndicesToRemoveMap[keyIndex] = true;\n        }\n      } else {\n        this.addSelectedItem(key, item);\n      }\n    }\n\n    if (isBatchDeselect) {\n      this._batchRemoveSelectedItems(keyIndicesToRemoveMap);\n    }\n  },\n  _batchRemoveSelectedItems: function (keyIndicesToRemoveMap) {\n    var selectedItemKeys = this.options.selectedItemKeys.slice(0);\n    var selectedItems = this.options.selectedItems.slice(0);\n    this.options.selectedItemKeys.length = 0;\n    this.options.selectedItems.length = 0;\n\n    for (var i = 0; i < selectedItemKeys.length; i++) {\n      if (!keyIndicesToRemoveMap[i]) {\n        this.options.selectedItemKeys.push(selectedItemKeys[i]);\n        this.options.selectedItems.push(selectedItems[i]);\n      }\n    }\n\n    this._initSelectedItemKeyHash();\n\n    this.updateSelectedItemKeyHash(this.options.selectedItemKeys);\n  },\n  _loadSelectedItemsCore: function (keys, isDeselect, isSelectAll, filter) {\n    var deferred = new Deferred();\n    var key = this.options.key();\n\n    if (!keys.length && !isSelectAll) {\n      deferred.resolve([]);\n      return deferred;\n    }\n\n    if (isSelectAll && isDeselect && !filter) {\n      deferred.resolve(this.getSelectedItems());\n      return deferred;\n    }\n\n    var selectionFilterCreator = new SelectionFilterCreator(keys, isSelectAll);\n    var combinedFilter = selectionFilterCreator.getCombinedFilter(key, filter);\n    var deselectedItems = [];\n\n    if (isDeselect) {\n      var selectedItems = this.options.selectedItems;\n      deselectedItems = combinedFilter && keys.length !== selectedItems.length ? dataQuery(selectedItems).filter(combinedFilter).toArray() : selectedItems.slice(0);\n    }\n\n    var filteredItems = deselectedItems.length ? deselectedItems : this.options.plainItems(true).filter(this.options.isSelectableItem).map(this.options.getItemData);\n    var localFilter = selectionFilterCreator.getLocalFilter(this.options.keyOf, this.equalKeys.bind(this), this.options.equalByReference, key);\n    filteredItems = filteredItems.filter(localFilter);\n\n    if (deselectedItems.length || !isSelectAll && filteredItems.length === keys.length) {\n      deferred.resolve(filteredItems);\n    } else {\n      deferred = this._loadFilteredData(combinedFilter, localFilter, null, isSelectAll);\n    }\n\n    return deferred;\n  },\n  _replaceSelectionUpdate: function (items) {\n    var internalKeys = [];\n    var keyOf = this.options.keyOf;\n\n    if (!keyOf) {\n      return;\n    }\n\n    for (var i = 0; i < items.length; i++) {\n      var item = items[i];\n      var key = keyOf(item);\n      internalKeys.push(key);\n    }\n\n    this.setSelectedItems(internalKeys, items);\n  },\n  _warnOnIncorrectKeys: function (keys) {\n    var allowNullValue = this.options.allowNullValue;\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n\n      if ((!allowNullValue || null !== key) && !this.isItemKeySelected(key)) {\n        errors.log(\"W1002\", key);\n      }\n    }\n  },\n  _isMultiSelectEnabled: function () {\n    var mode = this.options.mode;\n    return \"all\" === mode || \"multiple\" === mode;\n  },\n  _requestInProgress: function () {\n    var _this$_lastLoadDeferr;\n\n    return \"pending\" === (null === (_this$_lastLoadDeferr = this._lastLoadDeferred) || void 0 === _this$_lastLoadDeferr ? void 0 : _this$_lastLoadDeferr.state());\n  },\n  _concatRequestsItems: function (keys, isDeselect, oldRequestItems, updatedKeys) {\n    var selectedItems;\n    var deselectedItems = isDeselect ? keys : [];\n\n    if (updatedKeys) {\n      selectedItems = updatedKeys;\n    } else {\n      selectedItems = removeDuplicates(keys, this.options.selectedItemKeys);\n    }\n\n    return {\n      addedItems: oldRequestItems.added.concat(selectedItems),\n      removedItems: oldRequestItems.removed.concat(deselectedItems),\n      keys: keys\n    };\n  },\n  _collectLastRequestData: function (keys, isDeselect, isSelectAll, updatedKeys) {\n    var isDeselectAll = isDeselect && isSelectAll;\n    var oldRequestItems = {\n      added: [],\n      removed: []\n    };\n\n    var multiSelectEnabled = this._isMultiSelectEnabled();\n\n    var lastRequestData = multiSelectEnabled ? this._lastRequestData : {};\n\n    if (multiSelectEnabled) {\n      if (this._shouldMergeWithLastRequest) {\n        if (isDeselectAll) {\n          this._lastLoadDeferred.reject();\n\n          lastRequestData = {};\n        } else if (!isKeysEqual(keys, this.options.selectedItemKeys)) {\n          oldRequestItems.added = lastRequestData.addedItems;\n          oldRequestItems.removed = lastRequestData.removedItems;\n\n          if (!isDeselect) {\n            this._lastLoadDeferred.reject();\n          }\n        }\n      }\n\n      lastRequestData = this._concatRequestsItems(keys, isDeselect, oldRequestItems, this._shouldMergeWithLastRequest ? void 0 : updatedKeys);\n    }\n\n    return lastRequestData;\n  },\n  _updateKeysByLastRequestData: function (keys, isDeselect, isSelectAll) {\n    var currentKeys = keys;\n\n    if (this._isMultiSelectEnabled() && this._shouldMergeWithLastRequest && !isDeselect && !isSelectAll) {\n      var _this$_lastRequestDat, _this$_lastRequestDat2;\n\n      currentKeys = removeDuplicates(keys.concat(null === (_this$_lastRequestDat = this._lastRequestData) || void 0 === _this$_lastRequestDat ? void 0 : _this$_lastRequestDat.addedItems), null === (_this$_lastRequestDat2 = this._lastRequestData) || void 0 === _this$_lastRequestDat2 ? void 0 : _this$_lastRequestDat2.removedItems);\n      currentKeys = getUniqueValues(currentKeys);\n    }\n\n    return currentKeys;\n  },\n  _loadSelectedItems: function (keys, isDeselect, isSelectAll, updatedKeys) {\n    var that = this;\n    var deferred = new Deferred();\n    var filter = that.options.filter();\n    this._shouldMergeWithLastRequest = this._requestInProgress();\n    this._lastRequestData = this._collectLastRequestData(keys, isDeselect, isSelectAll, updatedKeys);\n    when(that._lastLoadDeferred).always(function () {\n      var currentKeys = that._updateKeysByLastRequestData(keys, isDeselect, isSelectAll);\n\n      that._shouldMergeWithLastRequest = false;\n\n      that._loadSelectedItemsCore(currentKeys, isDeselect, isSelectAll, filter).done(deferred.resolve).fail(deferred.reject);\n    });\n    that._lastLoadDeferred = deferred;\n    return deferred;\n  },\n  selectedItemKeys: function (keys, preserve, isDeselect, isSelectAll, updatedKeys) {\n    var that = this;\n\n    var deferred = that._loadSelectedItems(keys, isDeselect, isSelectAll, updatedKeys);\n\n    deferred.done(function (items) {\n      if (preserve) {\n        that._preserveSelectionUpdate(items, isDeselect);\n      } else {\n        that._replaceSelectionUpdate(items);\n      }\n\n      that.onSelectionChanged();\n    });\n    return deferred;\n  },\n  addSelectedItem: function (key, itemData) {\n    if (isDefined(itemData) && !this.options.ignoreDisabledItems && itemData.disabled) {\n      if (-1 === this.options.disabledItemKeys.indexOf(key)) {\n        this.options.disabledItemKeys.push(key);\n      }\n\n      return;\n    }\n\n    var keyHash = this._getKeyHash(key);\n\n    if (-1 === this._indexOfSelectedItemKey(keyHash)) {\n      if (!isObject(keyHash) && this.options.keyHashIndices) {\n        this.options.keyHashIndices[keyHash] = [this.options.selectedItemKeys.length];\n      }\n\n      this.options.selectedItemKeys.push(key);\n      this.options.addedItemKeys.push(key);\n      this.options.addedItems.push(itemData);\n      this.options.selectedItems.push(itemData);\n    }\n  },\n  _getSelectedIndexByKey: function (key, ignoreIndicesMap) {\n    var selectedItemKeys = this.options.selectedItemKeys;\n\n    for (var index = 0; index < selectedItemKeys.length; index++) {\n      if ((!ignoreIndicesMap || !ignoreIndicesMap[index]) && this.equalKeys(selectedItemKeys[index], key)) {\n        return index;\n      }\n    }\n\n    return -1;\n  },\n  _getSelectedIndexByHash: function (key, ignoreIndicesMap) {\n    var indices = this.options.keyHashIndices[key];\n\n    if (indices && indices.length > 1 && ignoreIndicesMap) {\n      indices = indices.filter(function (index) {\n        return !ignoreIndicesMap[index];\n      });\n    }\n\n    return indices && indices[0] >= 0 ? indices[0] : -1;\n  },\n  _indexOfSelectedItemKey: function (key, ignoreIndicesMap) {\n    var selectedIndex;\n\n    if (this.options.equalByReference) {\n      selectedIndex = this.options.selectedItemKeys.indexOf(key);\n    } else if (isObject(key)) {\n      selectedIndex = this._getSelectedIndexByKey(key, ignoreIndicesMap);\n    } else {\n      selectedIndex = this._getSelectedIndexByHash(key, ignoreIndicesMap);\n    }\n\n    return selectedIndex;\n  },\n  _shiftSelectedKeyIndices: function (keyIndex) {\n    for (var currentKeyIndex = keyIndex; currentKeyIndex < this.options.selectedItemKeys.length; currentKeyIndex++) {\n      var currentKey = this.options.selectedItemKeys[currentKeyIndex];\n      var currentKeyHash = getKeyHash(currentKey);\n      var currentKeyIndices = this.options.keyHashIndices[currentKeyHash];\n\n      if (!currentKeyIndices) {\n        continue;\n      }\n\n      for (var i = 0; i < currentKeyIndices.length; i++) {\n        if (currentKeyIndices[i] > keyIndex) {\n          currentKeyIndices[i]--;\n        }\n      }\n    }\n  },\n  removeSelectedItem: function (key, keyIndicesToRemoveMap, isDisabled) {\n    if (!this.options.ignoreDisabledItems && isDisabled) {\n      return;\n    }\n\n    var keyHash = this._getKeyHash(key);\n\n    var isBatchDeselect = !!keyIndicesToRemoveMap;\n\n    var keyIndex = this._indexOfSelectedItemKey(keyHash, keyIndicesToRemoveMap);\n\n    if (keyIndex < 0) {\n      return keyIndex;\n    }\n\n    this.options.removedItemKeys.push(key);\n    this.options.removedItems.push(this.options.selectedItems[keyIndex]);\n\n    if (isBatchDeselect) {\n      return keyIndex;\n    }\n\n    this.options.selectedItemKeys.splice(keyIndex, 1);\n    this.options.selectedItems.splice(keyIndex, 1);\n\n    if (isObject(keyHash) || !this.options.keyHashIndices) {\n      return keyIndex;\n    }\n\n    var keyIndices = this.options.keyHashIndices[keyHash];\n\n    if (!keyIndices) {\n      return keyIndex;\n    }\n\n    keyIndices.shift();\n\n    if (!keyIndices.length) {\n      delete this.options.keyHashIndices[keyHash];\n    }\n\n    this._shiftSelectedKeyIndices(keyIndex);\n\n    return keyIndex;\n  },\n  _updateAddedItemKeys: function (keys, items) {\n    for (var i = 0; i < keys.length; i++) {\n      if (!this.isItemKeySelected(keys[i])) {\n        this.options.addedItemKeys.push(keys[i]);\n        this.options.addedItems.push(items[i]);\n      }\n    }\n  },\n  _updateRemovedItemKeys: function (keys, oldSelectedKeys, oldSelectedItems) {\n    for (var i = 0; i < oldSelectedKeys.length; i++) {\n      if (!this.isItemKeySelected(oldSelectedKeys[i])) {\n        this.options.removedItemKeys.push(oldSelectedKeys[i]);\n        this.options.removedItems.push(oldSelectedItems[i]);\n      }\n    }\n  },\n  _isItemSelectionInProgress: function (key, checkPending) {\n    var shouldCheckPending = checkPending && this._lastRequestData && this._requestInProgress();\n\n    if (shouldCheckPending) {\n      var _this$_lastRequestDat3;\n\n      var addedItems = null !== (_this$_lastRequestDat3 = this._lastRequestData.addedItems) && void 0 !== _this$_lastRequestDat3 ? _this$_lastRequestDat3 : [];\n      return addedItems.includes(key);\n    } else {\n      return false;\n    }\n  },\n  _getKeyHash: function (key) {\n    return this.options.equalByReference ? key : getKeyHash(key);\n  },\n  setSelectedItems: function (keys, items) {\n    this._updateAddedItemKeys(keys, items);\n\n    var oldSelectedKeys = this.options.selectedItemKeys;\n    var oldSelectedItems = this.options.selectedItems;\n\n    if (!this.options.equalByReference) {\n      this._initSelectedItemKeyHash();\n\n      this.updateSelectedItemKeyHash(keys);\n    }\n\n    this._setOption(\"selectedItemKeys\", keys);\n\n    this._setOption(\"selectedItems\", items);\n\n    this._updateRemovedItemKeys(keys, oldSelectedKeys, oldSelectedItems);\n  },\n  isItemDataSelected: function (itemData) {\n    var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n    var key = this.options.keyOf(itemData);\n    return this.isItemKeySelected(key, options);\n  },\n  isItemKeySelected: function (key) {\n    var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n\n    var result = this._isItemSelectionInProgress(key, options.checkPending);\n\n    if (!result) {\n      var keyHash = this._getKeyHash(key);\n\n      var index = this._indexOfSelectedItemKey(keyHash);\n\n      result = -1 !== index;\n    }\n\n    return result;\n  },\n  getSelectAllState: function (visibleOnly) {\n    if (visibleOnly) {\n      return this._getVisibleSelectAllState();\n    } else {\n      return this._getFullSelectAllState();\n    }\n  }\n});","map":{"version":3,"names":["getKeyHash","isDefined","isObject","removeDuplicates","getUniqueValues","isKeysEqual","dataQuery","Deferred","when","SelectionFilterCreator","errors","SelectionStrategy","inherit","ctor","options","callBase","_initSelectedItemKeyHash","_setOption","equalByReference","getSelectedItemKeys","selectedItemKeys","slice","getSelectedItems","selectedItems","_preserveSelectionUpdate","items","isDeselect","keyOf","keyIndicesToRemoveMap","keyIndex","i","isBatchDeselect","length","item","key","removeSelectedItem","disabled","addSelectedItem","_batchRemoveSelectedItems","push","updateSelectedItemKeyHash","_loadSelectedItemsCore","keys","isSelectAll","filter","deferred","resolve","selectionFilterCreator","combinedFilter","getCombinedFilter","deselectedItems","toArray","filteredItems","plainItems","isSelectableItem","map","getItemData","localFilter","getLocalFilter","equalKeys","bind","_loadFilteredData","_replaceSelectionUpdate","internalKeys","setSelectedItems","_warnOnIncorrectKeys","allowNullValue","isItemKeySelected","log","_isMultiSelectEnabled","mode","_requestInProgress","_this$_lastLoadDeferr","_lastLoadDeferred","state","_concatRequestsItems","oldRequestItems","updatedKeys","addedItems","added","concat","removedItems","removed","_collectLastRequestData","isDeselectAll","multiSelectEnabled","lastRequestData","_lastRequestData","_shouldMergeWithLastRequest","reject","_updateKeysByLastRequestData","currentKeys","_this$_lastRequestDat","_this$_lastRequestDat2","_loadSelectedItems","that","always","done","fail","preserve","onSelectionChanged","itemData","ignoreDisabledItems","disabledItemKeys","indexOf","keyHash","_getKeyHash","_indexOfSelectedItemKey","keyHashIndices","addedItemKeys","_getSelectedIndexByKey","ignoreIndicesMap","index","_getSelectedIndexByHash","indices","selectedIndex","_shiftSelectedKeyIndices","currentKeyIndex","currentKey","currentKeyHash","currentKeyIndices","isDisabled","removedItemKeys","splice","keyIndices","shift","_updateAddedItemKeys","_updateRemovedItemKeys","oldSelectedKeys","oldSelectedItems","_isItemSelectionInProgress","checkPending","shouldCheckPending","_this$_lastRequestDat3","includes","isItemDataSelected","arguments","result","getSelectAllState","visibleOnly","_getVisibleSelectAllState","_getFullSelectAllState"],"sources":["E:/MisaProject/W2022_06/MISA.EMIS.FE/node_modules/devextreme/esm/ui/selection/selection.strategy.standard.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/selection/selection.strategy.standard.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getKeyHash\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    isDefined,\r\n    isObject\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    removeDuplicates,\r\n    getUniqueValues\r\n} from \"../../core/utils/array\";\r\nimport {\r\n    isKeysEqual\r\n} from \"../../core/utils/array_compare\";\r\nimport dataQuery from \"../../data/query\";\r\nimport {\r\n    Deferred,\r\n    when\r\n} from \"../../core/utils/deferred\";\r\nimport {\r\n    SelectionFilterCreator\r\n} from \"../../core/utils/selection_filter\";\r\nimport errors from \"../widget/ui.errors\";\r\nimport SelectionStrategy from \"./selection.strategy\";\r\nexport default SelectionStrategy.inherit({\r\n    ctor: function(options) {\r\n        this.callBase(options);\r\n        this._initSelectedItemKeyHash()\r\n    },\r\n    _initSelectedItemKeyHash: function() {\r\n        this._setOption(\"keyHashIndices\", this.options.equalByReference ? null : {})\r\n    },\r\n    getSelectedItemKeys: function() {\r\n        return this.options.selectedItemKeys.slice(0)\r\n    },\r\n    getSelectedItems: function() {\r\n        return this.options.selectedItems.slice(0)\r\n    },\r\n    _preserveSelectionUpdate: function(items, isDeselect) {\r\n        var keyOf = this.options.keyOf;\r\n        var keyIndicesToRemoveMap;\r\n        var keyIndex;\r\n        var i;\r\n        if (!keyOf) {\r\n            return\r\n        }\r\n        var isBatchDeselect = isDeselect && items.length > 1 && !this.options.equalByReference;\r\n        if (isBatchDeselect) {\r\n            keyIndicesToRemoveMap = {}\r\n        }\r\n        for (i = 0; i < items.length; i++) {\r\n            var item = items[i];\r\n            var key = keyOf(item);\r\n            if (isDeselect) {\r\n                keyIndex = this.removeSelectedItem(key, keyIndicesToRemoveMap, null === item || void 0 === item ? void 0 : item.disabled);\r\n                if (keyIndicesToRemoveMap && keyIndex >= 0) {\r\n                    keyIndicesToRemoveMap[keyIndex] = true\r\n                }\r\n            } else {\r\n                this.addSelectedItem(key, item)\r\n            }\r\n        }\r\n        if (isBatchDeselect) {\r\n            this._batchRemoveSelectedItems(keyIndicesToRemoveMap)\r\n        }\r\n    },\r\n    _batchRemoveSelectedItems: function(keyIndicesToRemoveMap) {\r\n        var selectedItemKeys = this.options.selectedItemKeys.slice(0);\r\n        var selectedItems = this.options.selectedItems.slice(0);\r\n        this.options.selectedItemKeys.length = 0;\r\n        this.options.selectedItems.length = 0;\r\n        for (var i = 0; i < selectedItemKeys.length; i++) {\r\n            if (!keyIndicesToRemoveMap[i]) {\r\n                this.options.selectedItemKeys.push(selectedItemKeys[i]);\r\n                this.options.selectedItems.push(selectedItems[i])\r\n            }\r\n        }\r\n        this._initSelectedItemKeyHash();\r\n        this.updateSelectedItemKeyHash(this.options.selectedItemKeys)\r\n    },\r\n    _loadSelectedItemsCore: function(keys, isDeselect, isSelectAll, filter) {\r\n        var deferred = new Deferred;\r\n        var key = this.options.key();\r\n        if (!keys.length && !isSelectAll) {\r\n            deferred.resolve([]);\r\n            return deferred\r\n        }\r\n        if (isSelectAll && isDeselect && !filter) {\r\n            deferred.resolve(this.getSelectedItems());\r\n            return deferred\r\n        }\r\n        var selectionFilterCreator = new SelectionFilterCreator(keys, isSelectAll);\r\n        var combinedFilter = selectionFilterCreator.getCombinedFilter(key, filter);\r\n        var deselectedItems = [];\r\n        if (isDeselect) {\r\n            var selectedItems = this.options.selectedItems;\r\n            deselectedItems = combinedFilter && keys.length !== selectedItems.length ? dataQuery(selectedItems).filter(combinedFilter).toArray() : selectedItems.slice(0)\r\n        }\r\n        var filteredItems = deselectedItems.length ? deselectedItems : this.options.plainItems(true).filter(this.options.isSelectableItem).map(this.options.getItemData);\r\n        var localFilter = selectionFilterCreator.getLocalFilter(this.options.keyOf, this.equalKeys.bind(this), this.options.equalByReference, key);\r\n        filteredItems = filteredItems.filter(localFilter);\r\n        if (deselectedItems.length || !isSelectAll && filteredItems.length === keys.length) {\r\n            deferred.resolve(filteredItems)\r\n        } else {\r\n            deferred = this._loadFilteredData(combinedFilter, localFilter, null, isSelectAll)\r\n        }\r\n        return deferred\r\n    },\r\n    _replaceSelectionUpdate: function(items) {\r\n        var internalKeys = [];\r\n        var keyOf = this.options.keyOf;\r\n        if (!keyOf) {\r\n            return\r\n        }\r\n        for (var i = 0; i < items.length; i++) {\r\n            var item = items[i];\r\n            var key = keyOf(item);\r\n            internalKeys.push(key)\r\n        }\r\n        this.setSelectedItems(internalKeys, items)\r\n    },\r\n    _warnOnIncorrectKeys: function(keys) {\r\n        var allowNullValue = this.options.allowNullValue;\r\n        for (var i = 0; i < keys.length; i++) {\r\n            var key = keys[i];\r\n            if ((!allowNullValue || null !== key) && !this.isItemKeySelected(key)) {\r\n                errors.log(\"W1002\", key)\r\n            }\r\n        }\r\n    },\r\n    _isMultiSelectEnabled: function() {\r\n        var mode = this.options.mode;\r\n        return \"all\" === mode || \"multiple\" === mode\r\n    },\r\n    _requestInProgress: function() {\r\n        var _this$_lastLoadDeferr;\r\n        return \"pending\" === (null === (_this$_lastLoadDeferr = this._lastLoadDeferred) || void 0 === _this$_lastLoadDeferr ? void 0 : _this$_lastLoadDeferr.state())\r\n    },\r\n    _concatRequestsItems: function(keys, isDeselect, oldRequestItems, updatedKeys) {\r\n        var selectedItems;\r\n        var deselectedItems = isDeselect ? keys : [];\r\n        if (updatedKeys) {\r\n            selectedItems = updatedKeys\r\n        } else {\r\n            selectedItems = removeDuplicates(keys, this.options.selectedItemKeys)\r\n        }\r\n        return {\r\n            addedItems: oldRequestItems.added.concat(selectedItems),\r\n            removedItems: oldRequestItems.removed.concat(deselectedItems),\r\n            keys: keys\r\n        }\r\n    },\r\n    _collectLastRequestData: function(keys, isDeselect, isSelectAll, updatedKeys) {\r\n        var isDeselectAll = isDeselect && isSelectAll;\r\n        var oldRequestItems = {\r\n            added: [],\r\n            removed: []\r\n        };\r\n        var multiSelectEnabled = this._isMultiSelectEnabled();\r\n        var lastRequestData = multiSelectEnabled ? this._lastRequestData : {};\r\n        if (multiSelectEnabled) {\r\n            if (this._shouldMergeWithLastRequest) {\r\n                if (isDeselectAll) {\r\n                    this._lastLoadDeferred.reject();\r\n                    lastRequestData = {}\r\n                } else if (!isKeysEqual(keys, this.options.selectedItemKeys)) {\r\n                    oldRequestItems.added = lastRequestData.addedItems;\r\n                    oldRequestItems.removed = lastRequestData.removedItems;\r\n                    if (!isDeselect) {\r\n                        this._lastLoadDeferred.reject()\r\n                    }\r\n                }\r\n            }\r\n            lastRequestData = this._concatRequestsItems(keys, isDeselect, oldRequestItems, this._shouldMergeWithLastRequest ? void 0 : updatedKeys)\r\n        }\r\n        return lastRequestData\r\n    },\r\n    _updateKeysByLastRequestData: function(keys, isDeselect, isSelectAll) {\r\n        var currentKeys = keys;\r\n        if (this._isMultiSelectEnabled() && this._shouldMergeWithLastRequest && !isDeselect && !isSelectAll) {\r\n            var _this$_lastRequestDat, _this$_lastRequestDat2;\r\n            currentKeys = removeDuplicates(keys.concat(null === (_this$_lastRequestDat = this._lastRequestData) || void 0 === _this$_lastRequestDat ? void 0 : _this$_lastRequestDat.addedItems), null === (_this$_lastRequestDat2 = this._lastRequestData) || void 0 === _this$_lastRequestDat2 ? void 0 : _this$_lastRequestDat2.removedItems);\r\n            currentKeys = getUniqueValues(currentKeys)\r\n        }\r\n        return currentKeys\r\n    },\r\n    _loadSelectedItems: function(keys, isDeselect, isSelectAll, updatedKeys) {\r\n        var that = this;\r\n        var deferred = new Deferred;\r\n        var filter = that.options.filter();\r\n        this._shouldMergeWithLastRequest = this._requestInProgress();\r\n        this._lastRequestData = this._collectLastRequestData(keys, isDeselect, isSelectAll, updatedKeys);\r\n        when(that._lastLoadDeferred).always((function() {\r\n            var currentKeys = that._updateKeysByLastRequestData(keys, isDeselect, isSelectAll);\r\n            that._shouldMergeWithLastRequest = false;\r\n            that._loadSelectedItemsCore(currentKeys, isDeselect, isSelectAll, filter).done(deferred.resolve).fail(deferred.reject)\r\n        }));\r\n        that._lastLoadDeferred = deferred;\r\n        return deferred\r\n    },\r\n    selectedItemKeys: function(keys, preserve, isDeselect, isSelectAll, updatedKeys) {\r\n        var that = this;\r\n        var deferred = that._loadSelectedItems(keys, isDeselect, isSelectAll, updatedKeys);\r\n        deferred.done((function(items) {\r\n            if (preserve) {\r\n                that._preserveSelectionUpdate(items, isDeselect)\r\n            } else {\r\n                that._replaceSelectionUpdate(items)\r\n            }\r\n            that.onSelectionChanged()\r\n        }));\r\n        return deferred\r\n    },\r\n    addSelectedItem: function(key, itemData) {\r\n        if (isDefined(itemData) && !this.options.ignoreDisabledItems && itemData.disabled) {\r\n            if (-1 === this.options.disabledItemKeys.indexOf(key)) {\r\n                this.options.disabledItemKeys.push(key)\r\n            }\r\n            return\r\n        }\r\n        var keyHash = this._getKeyHash(key);\r\n        if (-1 === this._indexOfSelectedItemKey(keyHash)) {\r\n            if (!isObject(keyHash) && this.options.keyHashIndices) {\r\n                this.options.keyHashIndices[keyHash] = [this.options.selectedItemKeys.length]\r\n            }\r\n            this.options.selectedItemKeys.push(key);\r\n            this.options.addedItemKeys.push(key);\r\n            this.options.addedItems.push(itemData);\r\n            this.options.selectedItems.push(itemData)\r\n        }\r\n    },\r\n    _getSelectedIndexByKey: function(key, ignoreIndicesMap) {\r\n        var selectedItemKeys = this.options.selectedItemKeys;\r\n        for (var index = 0; index < selectedItemKeys.length; index++) {\r\n            if ((!ignoreIndicesMap || !ignoreIndicesMap[index]) && this.equalKeys(selectedItemKeys[index], key)) {\r\n                return index\r\n            }\r\n        }\r\n        return -1\r\n    },\r\n    _getSelectedIndexByHash: function(key, ignoreIndicesMap) {\r\n        var indices = this.options.keyHashIndices[key];\r\n        if (indices && indices.length > 1 && ignoreIndicesMap) {\r\n            indices = indices.filter((function(index) {\r\n                return !ignoreIndicesMap[index]\r\n            }))\r\n        }\r\n        return indices && indices[0] >= 0 ? indices[0] : -1\r\n    },\r\n    _indexOfSelectedItemKey: function(key, ignoreIndicesMap) {\r\n        var selectedIndex;\r\n        if (this.options.equalByReference) {\r\n            selectedIndex = this.options.selectedItemKeys.indexOf(key)\r\n        } else if (isObject(key)) {\r\n            selectedIndex = this._getSelectedIndexByKey(key, ignoreIndicesMap)\r\n        } else {\r\n            selectedIndex = this._getSelectedIndexByHash(key, ignoreIndicesMap)\r\n        }\r\n        return selectedIndex\r\n    },\r\n    _shiftSelectedKeyIndices: function(keyIndex) {\r\n        for (var currentKeyIndex = keyIndex; currentKeyIndex < this.options.selectedItemKeys.length; currentKeyIndex++) {\r\n            var currentKey = this.options.selectedItemKeys[currentKeyIndex];\r\n            var currentKeyHash = getKeyHash(currentKey);\r\n            var currentKeyIndices = this.options.keyHashIndices[currentKeyHash];\r\n            if (!currentKeyIndices) {\r\n                continue\r\n            }\r\n            for (var i = 0; i < currentKeyIndices.length; i++) {\r\n                if (currentKeyIndices[i] > keyIndex) {\r\n                    currentKeyIndices[i]--\r\n                }\r\n            }\r\n        }\r\n    },\r\n    removeSelectedItem: function(key, keyIndicesToRemoveMap, isDisabled) {\r\n        if (!this.options.ignoreDisabledItems && isDisabled) {\r\n            return\r\n        }\r\n        var keyHash = this._getKeyHash(key);\r\n        var isBatchDeselect = !!keyIndicesToRemoveMap;\r\n        var keyIndex = this._indexOfSelectedItemKey(keyHash, keyIndicesToRemoveMap);\r\n        if (keyIndex < 0) {\r\n            return keyIndex\r\n        }\r\n        this.options.removedItemKeys.push(key);\r\n        this.options.removedItems.push(this.options.selectedItems[keyIndex]);\r\n        if (isBatchDeselect) {\r\n            return keyIndex\r\n        }\r\n        this.options.selectedItemKeys.splice(keyIndex, 1);\r\n        this.options.selectedItems.splice(keyIndex, 1);\r\n        if (isObject(keyHash) || !this.options.keyHashIndices) {\r\n            return keyIndex\r\n        }\r\n        var keyIndices = this.options.keyHashIndices[keyHash];\r\n        if (!keyIndices) {\r\n            return keyIndex\r\n        }\r\n        keyIndices.shift();\r\n        if (!keyIndices.length) {\r\n            delete this.options.keyHashIndices[keyHash]\r\n        }\r\n        this._shiftSelectedKeyIndices(keyIndex);\r\n        return keyIndex\r\n    },\r\n    _updateAddedItemKeys: function(keys, items) {\r\n        for (var i = 0; i < keys.length; i++) {\r\n            if (!this.isItemKeySelected(keys[i])) {\r\n                this.options.addedItemKeys.push(keys[i]);\r\n                this.options.addedItems.push(items[i])\r\n            }\r\n        }\r\n    },\r\n    _updateRemovedItemKeys: function(keys, oldSelectedKeys, oldSelectedItems) {\r\n        for (var i = 0; i < oldSelectedKeys.length; i++) {\r\n            if (!this.isItemKeySelected(oldSelectedKeys[i])) {\r\n                this.options.removedItemKeys.push(oldSelectedKeys[i]);\r\n                this.options.removedItems.push(oldSelectedItems[i])\r\n            }\r\n        }\r\n    },\r\n    _isItemSelectionInProgress: function(key, checkPending) {\r\n        var shouldCheckPending = checkPending && this._lastRequestData && this._requestInProgress();\r\n        if (shouldCheckPending) {\r\n            var _this$_lastRequestDat3;\r\n            var addedItems = null !== (_this$_lastRequestDat3 = this._lastRequestData.addedItems) && void 0 !== _this$_lastRequestDat3 ? _this$_lastRequestDat3 : [];\r\n            return addedItems.includes(key)\r\n        } else {\r\n            return false\r\n        }\r\n    },\r\n    _getKeyHash: function(key) {\r\n        return this.options.equalByReference ? key : getKeyHash(key)\r\n    },\r\n    setSelectedItems: function(keys, items) {\r\n        this._updateAddedItemKeys(keys, items);\r\n        var oldSelectedKeys = this.options.selectedItemKeys;\r\n        var oldSelectedItems = this.options.selectedItems;\r\n        if (!this.options.equalByReference) {\r\n            this._initSelectedItemKeyHash();\r\n            this.updateSelectedItemKeyHash(keys)\r\n        }\r\n        this._setOption(\"selectedItemKeys\", keys);\r\n        this._setOption(\"selectedItems\", items);\r\n        this._updateRemovedItemKeys(keys, oldSelectedKeys, oldSelectedItems)\r\n    },\r\n    isItemDataSelected: function(itemData) {\r\n        var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\r\n        var key = this.options.keyOf(itemData);\r\n        return this.isItemKeySelected(key, options)\r\n    },\r\n    isItemKeySelected: function(key) {\r\n        var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\r\n        var result = this._isItemSelectionInProgress(key, options.checkPending);\r\n        if (!result) {\r\n            var keyHash = this._getKeyHash(key);\r\n            var index = this._indexOfSelectedItemKey(keyHash);\r\n            result = -1 !== index\r\n        }\r\n        return result\r\n    },\r\n    getSelectAllState: function(visibleOnly) {\r\n        if (visibleOnly) {\r\n            return this._getVisibleSelectAllState()\r\n        } else {\r\n            return this._getFullSelectAllState()\r\n        }\r\n    }\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}