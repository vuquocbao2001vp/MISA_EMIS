{"ast":null,"code":"/**\r\n * DevExtreme (esm/core/utils/selection_filter.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getKeyHash, equalByValue } from \"./common\";\nimport { isString, isObject } from \"./type\";\nexport var SelectionFilterCreator = function (selectedItemKeys, isSelectAll) {\n  this.getLocalFilter = function (keyGetter, equalKeys, equalByReference, keyExpr) {\n    equalKeys = void 0 === equalKeys ? equalByValue : equalKeys;\n    return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr);\n  };\n\n  this.getExpr = function (keyExpr) {\n    if (!keyExpr) {\n      return;\n    }\n\n    var filterExpr;\n    selectedItemKeys.forEach(function (key, index) {\n      filterExpr = filterExpr || [];\n      var filterExprPart;\n\n      if (index > 0) {\n        filterExpr.push(isSelectAll ? \"and\" : \"or\");\n      }\n\n      if (isString(keyExpr)) {\n        filterExprPart = getFilterForPlainKey(keyExpr, key);\n      } else {\n        filterExprPart = function (keyExpr, itemKeyValue) {\n          var filterExpr = [];\n\n          for (var i = 0, length = keyExpr.length; i < length; i++) {\n            var currentKeyExpr = keyExpr[i];\n            var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\n            var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\n\n            if (!filterExprPart) {\n              break;\n            }\n\n            if (i > 0) {\n              filterExpr.push(isSelectAll ? \"or\" : \"and\");\n            }\n\n            filterExpr.push(filterExprPart);\n          }\n\n          return filterExpr;\n        }(keyExpr, key);\n      }\n\n      filterExpr.push(filterExprPart);\n    });\n\n    if (filterExpr && 1 === filterExpr.length) {\n      filterExpr = filterExpr[0];\n    }\n\n    return filterExpr;\n  };\n\n  this.getCombinedFilter = function (keyExpr, dataSourceFilter) {\n    var filterExpr = this.getExpr(keyExpr);\n    var combinedFilter = filterExpr;\n\n    if (isSelectAll && dataSourceFilter) {\n      if (filterExpr) {\n        combinedFilter = [];\n        combinedFilter.push(filterExpr);\n        combinedFilter.push(dataSourceFilter);\n      } else {\n        combinedFilter = dataSourceFilter;\n      }\n    }\n\n    return combinedFilter;\n  };\n\n  var selectedItemKeyHashesMap;\n\n  var normalizeKeys = function (keys, keyOf, keyExpr) {\n    return Array.isArray(keyExpr) ? keys.map(key => keyOf(key)) : keys;\n  };\n\n  function functionFilter(equalKeys, keyOf, equalByReference, keyExpr, item) {\n    var key = keyOf(item);\n    var keyHash;\n    var i;\n\n    if (!equalByReference) {\n      keyHash = getKeyHash(key);\n\n      if (!isObject(keyHash)) {\n        var selectedKeyHashesMap = function (keyOf, keyExpr) {\n          if (!selectedItemKeyHashesMap) {\n            selectedItemKeyHashesMap = {};\n            var normalizedKeys = normalizeKeys(selectedItemKeys, keyOf, keyExpr);\n\n            for (var i = 0; i < normalizedKeys.length; i++) {\n              selectedItemKeyHashesMap[getKeyHash(normalizedKeys[i])] = true;\n            }\n          }\n\n          return selectedItemKeyHashesMap;\n        }(keyOf, keyExpr);\n\n        if (selectedKeyHashesMap[keyHash]) {\n          return !isSelectAll;\n        }\n\n        return !!isSelectAll;\n      }\n    }\n\n    for (i = 0; i < selectedItemKeys.length; i++) {\n      if (equalKeys(selectedItemKeys[i], key)) {\n        return !isSelectAll;\n      }\n    }\n\n    return !!isSelectAll;\n  }\n\n  function getFilterForPlainKey(keyExpr, keyValue) {\n    if (void 0 === keyValue) {\n      return;\n    }\n\n    return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue];\n  }\n};","map":{"version":3,"names":["getKeyHash","equalByValue","isString","isObject","SelectionFilterCreator","selectedItemKeys","isSelectAll","getLocalFilter","keyGetter","equalKeys","equalByReference","keyExpr","functionFilter","bind","getExpr","filterExpr","forEach","key","index","filterExprPart","push","getFilterForPlainKey","itemKeyValue","i","length","currentKeyExpr","currentKeyValue","getCombinedFilter","dataSourceFilter","combinedFilter","selectedItemKeyHashesMap","normalizeKeys","keys","keyOf","Array","isArray","map","item","keyHash","selectedKeyHashesMap","normalizedKeys","keyValue"],"sources":["E:/MisaProject/MISA_EMIS/MISA.EMIS.FE/node_modules/devextreme/esm/core/utils/selection_filter.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/core/utils/selection_filter.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getKeyHash,\r\n    equalByValue\r\n} from \"./common\";\r\nimport {\r\n    isString,\r\n    isObject\r\n} from \"./type\";\r\nexport var SelectionFilterCreator = function(selectedItemKeys, isSelectAll) {\r\n    this.getLocalFilter = function(keyGetter, equalKeys, equalByReference, keyExpr) {\r\n        equalKeys = void 0 === equalKeys ? equalByValue : equalKeys;\r\n        return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr)\r\n    };\r\n    this.getExpr = function(keyExpr) {\r\n        if (!keyExpr) {\r\n            return\r\n        }\r\n        var filterExpr;\r\n        selectedItemKeys.forEach((function(key, index) {\r\n            filterExpr = filterExpr || [];\r\n            var filterExprPart;\r\n            if (index > 0) {\r\n                filterExpr.push(isSelectAll ? \"and\" : \"or\")\r\n            }\r\n            if (isString(keyExpr)) {\r\n                filterExprPart = getFilterForPlainKey(keyExpr, key)\r\n            } else {\r\n                filterExprPart = function(keyExpr, itemKeyValue) {\r\n                    var filterExpr = [];\r\n                    for (var i = 0, length = keyExpr.length; i < length; i++) {\r\n                        var currentKeyExpr = keyExpr[i];\r\n                        var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\r\n                        var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\r\n                        if (!filterExprPart) {\r\n                            break\r\n                        }\r\n                        if (i > 0) {\r\n                            filterExpr.push(isSelectAll ? \"or\" : \"and\")\r\n                        }\r\n                        filterExpr.push(filterExprPart)\r\n                    }\r\n                    return filterExpr\r\n                }(keyExpr, key)\r\n            }\r\n            filterExpr.push(filterExprPart)\r\n        }));\r\n        if (filterExpr && 1 === filterExpr.length) {\r\n            filterExpr = filterExpr[0]\r\n        }\r\n        return filterExpr\r\n    };\r\n    this.getCombinedFilter = function(keyExpr, dataSourceFilter) {\r\n        var filterExpr = this.getExpr(keyExpr);\r\n        var combinedFilter = filterExpr;\r\n        if (isSelectAll && dataSourceFilter) {\r\n            if (filterExpr) {\r\n                combinedFilter = [];\r\n                combinedFilter.push(filterExpr);\r\n                combinedFilter.push(dataSourceFilter)\r\n            } else {\r\n                combinedFilter = dataSourceFilter\r\n            }\r\n        }\r\n        return combinedFilter\r\n    };\r\n    var selectedItemKeyHashesMap;\r\n    var normalizeKeys = function(keys, keyOf, keyExpr) {\r\n        return Array.isArray(keyExpr) ? keys.map(key => keyOf(key)) : keys\r\n    };\r\n\r\n    function functionFilter(equalKeys, keyOf, equalByReference, keyExpr, item) {\r\n        var key = keyOf(item);\r\n        var keyHash;\r\n        var i;\r\n        if (!equalByReference) {\r\n            keyHash = getKeyHash(key);\r\n            if (!isObject(keyHash)) {\r\n                var selectedKeyHashesMap = function(keyOf, keyExpr) {\r\n                    if (!selectedItemKeyHashesMap) {\r\n                        selectedItemKeyHashesMap = {};\r\n                        var normalizedKeys = normalizeKeys(selectedItemKeys, keyOf, keyExpr);\r\n                        for (var i = 0; i < normalizedKeys.length; i++) {\r\n                            selectedItemKeyHashesMap[getKeyHash(normalizedKeys[i])] = true\r\n                        }\r\n                    }\r\n                    return selectedItemKeyHashesMap\r\n                }(keyOf, keyExpr);\r\n                if (selectedKeyHashesMap[keyHash]) {\r\n                    return !isSelectAll\r\n                }\r\n                return !!isSelectAll\r\n            }\r\n        }\r\n        for (i = 0; i < selectedItemKeys.length; i++) {\r\n            if (equalKeys(selectedItemKeys[i], key)) {\r\n                return !isSelectAll\r\n            }\r\n        }\r\n        return !!isSelectAll\r\n    }\r\n\r\n    function getFilterForPlainKey(keyExpr, keyValue) {\r\n        if (void 0 === keyValue) {\r\n            return\r\n        }\r\n        return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue]\r\n    }\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}