{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/html_editor/utils/image_uploader_helper.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _excluded = [\"imageSrc\", \"src\"];\nimport $ from \"../../../core/renderer\";\nimport localizationMessage from \"../../../localization/message\";\nimport { map } from \"../../../core/utils/iterator\";\nimport { extend } from \"../../../core/utils/extend\";\nimport { getHeight, getWidth } from \"../../../core/utils/size\";\nimport devices from \"../../../core/devices\";\nimport { isDefined } from \"../../../core/utils/type\";\nvar isMobile = \"phone\" === devices.current().deviceType;\nvar DIALOG_IMAGE_CAPTION = \"dxHtmlEditor-dialogImageCaption\";\nvar DIALOG_UPDATE_IMAGE_CAPTION = \"dxHtmlEditor-dialogUpdateImageCaption\";\nvar DIALOG_IMAGE_FIELD_URL = \"dxHtmlEditor-dialogImageUrlField\";\nvar DIALOG_IMAGE_FIELD_ALT = \"dxHtmlEditor-dialogImageAltField\";\nvar DIALOG_IMAGE_FIELD_WIDTH = \"dxHtmlEditor-dialogImageWidthField\";\nvar DIALOG_IMAGE_FIELD_HEIGHT = \"dxHtmlEditor-dialogImageHeightField\";\nvar DIALOG_IMAGE_ADD_BUTTON = \"dxHtmlEditor-dialogImageAddButton\";\nvar DIALOG_IMAGE_UPDATE_BUTTON = \"dxHtmlEditor-dialogImageUpdateButton\";\nvar DIALOG_IMAGE_SPECIFY_URL = \"dxHtmlEditor-dialogImageSpecifyUrl\";\nvar DIALOG_IMAGE_SELECT_FILE = \"dxHtmlEditor-dialogImageSelectFile\";\nvar DIALOG_IMAGE_KEEP_ASPECT_RATIO = \"dxHtmlEditor-dialogImageKeepAspectRatio\";\nvar DIALOG_IMAGE_ENCODE_TO_BASE64 = \"dxHtmlEditor-dialogImageEncodeToBase64\";\nvar DIALOG_IMAGE_POPUP_CLASS = \"dx-htmleditor-add-image-popup\";\nvar DIALOG_IMAGE_POPUP_WITH_TABS_CLASS = \"dx-htmleditor-add-image-popup-with-tabs\";\nvar DIALOG_IMAGE_FIX_RATIO_CONTAINER = \"dx-fix-ratio-container\";\nvar FORM_DIALOG_CLASS = \"dx-formdialog\";\nvar USER_ACTION = \"user\";\nvar SILENT_ACTION = \"silent\";\nvar FILE_UPLOADER_NAME = \"dx-htmleditor-image\";\nimport ButtonGroup from \"../../button_group\";\nimport FileUploader from \"../../file_uploader\";\nimport TextBox from \"../../text_box\";\nexport class ImageUploader {\n  constructor(module, config) {\n    this.module = module;\n    this.config = null !== config && void 0 !== config ? config : {};\n    this.quill = this.module.quill;\n    this.editorInstance = this.module.editorInstance;\n  }\n\n  render() {\n    var _this$config$tabs;\n\n    this.tabPanelIndex = 0;\n    this.formData = this.getFormData();\n    this.isUpdating = this.isImageUpdating();\n    this.actualTabs = null === (_this$config$tabs = this.config.tabs) || void 0 === _this$config$tabs ? void 0 : _this$config$tabs.slice();\n    this.tabs = this.createTabs(this.formData);\n    var formConfig = this.getFormConfig();\n    this.modifyDialogPopupOptions();\n    this.editorInstance.showFormDialog(formConfig).done((formData, event) => {\n      this.tabs[this.getActiveTabIndex()].strategy.pasteImage(formData, event);\n    }).always(() => {\n      this.resetDialogPopupOptions();\n      this.quill.focus();\n    });\n  }\n\n  getActiveTabIndex() {\n    return this.isUpdating ? 0 : this.tabPanelIndex;\n  }\n\n  getFormData() {\n    return this.getUpdateDialogFormData(this.quill.getFormat());\n  }\n\n  getUpdateDialogFormData(formData) {\n    var {\n      imageSrc: imageSrc,\n      src: src\n    } = formData,\n        props = _objectWithoutPropertiesLoose(formData, _excluded);\n\n    return _extends({\n      src: null !== imageSrc && void 0 !== imageSrc ? imageSrc : src\n    }, props);\n  }\n\n  createTabs(formData) {\n    var result = [];\n\n    if (!this.actualTabs || this.isUpdating) {\n      this.actualTabs = [\"url\"];\n    }\n\n    this.actualTabs = this.normalizeTabs(this.actualTabs);\n    this.actualTabs.forEach(tabName => {\n      var newTab = \"url\" === tabName ? new UrlTab(this.module, {\n        config: this.config,\n        formData: formData,\n        isUpdating: this.isUpdating\n      }) : new FileTab(this.module, {\n        config: this.config\n      });\n      result.push(newTab);\n    });\n    return result;\n  }\n\n  normalizeTabs(tabsConfig) {\n    return tabsConfig.map(item => \"object\" === typeof item ? item.name : item);\n  }\n\n  isImageUpdating() {\n    var _this$module$quill$ge;\n\n    return Object.prototype.hasOwnProperty.call(null !== (_this$module$quill$ge = this.module.quill.getFormat()) && void 0 !== _this$module$quill$ge ? _this$module$quill$ge : {}, \"imageSrc\");\n  }\n\n  modifyDialogPopupOptions() {\n    var wrapperClasses = \"\".concat(DIALOG_IMAGE_POPUP_CLASS, \" \").concat(FORM_DIALOG_CLASS);\n\n    if (this.useTabbedItems()) {\n      wrapperClasses += \" \".concat(DIALOG_IMAGE_POPUP_WITH_TABS_CLASS);\n    }\n\n    this.editorInstance.formDialogOption({\n      title: localizationMessage.format(this.isUpdating ? DIALOG_UPDATE_IMAGE_CAPTION : DIALOG_IMAGE_CAPTION),\n      \"toolbarItems[0].options.text\": localizationMessage.format(this.isUpdating ? DIALOG_IMAGE_UPDATE_BUTTON : DIALOG_IMAGE_ADD_BUTTON),\n      \"toolbarItems[0].options.visible\": !this.shouldHideAddButton(),\n      wrapperAttr: {\n        class: wrapperClasses\n      }\n    });\n  }\n\n  shouldHideAddButton() {\n    return !this.isUpdating && 1 === this.actualTabs.length && \"url\" !== this.actualTabs[0];\n  }\n\n  resetDialogPopupOptions() {\n    this.editorInstance.formDialogOption({\n      \"toolbarItems[0].options.text\": localizationMessage.format(\"OK\"),\n      \"toolbarItems[0].options.visible\": true,\n      wrapperAttr: {\n        class: FORM_DIALOG_CLASS\n      }\n    });\n  }\n\n  useTabbedItems() {\n    return this.actualTabs.length > 1;\n  }\n\n  getFormWidth() {\n    return isMobile ? \"100%\" : 493;\n  }\n\n  getFormConfig() {\n    return {\n      formData: this.formData,\n      width: this.getFormWidth(),\n      labelLocation: \"top\",\n      colCount: this.useTabbedItems() ? 1 : 11,\n      items: this.getItemsConfig()\n    };\n  }\n\n  getItemsConfig() {\n    var config = {};\n\n    if (this.useTabbedItems()) {\n      var tabsConfig = map(this.tabs, tabController => ({\n        title: tabController.getTabName(),\n        colCount: 11,\n        items: tabController.getItemsConfig()\n      }));\n      config = [{\n        itemType: \"tabbed\",\n        tabPanelOptions: {\n          onSelectionChanged: e => {\n            this.tabPanelIndex = e.component.option(\"selectedIndex\");\n          }\n        },\n        tabs: tabsConfig\n      }];\n    } else {\n      config = this.tabs[0].getItemsConfig();\n    }\n\n    return config;\n  }\n\n}\n\nclass BaseTab {\n  constructor(module, _ref) {\n    var {\n      config: config,\n      formData: formData,\n      isUpdating: isUpdating\n    } = _ref;\n    this.module = module;\n    this.config = config;\n    this.formData = formData;\n    this.isUpdating = isUpdating;\n    this.strategy = this.getStrategy();\n  }\n\n  getItemsConfig() {\n    return this.strategy.getItemsConfig();\n  }\n\n}\n\nclass UrlTab extends BaseTab {\n  getTabName() {\n    return localizationMessage.format(DIALOG_IMAGE_SPECIFY_URL);\n  }\n\n  getStrategy() {\n    return this.isUpdating ? new UpdateUrlStrategy(this.module, this.config, this.formData) : new AddUrlStrategy(this.module, this.config);\n  }\n\n}\n\nclass FileTab extends BaseTab {\n  getTabName() {\n    return localizationMessage.format(DIALOG_IMAGE_SELECT_FILE);\n  }\n\n  getStrategy() {\n    return new FileStrategy(this.module, this.config);\n  }\n\n}\n\nclass BaseStrategy {\n  constructor(module, config) {\n    this.module = module;\n    this.config = config;\n    this.editorInstance = module.editorInstance;\n    this.quill = module.quill;\n    this.selection = this.getQuillSelection();\n  }\n\n  getQuillSelection() {\n    var selection = this.quill.getSelection();\n    return null !== selection && void 0 !== selection ? selection : {\n      index: this.quill.getLength(),\n      length: 0\n    };\n  }\n\n  pasteImage() {}\n\n}\n\nclass AddUrlStrategy extends BaseStrategy {\n  constructor(module, config) {\n    super(module, config);\n    this.shouldKeepAspectRatio = true;\n  }\n\n  pasteImage(formData, event) {\n    this.module.saveValueChangeEvent(event);\n    urlUpload(this.quill, this.selection.index, formData);\n  }\n\n  keepAspectRatio(data, _ref2) {\n    var {\n      dependentEditor: dependentEditor,\n      e: e\n    } = _ref2;\n    var newValue = parseInt(e.value);\n    var previousValue = parseInt(e.previousValue);\n    var previousDependentEditorValue = parseInt(dependentEditor.option(\"value\"));\n    data.component.updateData(data.dataField, newValue);\n\n    if (this.shouldKeepAspectRatio && previousDependentEditorValue && previousValue && !this.preventRecalculating) {\n      this.preventRecalculating = true;\n      dependentEditor.option(\"value\", Math.round(newValue * previousDependentEditorValue / parseInt(previousValue)).toString());\n    }\n\n    this.preventRecalculating = false;\n  }\n\n  createKeepAspectRatioEditor($container, data, dependentEditorDataField) {\n    return this.editorInstance._createComponent($container, TextBox, extend(true, data.editorOptions, {\n      value: data.component.option(\"formData\")[data.dataField],\n      onEnterKey: data.component.option(\"onEditorEnterKey\").bind(this.editorInstance._formDialog, data),\n      onValueChanged: e => {\n        this.keepAspectRatio(data, {\n          dependentEditor: this[dependentEditorDataField + \"Editor\"],\n          e: e\n        });\n      }\n    }));\n  }\n\n  getItemsConfig() {\n    return [{\n      dataField: \"src\",\n      colSpan: 11,\n      label: {\n        text: localizationMessage.format(DIALOG_IMAGE_FIELD_URL)\n      }\n    }, {\n      dataField: \"width\",\n      colSpan: 6,\n      label: {\n        text: localizationMessage.format(DIALOG_IMAGE_FIELD_WIDTH)\n      },\n      template: data => {\n        var $content = $(\"<div>\").addClass(DIALOG_IMAGE_FIX_RATIO_CONTAINER);\n        var $widthEditor = $(\"<div>\").appendTo($content);\n        this.widthEditor = this.createKeepAspectRatioEditor($widthEditor, data, \"height\");\n        var $ratioEditor = $(\"<div>\").appendTo($content);\n\n        this.editorInstance._createComponent($ratioEditor, ButtonGroup, {\n          items: [{\n            icon: \"imgarlock\",\n            value: \"keepRatio\"\n          }],\n          hint: localizationMessage.format(DIALOG_IMAGE_KEEP_ASPECT_RATIO),\n          focusStateEnabled: false,\n          keyExpr: \"value\",\n          stylingMode: \"outlined\",\n          selectionMode: \"multiple\",\n          selectedItemKeys: [\"keepRatio\"],\n          onSelectionChanged: e => {\n            this.shouldKeepAspectRatio = !!e.component.option(\"selectedItems\").length;\n          }\n        });\n\n        return $content;\n      }\n    }, {\n      dataField: \"height\",\n      colSpan: 5,\n      label: {\n        text: localizationMessage.format(DIALOG_IMAGE_FIELD_HEIGHT)\n      },\n      template: data => {\n        var $content = $(\"<div>\");\n        this.heightEditor = this.createKeepAspectRatioEditor($content, data, \"width\");\n        return $content;\n      }\n    }, {\n      dataField: \"alt\",\n      colSpan: 11,\n      label: {\n        text: localizationMessage.format(DIALOG_IMAGE_FIELD_ALT)\n      }\n    }];\n  }\n\n}\n\nclass UpdateUrlStrategy extends AddUrlStrategy {\n  constructor(module, config, formData) {\n    super(module, config);\n    this.formData = formData;\n    this.modifyFormData();\n  }\n\n  modifyFormData() {\n    var {\n      imageSrc: imageSrc\n    } = this.quill.getFormat(this.selection.index - 1, 1);\n\n    if (!imageSrc || 0 === this.selection.index) {\n      this.selection = {\n        index: this.selection.index + 1,\n        length: 0\n      };\n      this.quill.setSelection(this.selection.index, this.selection.length, SILENT_ACTION);\n    }\n\n    var imgElement = this.quill.getLeaf(this.selection.index)[0].domNode;\n\n    if (imgElement) {\n      var _this$formData$width, _this$formData$height;\n\n      this.formData.width = null !== (_this$formData$width = this.formData.width) && void 0 !== _this$formData$width ? _this$formData$width : getWidth($(imgElement));\n      this.formData.height = null !== (_this$formData$height = this.formData.height) && void 0 !== _this$formData$height ? _this$formData$height : getHeight($(imgElement));\n    }\n  }\n\n  pasteImage(formData, event) {\n    this.quill.deleteText(this.embedFormatIndex(), 1, SILENT_ACTION);\n    this.selection.index -= 1;\n    super.pasteImage(formData, event);\n  }\n\n  embedFormatIndex() {\n    var _this$selection;\n\n    var selection = null !== (_this$selection = this.selection) && void 0 !== _this$selection ? _this$selection : this.quill.getSelection();\n\n    if (selection) {\n      if (selection.length) {\n        return selection.index;\n      } else {\n        return selection.index - 1;\n      }\n    } else {\n      return this.quill.getLength();\n    }\n  }\n\n}\n\nclass FileStrategy extends BaseStrategy {\n  constructor(module, config) {\n    super(module, config);\n    this.useBase64 = !isDefined(this.config.fileUploadMode) || \"base64\" === this.config.fileUploadMode;\n  }\n\n  closeDialogPopup(data) {\n    this.editorInstance._formDialog.hide({\n      file: data.value ? data.value[0] : data.file\n    }, data.event);\n  }\n\n  serverUpload(data) {\n    if (!this.useBase64) {\n      var imageUrl = correctSlashesInUrl(this.config.uploadDirectory) + data.file.name;\n      urlUpload(this.quill, this.selection.index, {\n        src: imageUrl\n      });\n      this.closeDialogPopup(data);\n    }\n  }\n\n  base64Upload(data) {\n    this.quill.getModule(\"uploader\").upload(this.selection, data.value, true);\n    this.closeDialogPopup(data);\n  }\n\n  pasteImage(formData, event) {\n    if (this.useBase64) {\n      super.pasteImage(formData, event);\n    }\n  }\n\n  isBase64Editable() {\n    return \"both\" === this.config.fileUploadMode;\n  }\n\n  getFileUploaderOptions() {\n    var fileUploaderOptions = {\n      uploadUrl: this.config.uploadUrl,\n      onValueChanged: data => {\n        if (this.useBase64) {\n          this.base64Upload(data);\n        } else if (data.value.length) {\n          data.component.upload();\n        }\n      },\n      onUploaded: data => {\n        this.serverUpload(data);\n      }\n    };\n    return extend({}, getFileUploaderBaseOptions(), fileUploaderOptions, this.config.fileUploaderOptions);\n  }\n\n  getItemsConfig() {\n    return [{\n      itemType: \"simple\",\n      dataField: \"files\",\n      colSpan: 11,\n      label: {\n        visible: false\n      },\n      template: () => {\n        var $content = $(\"<div>\");\n\n        this.module.editorInstance._createComponent($content, FileUploader, this.getFileUploaderOptions());\n\n        return $content;\n      }\n    }, {\n      itemType: \"simple\",\n      colSpan: 11,\n      label: {\n        visible: false\n      },\n      editorType: \"dxCheckBox\",\n      editorOptions: {\n        value: this.useBase64,\n        visible: this.isBase64Editable(),\n        text: localizationMessage.format(DIALOG_IMAGE_ENCODE_TO_BASE64),\n        onValueChanged: e => {\n          if (this.isBase64Editable()) {\n            this.useBase64 = e.value;\n          }\n        }\n      }\n    }];\n  }\n\n}\n\nexport function correctSlashesInUrl(url) {\n  return \"/\" !== url[url.length - 1] ? url + \"/\" : url;\n}\nexport function getFileUploaderBaseOptions() {\n  return {\n    value: [],\n    name: FILE_UPLOADER_NAME,\n    accept: \"image/*\",\n    uploadMode: \"useButtons\"\n  };\n}\nexport function urlUpload(quill, index, attributes) {\n  quill.insertEmbed(index, \"extendedImage\", attributes, USER_ACTION);\n  quill.setSelection(index + 1, 0, USER_ACTION);\n}","map":{"version":3,"names":["_extends","_objectWithoutPropertiesLoose","_excluded","$","localizationMessage","map","extend","getHeight","getWidth","devices","isDefined","isMobile","current","deviceType","DIALOG_IMAGE_CAPTION","DIALOG_UPDATE_IMAGE_CAPTION","DIALOG_IMAGE_FIELD_URL","DIALOG_IMAGE_FIELD_ALT","DIALOG_IMAGE_FIELD_WIDTH","DIALOG_IMAGE_FIELD_HEIGHT","DIALOG_IMAGE_ADD_BUTTON","DIALOG_IMAGE_UPDATE_BUTTON","DIALOG_IMAGE_SPECIFY_URL","DIALOG_IMAGE_SELECT_FILE","DIALOG_IMAGE_KEEP_ASPECT_RATIO","DIALOG_IMAGE_ENCODE_TO_BASE64","DIALOG_IMAGE_POPUP_CLASS","DIALOG_IMAGE_POPUP_WITH_TABS_CLASS","DIALOG_IMAGE_FIX_RATIO_CONTAINER","FORM_DIALOG_CLASS","USER_ACTION","SILENT_ACTION","FILE_UPLOADER_NAME","ButtonGroup","FileUploader","TextBox","ImageUploader","constructor","module","config","quill","editorInstance","render","_this$config$tabs","tabPanelIndex","formData","getFormData","isUpdating","isImageUpdating","actualTabs","tabs","slice","createTabs","formConfig","getFormConfig","modifyDialogPopupOptions","showFormDialog","done","event","getActiveTabIndex","strategy","pasteImage","always","resetDialogPopupOptions","focus","getUpdateDialogFormData","getFormat","imageSrc","src","props","result","normalizeTabs","forEach","tabName","newTab","UrlTab","FileTab","push","tabsConfig","item","name","_this$module$quill$ge","Object","prototype","hasOwnProperty","call","wrapperClasses","concat","useTabbedItems","formDialogOption","title","format","shouldHideAddButton","wrapperAttr","class","length","getFormWidth","width","labelLocation","colCount","items","getItemsConfig","tabController","getTabName","itemType","tabPanelOptions","onSelectionChanged","e","component","option","BaseTab","_ref","getStrategy","UpdateUrlStrategy","AddUrlStrategy","FileStrategy","BaseStrategy","selection","getQuillSelection","getSelection","index","getLength","shouldKeepAspectRatio","saveValueChangeEvent","urlUpload","keepAspectRatio","data","_ref2","dependentEditor","newValue","parseInt","value","previousValue","previousDependentEditorValue","updateData","dataField","preventRecalculating","Math","round","toString","createKeepAspectRatioEditor","$container","dependentEditorDataField","_createComponent","editorOptions","onEnterKey","bind","_formDialog","onValueChanged","colSpan","label","text","template","$content","addClass","$widthEditor","appendTo","widthEditor","$ratioEditor","icon","hint","focusStateEnabled","keyExpr","stylingMode","selectionMode","selectedItemKeys","heightEditor","modifyFormData","setSelection","imgElement","getLeaf","domNode","_this$formData$width","_this$formData$height","height","deleteText","embedFormatIndex","_this$selection","useBase64","fileUploadMode","closeDialogPopup","hide","file","serverUpload","imageUrl","correctSlashesInUrl","uploadDirectory","base64Upload","getModule","upload","isBase64Editable","getFileUploaderOptions","fileUploaderOptions","uploadUrl","onUploaded","getFileUploaderBaseOptions","visible","editorType","url","accept","uploadMode","attributes","insertEmbed"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/ui/html_editor/utils/image_uploader_helper.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/html_editor/utils/image_uploader_helper.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\r\nvar _excluded = [\"imageSrc\", \"src\"];\r\nimport $ from \"../../../core/renderer\";\r\nimport localizationMessage from \"../../../localization/message\";\r\nimport {\r\n    map\r\n} from \"../../../core/utils/iterator\";\r\nimport {\r\n    extend\r\n} from \"../../../core/utils/extend\";\r\nimport {\r\n    getHeight,\r\n    getWidth\r\n} from \"../../../core/utils/size\";\r\nimport devices from \"../../../core/devices\";\r\nimport {\r\n    isDefined\r\n} from \"../../../core/utils/type\";\r\nvar isMobile = \"phone\" === devices.current().deviceType;\r\nvar DIALOG_IMAGE_CAPTION = \"dxHtmlEditor-dialogImageCaption\";\r\nvar DIALOG_UPDATE_IMAGE_CAPTION = \"dxHtmlEditor-dialogUpdateImageCaption\";\r\nvar DIALOG_IMAGE_FIELD_URL = \"dxHtmlEditor-dialogImageUrlField\";\r\nvar DIALOG_IMAGE_FIELD_ALT = \"dxHtmlEditor-dialogImageAltField\";\r\nvar DIALOG_IMAGE_FIELD_WIDTH = \"dxHtmlEditor-dialogImageWidthField\";\r\nvar DIALOG_IMAGE_FIELD_HEIGHT = \"dxHtmlEditor-dialogImageHeightField\";\r\nvar DIALOG_IMAGE_ADD_BUTTON = \"dxHtmlEditor-dialogImageAddButton\";\r\nvar DIALOG_IMAGE_UPDATE_BUTTON = \"dxHtmlEditor-dialogImageUpdateButton\";\r\nvar DIALOG_IMAGE_SPECIFY_URL = \"dxHtmlEditor-dialogImageSpecifyUrl\";\r\nvar DIALOG_IMAGE_SELECT_FILE = \"dxHtmlEditor-dialogImageSelectFile\";\r\nvar DIALOG_IMAGE_KEEP_ASPECT_RATIO = \"dxHtmlEditor-dialogImageKeepAspectRatio\";\r\nvar DIALOG_IMAGE_ENCODE_TO_BASE64 = \"dxHtmlEditor-dialogImageEncodeToBase64\";\r\nvar DIALOG_IMAGE_POPUP_CLASS = \"dx-htmleditor-add-image-popup\";\r\nvar DIALOG_IMAGE_POPUP_WITH_TABS_CLASS = \"dx-htmleditor-add-image-popup-with-tabs\";\r\nvar DIALOG_IMAGE_FIX_RATIO_CONTAINER = \"dx-fix-ratio-container\";\r\nvar FORM_DIALOG_CLASS = \"dx-formdialog\";\r\nvar USER_ACTION = \"user\";\r\nvar SILENT_ACTION = \"silent\";\r\nvar FILE_UPLOADER_NAME = \"dx-htmleditor-image\";\r\nimport ButtonGroup from \"../../button_group\";\r\nimport FileUploader from \"../../file_uploader\";\r\nimport TextBox from \"../../text_box\";\r\nexport class ImageUploader {\r\n    constructor(module, config) {\r\n        this.module = module;\r\n        this.config = null !== config && void 0 !== config ? config : {};\r\n        this.quill = this.module.quill;\r\n        this.editorInstance = this.module.editorInstance\r\n    }\r\n    render() {\r\n        var _this$config$tabs;\r\n        this.tabPanelIndex = 0;\r\n        this.formData = this.getFormData();\r\n        this.isUpdating = this.isImageUpdating();\r\n        this.actualTabs = null === (_this$config$tabs = this.config.tabs) || void 0 === _this$config$tabs ? void 0 : _this$config$tabs.slice();\r\n        this.tabs = this.createTabs(this.formData);\r\n        var formConfig = this.getFormConfig();\r\n        this.modifyDialogPopupOptions();\r\n        this.editorInstance.showFormDialog(formConfig).done((formData, event) => {\r\n            this.tabs[this.getActiveTabIndex()].strategy.pasteImage(formData, event)\r\n        }).always(() => {\r\n            this.resetDialogPopupOptions();\r\n            this.quill.focus()\r\n        })\r\n    }\r\n    getActiveTabIndex() {\r\n        return this.isUpdating ? 0 : this.tabPanelIndex\r\n    }\r\n    getFormData() {\r\n        return this.getUpdateDialogFormData(this.quill.getFormat())\r\n    }\r\n    getUpdateDialogFormData(formData) {\r\n        var {\r\n            imageSrc: imageSrc,\r\n            src: src\r\n        } = formData, props = _objectWithoutPropertiesLoose(formData, _excluded);\r\n        return _extends({\r\n            src: null !== imageSrc && void 0 !== imageSrc ? imageSrc : src\r\n        }, props)\r\n    }\r\n    createTabs(formData) {\r\n        var result = [];\r\n        if (!this.actualTabs || this.isUpdating) {\r\n            this.actualTabs = [\"url\"]\r\n        }\r\n        this.actualTabs = this.normalizeTabs(this.actualTabs);\r\n        this.actualTabs.forEach(tabName => {\r\n            var newTab = \"url\" === tabName ? new UrlTab(this.module, {\r\n                config: this.config,\r\n                formData: formData,\r\n                isUpdating: this.isUpdating\r\n            }) : new FileTab(this.module, {\r\n                config: this.config\r\n            });\r\n            result.push(newTab)\r\n        });\r\n        return result\r\n    }\r\n    normalizeTabs(tabsConfig) {\r\n        return tabsConfig.map(item => \"object\" === typeof item ? item.name : item)\r\n    }\r\n    isImageUpdating() {\r\n        var _this$module$quill$ge;\r\n        return Object.prototype.hasOwnProperty.call(null !== (_this$module$quill$ge = this.module.quill.getFormat()) && void 0 !== _this$module$quill$ge ? _this$module$quill$ge : {}, \"imageSrc\")\r\n    }\r\n    modifyDialogPopupOptions() {\r\n        var wrapperClasses = \"\".concat(DIALOG_IMAGE_POPUP_CLASS, \" \").concat(FORM_DIALOG_CLASS);\r\n        if (this.useTabbedItems()) {\r\n            wrapperClasses += \" \".concat(DIALOG_IMAGE_POPUP_WITH_TABS_CLASS)\r\n        }\r\n        this.editorInstance.formDialogOption({\r\n            title: localizationMessage.format(this.isUpdating ? DIALOG_UPDATE_IMAGE_CAPTION : DIALOG_IMAGE_CAPTION),\r\n            \"toolbarItems[0].options.text\": localizationMessage.format(this.isUpdating ? DIALOG_IMAGE_UPDATE_BUTTON : DIALOG_IMAGE_ADD_BUTTON),\r\n            \"toolbarItems[0].options.visible\": !this.shouldHideAddButton(),\r\n            wrapperAttr: {\r\n                class: wrapperClasses\r\n            }\r\n        })\r\n    }\r\n    shouldHideAddButton() {\r\n        return !this.isUpdating && 1 === this.actualTabs.length && \"url\" !== this.actualTabs[0]\r\n    }\r\n    resetDialogPopupOptions() {\r\n        this.editorInstance.formDialogOption({\r\n            \"toolbarItems[0].options.text\": localizationMessage.format(\"OK\"),\r\n            \"toolbarItems[0].options.visible\": true,\r\n            wrapperAttr: {\r\n                class: FORM_DIALOG_CLASS\r\n            }\r\n        })\r\n    }\r\n    useTabbedItems() {\r\n        return this.actualTabs.length > 1\r\n    }\r\n    getFormWidth() {\r\n        return isMobile ? \"100%\" : 493\r\n    }\r\n    getFormConfig() {\r\n        return {\r\n            formData: this.formData,\r\n            width: this.getFormWidth(),\r\n            labelLocation: \"top\",\r\n            colCount: this.useTabbedItems() ? 1 : 11,\r\n            items: this.getItemsConfig()\r\n        }\r\n    }\r\n    getItemsConfig() {\r\n        var config = {};\r\n        if (this.useTabbedItems()) {\r\n            var tabsConfig = map(this.tabs, tabController => ({\r\n                title: tabController.getTabName(),\r\n                colCount: 11,\r\n                items: tabController.getItemsConfig()\r\n            }));\r\n            config = [{\r\n                itemType: \"tabbed\",\r\n                tabPanelOptions: {\r\n                    onSelectionChanged: e => {\r\n                        this.tabPanelIndex = e.component.option(\"selectedIndex\")\r\n                    }\r\n                },\r\n                tabs: tabsConfig\r\n            }]\r\n        } else {\r\n            config = this.tabs[0].getItemsConfig()\r\n        }\r\n        return config\r\n    }\r\n}\r\nclass BaseTab {\r\n    constructor(module, _ref) {\r\n        var {\r\n            config: config,\r\n            formData: formData,\r\n            isUpdating: isUpdating\r\n        } = _ref;\r\n        this.module = module;\r\n        this.config = config;\r\n        this.formData = formData;\r\n        this.isUpdating = isUpdating;\r\n        this.strategy = this.getStrategy()\r\n    }\r\n    getItemsConfig() {\r\n        return this.strategy.getItemsConfig()\r\n    }\r\n}\r\nclass UrlTab extends BaseTab {\r\n    getTabName() {\r\n        return localizationMessage.format(DIALOG_IMAGE_SPECIFY_URL)\r\n    }\r\n    getStrategy() {\r\n        return this.isUpdating ? new UpdateUrlStrategy(this.module, this.config, this.formData) : new AddUrlStrategy(this.module, this.config)\r\n    }\r\n}\r\nclass FileTab extends BaseTab {\r\n    getTabName() {\r\n        return localizationMessage.format(DIALOG_IMAGE_SELECT_FILE)\r\n    }\r\n    getStrategy() {\r\n        return new FileStrategy(this.module, this.config)\r\n    }\r\n}\r\nclass BaseStrategy {\r\n    constructor(module, config) {\r\n        this.module = module;\r\n        this.config = config;\r\n        this.editorInstance = module.editorInstance;\r\n        this.quill = module.quill;\r\n        this.selection = this.getQuillSelection()\r\n    }\r\n    getQuillSelection() {\r\n        var selection = this.quill.getSelection();\r\n        return null !== selection && void 0 !== selection ? selection : {\r\n            index: this.quill.getLength(),\r\n            length: 0\r\n        }\r\n    }\r\n    pasteImage() {}\r\n}\r\nclass AddUrlStrategy extends BaseStrategy {\r\n    constructor(module, config) {\r\n        super(module, config);\r\n        this.shouldKeepAspectRatio = true\r\n    }\r\n    pasteImage(formData, event) {\r\n        this.module.saveValueChangeEvent(event);\r\n        urlUpload(this.quill, this.selection.index, formData)\r\n    }\r\n    keepAspectRatio(data, _ref2) {\r\n        var {\r\n            dependentEditor: dependentEditor,\r\n            e: e\r\n        } = _ref2;\r\n        var newValue = parseInt(e.value);\r\n        var previousValue = parseInt(e.previousValue);\r\n        var previousDependentEditorValue = parseInt(dependentEditor.option(\"value\"));\r\n        data.component.updateData(data.dataField, newValue);\r\n        if (this.shouldKeepAspectRatio && previousDependentEditorValue && previousValue && !this.preventRecalculating) {\r\n            this.preventRecalculating = true;\r\n            dependentEditor.option(\"value\", Math.round(newValue * previousDependentEditorValue / parseInt(previousValue)).toString())\r\n        }\r\n        this.preventRecalculating = false\r\n    }\r\n    createKeepAspectRatioEditor($container, data, dependentEditorDataField) {\r\n        return this.editorInstance._createComponent($container, TextBox, extend(true, data.editorOptions, {\r\n            value: data.component.option(\"formData\")[data.dataField],\r\n            onEnterKey: data.component.option(\"onEditorEnterKey\").bind(this.editorInstance._formDialog, data),\r\n            onValueChanged: e => {\r\n                this.keepAspectRatio(data, {\r\n                    dependentEditor: this[dependentEditorDataField + \"Editor\"],\r\n                    e: e\r\n                })\r\n            }\r\n        }))\r\n    }\r\n    getItemsConfig() {\r\n        return [{\r\n            dataField: \"src\",\r\n            colSpan: 11,\r\n            label: {\r\n                text: localizationMessage.format(DIALOG_IMAGE_FIELD_URL)\r\n            }\r\n        }, {\r\n            dataField: \"width\",\r\n            colSpan: 6,\r\n            label: {\r\n                text: localizationMessage.format(DIALOG_IMAGE_FIELD_WIDTH)\r\n            },\r\n            template: data => {\r\n                var $content = $(\"<div>\").addClass(DIALOG_IMAGE_FIX_RATIO_CONTAINER);\r\n                var $widthEditor = $(\"<div>\").appendTo($content);\r\n                this.widthEditor = this.createKeepAspectRatioEditor($widthEditor, data, \"height\");\r\n                var $ratioEditor = $(\"<div>\").appendTo($content);\r\n                this.editorInstance._createComponent($ratioEditor, ButtonGroup, {\r\n                    items: [{\r\n                        icon: \"imgarlock\",\r\n                        value: \"keepRatio\"\r\n                    }],\r\n                    hint: localizationMessage.format(DIALOG_IMAGE_KEEP_ASPECT_RATIO),\r\n                    focusStateEnabled: false,\r\n                    keyExpr: \"value\",\r\n                    stylingMode: \"outlined\",\r\n                    selectionMode: \"multiple\",\r\n                    selectedItemKeys: [\"keepRatio\"],\r\n                    onSelectionChanged: e => {\r\n                        this.shouldKeepAspectRatio = !!e.component.option(\"selectedItems\").length\r\n                    }\r\n                });\r\n                return $content\r\n            }\r\n        }, {\r\n            dataField: \"height\",\r\n            colSpan: 5,\r\n            label: {\r\n                text: localizationMessage.format(DIALOG_IMAGE_FIELD_HEIGHT)\r\n            },\r\n            template: data => {\r\n                var $content = $(\"<div>\");\r\n                this.heightEditor = this.createKeepAspectRatioEditor($content, data, \"width\");\r\n                return $content\r\n            }\r\n        }, {\r\n            dataField: \"alt\",\r\n            colSpan: 11,\r\n            label: {\r\n                text: localizationMessage.format(DIALOG_IMAGE_FIELD_ALT)\r\n            }\r\n        }]\r\n    }\r\n}\r\nclass UpdateUrlStrategy extends AddUrlStrategy {\r\n    constructor(module, config, formData) {\r\n        super(module, config);\r\n        this.formData = formData;\r\n        this.modifyFormData()\r\n    }\r\n    modifyFormData() {\r\n        var {\r\n            imageSrc: imageSrc\r\n        } = this.quill.getFormat(this.selection.index - 1, 1);\r\n        if (!imageSrc || 0 === this.selection.index) {\r\n            this.selection = {\r\n                index: this.selection.index + 1,\r\n                length: 0\r\n            };\r\n            this.quill.setSelection(this.selection.index, this.selection.length, SILENT_ACTION)\r\n        }\r\n        var imgElement = this.quill.getLeaf(this.selection.index)[0].domNode;\r\n        if (imgElement) {\r\n            var _this$formData$width, _this$formData$height;\r\n            this.formData.width = null !== (_this$formData$width = this.formData.width) && void 0 !== _this$formData$width ? _this$formData$width : getWidth($(imgElement));\r\n            this.formData.height = null !== (_this$formData$height = this.formData.height) && void 0 !== _this$formData$height ? _this$formData$height : getHeight($(imgElement))\r\n        }\r\n    }\r\n    pasteImage(formData, event) {\r\n        this.quill.deleteText(this.embedFormatIndex(), 1, SILENT_ACTION);\r\n        this.selection.index -= 1;\r\n        super.pasteImage(formData, event)\r\n    }\r\n    embedFormatIndex() {\r\n        var _this$selection;\r\n        var selection = null !== (_this$selection = this.selection) && void 0 !== _this$selection ? _this$selection : this.quill.getSelection();\r\n        if (selection) {\r\n            if (selection.length) {\r\n                return selection.index\r\n            } else {\r\n                return selection.index - 1\r\n            }\r\n        } else {\r\n            return this.quill.getLength()\r\n        }\r\n    }\r\n}\r\nclass FileStrategy extends BaseStrategy {\r\n    constructor(module, config) {\r\n        super(module, config);\r\n        this.useBase64 = !isDefined(this.config.fileUploadMode) || \"base64\" === this.config.fileUploadMode\r\n    }\r\n    closeDialogPopup(data) {\r\n        this.editorInstance._formDialog.hide({\r\n            file: data.value ? data.value[0] : data.file\r\n        }, data.event)\r\n    }\r\n    serverUpload(data) {\r\n        if (!this.useBase64) {\r\n            var imageUrl = correctSlashesInUrl(this.config.uploadDirectory) + data.file.name;\r\n            urlUpload(this.quill, this.selection.index, {\r\n                src: imageUrl\r\n            });\r\n            this.closeDialogPopup(data)\r\n        }\r\n    }\r\n    base64Upload(data) {\r\n        this.quill.getModule(\"uploader\").upload(this.selection, data.value, true);\r\n        this.closeDialogPopup(data)\r\n    }\r\n    pasteImage(formData, event) {\r\n        if (this.useBase64) {\r\n            super.pasteImage(formData, event)\r\n        }\r\n    }\r\n    isBase64Editable() {\r\n        return \"both\" === this.config.fileUploadMode\r\n    }\r\n    getFileUploaderOptions() {\r\n        var fileUploaderOptions = {\r\n            uploadUrl: this.config.uploadUrl,\r\n            onValueChanged: data => {\r\n                if (this.useBase64) {\r\n                    this.base64Upload(data)\r\n                } else if (data.value.length) {\r\n                    data.component.upload()\r\n                }\r\n            },\r\n            onUploaded: data => {\r\n                this.serverUpload(data)\r\n            }\r\n        };\r\n        return extend({}, getFileUploaderBaseOptions(), fileUploaderOptions, this.config.fileUploaderOptions)\r\n    }\r\n    getItemsConfig() {\r\n        return [{\r\n            itemType: \"simple\",\r\n            dataField: \"files\",\r\n            colSpan: 11,\r\n            label: {\r\n                visible: false\r\n            },\r\n            template: () => {\r\n                var $content = $(\"<div>\");\r\n                this.module.editorInstance._createComponent($content, FileUploader, this.getFileUploaderOptions());\r\n                return $content\r\n            }\r\n        }, {\r\n            itemType: \"simple\",\r\n            colSpan: 11,\r\n            label: {\r\n                visible: false\r\n            },\r\n            editorType: \"dxCheckBox\",\r\n            editorOptions: {\r\n                value: this.useBase64,\r\n                visible: this.isBase64Editable(),\r\n                text: localizationMessage.format(DIALOG_IMAGE_ENCODE_TO_BASE64),\r\n                onValueChanged: e => {\r\n                    if (this.isBase64Editable()) {\r\n                        this.useBase64 = e.value\r\n                    }\r\n                }\r\n            }\r\n        }]\r\n    }\r\n}\r\nexport function correctSlashesInUrl(url) {\r\n    return \"/\" !== url[url.length - 1] ? url + \"/\" : url\r\n}\r\nexport function getFileUploaderBaseOptions() {\r\n    return {\r\n        value: [],\r\n        name: FILE_UPLOADER_NAME,\r\n        accept: \"image/*\",\r\n        uploadMode: \"useButtons\"\r\n    }\r\n}\r\nexport function urlUpload(quill, index, attributes) {\r\n    quill.insertEmbed(index, \"extendedImage\", attributes, USER_ACTION);\r\n    quill.setSelection(index + 1, 0, USER_ACTION)\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}