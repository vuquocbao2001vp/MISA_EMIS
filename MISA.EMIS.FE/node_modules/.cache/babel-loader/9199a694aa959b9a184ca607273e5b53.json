{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/text_box/ui.text_editor.mask.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport caretUtils from \"./utils.caret\";\nimport { isInputEventsL2Supported } from \"./utils.support\";\nimport { each } from \"../../core/utils/iterator\";\nimport { addNamespace, createEvent, isCommandKeyPressed, normalizeKeyName } from \"../../events/utils/index\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport { extend } from \"../../core/utils/extend\";\nimport { focused } from \"../widget/selectors\";\nimport { isDefined } from \"../../core/utils/type\";\nimport messageLocalization from \"../../localization/message\";\nimport { noop } from \"../../core/utils/common\";\nimport { isEmpty } from \"../../core/utils/string\";\nimport { name as wheelEventName } from \"../../events/core/wheel\";\nimport { EmptyMaskRule, StubMaskRule, MaskRule } from \"./ui.text_editor.mask.rule\";\nimport TextEditorBase from \"./ui.text_editor.base\";\nimport DefaultMaskStrategy from \"./ui.text_editor.mask.strategy.default\";\nimport InputEventsMaskStrategy from \"./ui.text_editor.mask.strategy.input_events\";\n\nvar stubCaret = function () {\n  return {};\n};\n\nvar caret = caretUtils;\nvar EMPTY_CHAR = \" \";\nvar ESCAPED_CHAR = \"\\\\\";\nvar TEXTEDITOR_MASKED_CLASS = \"dx-texteditor-masked\";\nvar FORWARD_DIRECTION = \"forward\";\nvar BACKWARD_DIRECTION = \"backward\";\nvar buildInMaskRules = {\n  0: /[0-9]/,\n  9: /[0-9\\s]/,\n  \"#\": /[-+0-9\\s]/,\n  L: function (char) {\n    return isLiteralChar(char);\n  },\n  l: function (char) {\n    return isLiteralChar(char) || isSpaceChar(char);\n  },\n  C: /\\S/,\n  c: /./,\n  A: function (char) {\n    return isLiteralChar(char) || isNumericChar(char);\n  },\n  a: function (char) {\n    return isLiteralChar(char) || isNumericChar(char) || isSpaceChar(char);\n  }\n};\n\nfunction isNumericChar(char) {\n  return /[0-9]/.test(char);\n}\n\nfunction isLiteralChar(char) {\n  var code = char.charCodeAt();\n  return 64 < code && code < 91 || 96 < code && code < 123 || code > 127;\n}\n\nfunction isSpaceChar(char) {\n  return \" \" === char;\n}\n\nvar TextEditorMask = TextEditorBase.inherit({\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      mask: \"\",\n      maskChar: \"_\",\n      maskRules: {},\n      maskInvalidMessage: messageLocalization.format(\"validation-mask\"),\n      useMaskedValue: false,\n      showMaskMode: \"always\"\n    });\n  },\n  _supportedKeys: function () {\n    var that = this;\n    var keyHandlerMap = {\n      backspace: that._maskStrategy.getHandler(\"backspace\"),\n      del: that._maskStrategy.getHandler(\"del\"),\n      enter: that._changeHandler\n    };\n    var result = that.callBase();\n    each(keyHandlerMap, function (key, callback) {\n      var parentHandler = result[key];\n\n      result[key] = function (e) {\n        that.option(\"mask\") && callback.call(that, e);\n        parentHandler && parentHandler(e);\n      };\n    });\n    return result;\n  },\n  _getSubmitElement: function () {\n    return !this.option(\"mask\") ? this.callBase() : this._$hiddenElement;\n  },\n  _init: function () {\n    this.callBase();\n\n    this._initMaskStrategy();\n  },\n  _initMaskStrategy: function () {\n    this._maskStrategy = isInputEventsL2Supported() ? new InputEventsMaskStrategy(this) : new DefaultMaskStrategy(this);\n  },\n  _initMarkup: function () {\n    this._renderHiddenElement();\n\n    this.callBase();\n  },\n  _attachMouseWheelEventHandlers: function () {\n    var hasMouseWheelHandler = this._onMouseWheel !== noop;\n\n    if (!hasMouseWheelHandler) {\n      return;\n    }\n\n    var input = this._input();\n\n    var eventName = addNamespace(wheelEventName, this.NAME);\n\n    var mouseWheelAction = this._createAction(function (e) {\n      var {\n        event: event\n      } = e;\n\n      if (focused(input) && !isCommandKeyPressed(event)) {\n        this._onMouseWheel(event);\n\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }.bind(this));\n\n    eventsEngine.off(input, eventName);\n    eventsEngine.on(input, eventName, function (e) {\n      mouseWheelAction({\n        event: e\n      });\n    });\n  },\n  _onMouseWheel: noop,\n  _render: function () {\n    this._renderMask();\n\n    this.callBase();\n\n    this._attachMouseWheelEventHandlers();\n  },\n  _renderHiddenElement: function () {\n    if (this.option(\"mask\")) {\n      this._$hiddenElement = $(\"<input>\").attr(\"type\", \"hidden\").appendTo(this._inputWrapper());\n    }\n  },\n  _removeHiddenElement: function () {\n    this._$hiddenElement && this._$hiddenElement.remove();\n  },\n  _renderMask: function () {\n    this.$element().removeClass(TEXTEDITOR_MASKED_CLASS);\n    this._maskRulesChain = null;\n\n    this._maskStrategy.detachEvents();\n\n    if (!this.option(\"mask\")) {\n      return;\n    }\n\n    this.$element().addClass(TEXTEDITOR_MASKED_CLASS);\n\n    this._maskStrategy.attachEvents();\n\n    this._parseMask();\n\n    this._renderMaskedValue();\n  },\n  _suppressCaretChanging: function (callback, args) {\n    caret = stubCaret;\n\n    try {\n      callback.apply(this, args);\n    } finally {\n      caret = caretUtils;\n    }\n  },\n  _changeHandler: function (e) {\n    var $input = this._input();\n\n    var inputValue = $input.val();\n\n    if (inputValue === this._changedValue) {\n      return;\n    }\n\n    this._changedValue = inputValue;\n    var changeEvent = createEvent(e, {\n      type: \"change\"\n    });\n    eventsEngine.trigger($input, changeEvent);\n  },\n  _parseMask: function () {\n    this._maskRules = extend({}, buildInMaskRules, this.option(\"maskRules\"));\n    this._maskRulesChain = this._parseMaskRule(0);\n  },\n  _parseMaskRule: function (index) {\n    var mask = this.option(\"mask\");\n\n    if (index >= mask.length) {\n      return new EmptyMaskRule();\n    }\n\n    var currentMaskChar = mask[index];\n    var isEscapedChar = currentMaskChar === ESCAPED_CHAR;\n    var result = isEscapedChar ? new StubMaskRule({\n      maskChar: mask[index + 1]\n    }) : this._getMaskRule(currentMaskChar);\n    result.next(this._parseMaskRule(index + 1 + isEscapedChar));\n    return result;\n  },\n  _getMaskRule: function (pattern) {\n    var ruleConfig;\n    each(this._maskRules, function (rulePattern, allowedChars) {\n      if (rulePattern === pattern) {\n        ruleConfig = {\n          pattern: rulePattern,\n          allowedChars: allowedChars\n        };\n        return false;\n      }\n    });\n    return isDefined(ruleConfig) ? new MaskRule(extend({\n      maskChar: this.option(\"maskChar\")\n    }, ruleConfig)) : new StubMaskRule({\n      maskChar: pattern\n    });\n  },\n  _renderMaskedValue: function () {\n    if (!this._maskRulesChain) {\n      return;\n    }\n\n    var value = this.option(\"value\") || \"\";\n\n    this._maskRulesChain.clear(this._normalizeChainArguments());\n\n    var chainArgs = {\n      length: value.length\n    };\n    chainArgs[this._isMaskedValueMode() ? \"text\" : \"value\"] = value;\n\n    this._handleChain(chainArgs);\n\n    this._displayMask();\n  },\n  _replaceSelectedText: function (text, selection, char) {\n    if (void 0 === char) {\n      return text;\n    }\n\n    var textBefore = text.slice(0, selection.start);\n    var textAfter = text.slice(selection.end);\n    var edited = textBefore + char + textAfter;\n    return edited;\n  },\n  _isMaskedValueMode: function () {\n    return this.option(\"useMaskedValue\");\n  },\n  _displayMask: function (caret) {\n    caret = caret || this._caret();\n\n    this._renderValue();\n\n    this._caret(caret);\n  },\n  _isValueEmpty: function () {\n    return isEmpty(this._value);\n  },\n  _shouldShowMask: function () {\n    var showMaskMode = this.option(\"showMaskMode\");\n\n    if (\"onFocus\" === showMaskMode) {\n      return focused(this._input()) || !this._isValueEmpty();\n    }\n\n    return true;\n  },\n  _showMaskPlaceholder: function () {\n    if (this._shouldShowMask()) {\n      var text = this._maskRulesChain.text();\n\n      this.option(\"text\", text);\n\n      if (\"onFocus\" === this.option(\"showMaskMode\")) {\n        this._renderDisplayText(text);\n      }\n    }\n  },\n  _renderValue: function () {\n    if (this._maskRulesChain) {\n      this._showMaskPlaceholder();\n\n      if (this._$hiddenElement) {\n        var value = this._maskRulesChain.value();\n\n        var submitElementValue = !isEmpty(value) ? this._getPreparedValue() : \"\";\n\n        this._$hiddenElement.val(submitElementValue);\n      }\n    }\n\n    return this.callBase();\n  },\n  _getPreparedValue: function () {\n    return this._convertToValue().replace(/\\s+$/, \"\");\n  },\n  _valueChangeEventHandler: function (e) {\n    if (!this._maskRulesChain) {\n      this.callBase.apply(this, arguments);\n      return;\n    }\n\n    this._saveValueChangeEvent(e);\n\n    this.option(\"value\", this._getPreparedValue());\n  },\n  _isControlKeyFired: function (e) {\n    return this._isControlKey(normalizeKeyName(e)) || isCommandKeyPressed(e);\n  },\n  _handleChain: function (args) {\n    var handledCount = this._maskRulesChain.handle(this._normalizeChainArguments(args));\n\n    this._value = this._maskRulesChain.value();\n    this._textValue = this._maskRulesChain.text();\n    return handledCount;\n  },\n  _normalizeChainArguments: function (args) {\n    args = args || {};\n    args.index = 0;\n    args.fullText = this._maskRulesChain.text();\n    return args;\n  },\n  _convertToValue: function (text) {\n    if (this._isMaskedValueMode()) {\n      text = this._replaceMaskCharWithEmpty(text || this._textValue || \"\");\n    } else {\n      text = text || this._value || \"\";\n    }\n\n    return text;\n  },\n  _replaceMaskCharWithEmpty: function (text) {\n    return text.replace(new RegExp(this.option(\"maskChar\"), \"g\"), EMPTY_CHAR);\n  },\n  _maskKeyHandler: function (e, keyHandler) {\n    if (this.option(\"readOnly\")) {\n      return;\n    }\n\n    this.setForwardDirection();\n    e.preventDefault();\n\n    this._handleSelection();\n\n    var previousText = this._input().val();\n\n    var raiseInputEvent = () => {\n      if (previousText !== this._input().val()) {\n        this._maskStrategy.runWithoutEventProcessing(() => eventsEngine.trigger(this._input(), \"input\"));\n      }\n    };\n\n    var handled = keyHandler();\n\n    if (handled) {\n      handled.then(raiseInputEvent);\n    } else {\n      this.setForwardDirection();\n\n      this._adjustCaret();\n\n      this._displayMask();\n\n      this._maskRulesChain.reset();\n\n      raiseInputEvent();\n    }\n  },\n  _handleKey: function (key, direction) {\n    this._direction(direction || FORWARD_DIRECTION);\n\n    this._adjustCaret(key);\n\n    this._handleKeyChain(key);\n\n    this._moveCaret();\n  },\n  _handleSelection: function () {\n    if (!this._hasSelection()) {\n      return;\n    }\n\n    var caret = this._caret();\n\n    var emptyChars = new Array(caret.end - caret.start + 1).join(EMPTY_CHAR);\n\n    this._handleKeyChain(emptyChars);\n  },\n  _handleKeyChain: function (chars) {\n    var caret = this._caret();\n\n    var start = this.isForwardDirection() ? caret.start : caret.start - 1;\n    var end = this.isForwardDirection() ? caret.end : caret.end - 1;\n    var length = start === end ? 1 : end - start;\n\n    this._handleChain({\n      text: chars,\n      start: start,\n      length: length\n    });\n  },\n  _tryMoveCaretBackward: function () {\n    this.setBackwardDirection();\n\n    var currentCaret = this._caret().start;\n\n    this._adjustCaret();\n\n    return !currentCaret || currentCaret !== this._caret().start;\n  },\n  _adjustCaret: function (char) {\n    var caretStart = this._caret().start;\n\n    var isForwardDirection = this.isForwardDirection();\n\n    var caret = this._maskRulesChain.adjustedCaret(caretStart, isForwardDirection, char);\n\n    this._caret({\n      start: caret,\n      end: caret\n    });\n  },\n  _moveCaret: function () {\n    var currentCaret = this._caret().start;\n\n    var maskRuleIndex = currentCaret + (this.isForwardDirection() ? 0 : -1);\n    var caret = this._maskRulesChain.isAccepted(maskRuleIndex) ? currentCaret + (this.isForwardDirection() ? 1 : -1) : currentCaret;\n\n    this._caret({\n      start: caret,\n      end: caret\n    });\n  },\n  _caret: function (position, force) {\n    var $input = this._input();\n\n    if (!$input.length) {\n      return;\n    }\n\n    if (!arguments.length) {\n      return caret($input);\n    }\n\n    caret($input, position, force);\n  },\n  _hasSelection: function () {\n    var caret = this._caret();\n\n    return caret.start !== caret.end;\n  },\n  _direction: function (direction) {\n    if (!arguments.length) {\n      return this._typingDirection;\n    }\n\n    this._typingDirection = direction;\n  },\n  setForwardDirection: function () {\n    this._direction(FORWARD_DIRECTION);\n  },\n  setBackwardDirection: function () {\n    this._direction(BACKWARD_DIRECTION);\n  },\n  isForwardDirection: function () {\n    return this._direction() === FORWARD_DIRECTION;\n  },\n  _clean: function () {\n    this._maskStrategy && this._maskStrategy.clean();\n    this.callBase();\n  },\n  _validateMask: function () {\n    if (!this._maskRulesChain) {\n      return;\n    }\n\n    var isValid = isEmpty(this.option(\"value\")) || this._maskRulesChain.isValid(this._normalizeChainArguments());\n\n    this.option({\n      isValid: isValid,\n      validationError: isValid ? null : {\n        editorSpecific: true,\n        message: this.option(\"maskInvalidMessage\")\n      }\n    });\n  },\n  _updateHiddenElement: function () {\n    this._removeHiddenElement();\n\n    if (this.option(\"mask\")) {\n      this._input().removeAttr(\"name\");\n\n      this._renderHiddenElement();\n    }\n\n    this._setSubmitElementName(this.option(\"name\"));\n  },\n  _updateMaskOption: function () {\n    this._updateHiddenElement();\n\n    this._renderMask();\n\n    this._validateMask();\n  },\n  _processEmptyMask: function (mask) {\n    if (mask) {\n      return;\n    }\n\n    var value = this.option(\"value\");\n    this.option({\n      text: value,\n      isValid: true\n    });\n    this.validationRequest.fire({\n      value: value,\n      editor: this\n    });\n\n    this._renderValue();\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"mask\":\n        this._updateMaskOption();\n\n        this._processEmptyMask(args.value);\n\n        break;\n\n      case \"maskChar\":\n      case \"maskRules\":\n      case \"useMaskedValue\":\n        this._updateMaskOption();\n\n        break;\n\n      case \"value\":\n        this._renderMaskedValue();\n\n        this._validateMask();\n\n        this.callBase(args);\n        this._changedValue = this._input().val();\n        break;\n\n      case \"maskInvalidMessage\":\n        break;\n\n      case \"showMaskMode\":\n        this.option(\"text\", \"\");\n\n        this._renderValue();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  }\n});\nexport default TextEditorMask;","map":{"version":3,"names":["$","caretUtils","isInputEventsL2Supported","each","addNamespace","createEvent","isCommandKeyPressed","normalizeKeyName","eventsEngine","extend","focused","isDefined","messageLocalization","noop","isEmpty","name","wheelEventName","EmptyMaskRule","StubMaskRule","MaskRule","TextEditorBase","DefaultMaskStrategy","InputEventsMaskStrategy","stubCaret","caret","EMPTY_CHAR","ESCAPED_CHAR","TEXTEDITOR_MASKED_CLASS","FORWARD_DIRECTION","BACKWARD_DIRECTION","buildInMaskRules","L","char","isLiteralChar","l","isSpaceChar","C","c","A","isNumericChar","a","test","code","charCodeAt","TextEditorMask","inherit","_getDefaultOptions","callBase","mask","maskChar","maskRules","maskInvalidMessage","format","useMaskedValue","showMaskMode","_supportedKeys","that","keyHandlerMap","backspace","_maskStrategy","getHandler","del","enter","_changeHandler","result","key","callback","parentHandler","e","option","call","_getSubmitElement","_$hiddenElement","_init","_initMaskStrategy","_initMarkup","_renderHiddenElement","_attachMouseWheelEventHandlers","hasMouseWheelHandler","_onMouseWheel","input","_input","eventName","NAME","mouseWheelAction","_createAction","event","preventDefault","stopPropagation","bind","off","on","_render","_renderMask","attr","appendTo","_inputWrapper","_removeHiddenElement","remove","$element","removeClass","_maskRulesChain","detachEvents","addClass","attachEvents","_parseMask","_renderMaskedValue","_suppressCaretChanging","args","apply","$input","inputValue","val","_changedValue","changeEvent","type","trigger","_maskRules","_parseMaskRule","index","length","currentMaskChar","isEscapedChar","_getMaskRule","next","pattern","ruleConfig","rulePattern","allowedChars","value","clear","_normalizeChainArguments","chainArgs","_isMaskedValueMode","_handleChain","_displayMask","_replaceSelectedText","text","selection","textBefore","slice","start","textAfter","end","edited","_caret","_renderValue","_isValueEmpty","_value","_shouldShowMask","_showMaskPlaceholder","_renderDisplayText","submitElementValue","_getPreparedValue","_convertToValue","replace","_valueChangeEventHandler","arguments","_saveValueChangeEvent","_isControlKeyFired","_isControlKey","handledCount","handle","_textValue","fullText","_replaceMaskCharWithEmpty","RegExp","_maskKeyHandler","keyHandler","setForwardDirection","_handleSelection","previousText","raiseInputEvent","runWithoutEventProcessing","handled","then","_adjustCaret","reset","_handleKey","direction","_direction","_handleKeyChain","_moveCaret","_hasSelection","emptyChars","Array","join","chars","isForwardDirection","_tryMoveCaretBackward","setBackwardDirection","currentCaret","caretStart","adjustedCaret","maskRuleIndex","isAccepted","position","force","_typingDirection","_clean","clean","_validateMask","isValid","validationError","editorSpecific","message","_updateHiddenElement","removeAttr","_setSubmitElementName","_updateMaskOption","_processEmptyMask","validationRequest","fire","editor","_optionChanged"],"sources":["E:/MisaProject/W2022_06/MISA.EMIS.FE/node_modules/devextreme/esm/ui/text_box/ui.text_editor.mask.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/text_box/ui.text_editor.mask.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport caretUtils from \"./utils.caret\";\r\nimport {\r\n    isInputEventsL2Supported\r\n} from \"./utils.support\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    addNamespace,\r\n    createEvent,\r\n    isCommandKeyPressed,\r\n    normalizeKeyName\r\n} from \"../../events/utils/index\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    focused\r\n} from \"../widget/selectors\";\r\nimport {\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport messageLocalization from \"../../localization/message\";\r\nimport {\r\n    noop\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    isEmpty\r\n} from \"../../core/utils/string\";\r\nimport {\r\n    name as wheelEventName\r\n} from \"../../events/core/wheel\";\r\nimport {\r\n    EmptyMaskRule,\r\n    StubMaskRule,\r\n    MaskRule\r\n} from \"./ui.text_editor.mask.rule\";\r\nimport TextEditorBase from \"./ui.text_editor.base\";\r\nimport DefaultMaskStrategy from \"./ui.text_editor.mask.strategy.default\";\r\nimport InputEventsMaskStrategy from \"./ui.text_editor.mask.strategy.input_events\";\r\nvar stubCaret = function() {\r\n    return {}\r\n};\r\nvar caret = caretUtils;\r\nvar EMPTY_CHAR = \" \";\r\nvar ESCAPED_CHAR = \"\\\\\";\r\nvar TEXTEDITOR_MASKED_CLASS = \"dx-texteditor-masked\";\r\nvar FORWARD_DIRECTION = \"forward\";\r\nvar BACKWARD_DIRECTION = \"backward\";\r\nvar buildInMaskRules = {\r\n    0: /[0-9]/,\r\n    9: /[0-9\\s]/,\r\n    \"#\": /[-+0-9\\s]/,\r\n    L: function(char) {\r\n        return isLiteralChar(char)\r\n    },\r\n    l: function(char) {\r\n        return isLiteralChar(char) || isSpaceChar(char)\r\n    },\r\n    C: /\\S/,\r\n    c: /./,\r\n    A: function(char) {\r\n        return isLiteralChar(char) || isNumericChar(char)\r\n    },\r\n    a: function(char) {\r\n        return isLiteralChar(char) || isNumericChar(char) || isSpaceChar(char)\r\n    }\r\n};\r\n\r\nfunction isNumericChar(char) {\r\n    return /[0-9]/.test(char)\r\n}\r\n\r\nfunction isLiteralChar(char) {\r\n    var code = char.charCodeAt();\r\n    return 64 < code && code < 91 || 96 < code && code < 123 || code > 127\r\n}\r\n\r\nfunction isSpaceChar(char) {\r\n    return \" \" === char\r\n}\r\nvar TextEditorMask = TextEditorBase.inherit({\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            mask: \"\",\r\n            maskChar: \"_\",\r\n            maskRules: {},\r\n            maskInvalidMessage: messageLocalization.format(\"validation-mask\"),\r\n            useMaskedValue: false,\r\n            showMaskMode: \"always\"\r\n        })\r\n    },\r\n    _supportedKeys: function() {\r\n        var that = this;\r\n        var keyHandlerMap = {\r\n            backspace: that._maskStrategy.getHandler(\"backspace\"),\r\n            del: that._maskStrategy.getHandler(\"del\"),\r\n            enter: that._changeHandler\r\n        };\r\n        var result = that.callBase();\r\n        each(keyHandlerMap, (function(key, callback) {\r\n            var parentHandler = result[key];\r\n            result[key] = function(e) {\r\n                that.option(\"mask\") && callback.call(that, e);\r\n                parentHandler && parentHandler(e)\r\n            }\r\n        }));\r\n        return result\r\n    },\r\n    _getSubmitElement: function() {\r\n        return !this.option(\"mask\") ? this.callBase() : this._$hiddenElement\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initMaskStrategy()\r\n    },\r\n    _initMaskStrategy: function() {\r\n        this._maskStrategy = isInputEventsL2Supported() ? new InputEventsMaskStrategy(this) : new DefaultMaskStrategy(this)\r\n    },\r\n    _initMarkup: function() {\r\n        this._renderHiddenElement();\r\n        this.callBase()\r\n    },\r\n    _attachMouseWheelEventHandlers: function() {\r\n        var hasMouseWheelHandler = this._onMouseWheel !== noop;\r\n        if (!hasMouseWheelHandler) {\r\n            return\r\n        }\r\n        var input = this._input();\r\n        var eventName = addNamespace(wheelEventName, this.NAME);\r\n        var mouseWheelAction = this._createAction(function(e) {\r\n            var {\r\n                event: event\r\n            } = e;\r\n            if (focused(input) && !isCommandKeyPressed(event)) {\r\n                this._onMouseWheel(event);\r\n                event.preventDefault();\r\n                event.stopPropagation()\r\n            }\r\n        }.bind(this));\r\n        eventsEngine.off(input, eventName);\r\n        eventsEngine.on(input, eventName, (function(e) {\r\n            mouseWheelAction({\r\n                event: e\r\n            })\r\n        }))\r\n    },\r\n    _onMouseWheel: noop,\r\n    _render: function() {\r\n        this._renderMask();\r\n        this.callBase();\r\n        this._attachMouseWheelEventHandlers()\r\n    },\r\n    _renderHiddenElement: function() {\r\n        if (this.option(\"mask\")) {\r\n            this._$hiddenElement = $(\"<input>\").attr(\"type\", \"hidden\").appendTo(this._inputWrapper())\r\n        }\r\n    },\r\n    _removeHiddenElement: function() {\r\n        this._$hiddenElement && this._$hiddenElement.remove()\r\n    },\r\n    _renderMask: function() {\r\n        this.$element().removeClass(TEXTEDITOR_MASKED_CLASS);\r\n        this._maskRulesChain = null;\r\n        this._maskStrategy.detachEvents();\r\n        if (!this.option(\"mask\")) {\r\n            return\r\n        }\r\n        this.$element().addClass(TEXTEDITOR_MASKED_CLASS);\r\n        this._maskStrategy.attachEvents();\r\n        this._parseMask();\r\n        this._renderMaskedValue()\r\n    },\r\n    _suppressCaretChanging: function(callback, args) {\r\n        caret = stubCaret;\r\n        try {\r\n            callback.apply(this, args)\r\n        } finally {\r\n            caret = caretUtils\r\n        }\r\n    },\r\n    _changeHandler: function(e) {\r\n        var $input = this._input();\r\n        var inputValue = $input.val();\r\n        if (inputValue === this._changedValue) {\r\n            return\r\n        }\r\n        this._changedValue = inputValue;\r\n        var changeEvent = createEvent(e, {\r\n            type: \"change\"\r\n        });\r\n        eventsEngine.trigger($input, changeEvent)\r\n    },\r\n    _parseMask: function() {\r\n        this._maskRules = extend({}, buildInMaskRules, this.option(\"maskRules\"));\r\n        this._maskRulesChain = this._parseMaskRule(0)\r\n    },\r\n    _parseMaskRule: function(index) {\r\n        var mask = this.option(\"mask\");\r\n        if (index >= mask.length) {\r\n            return new EmptyMaskRule\r\n        }\r\n        var currentMaskChar = mask[index];\r\n        var isEscapedChar = currentMaskChar === ESCAPED_CHAR;\r\n        var result = isEscapedChar ? new StubMaskRule({\r\n            maskChar: mask[index + 1]\r\n        }) : this._getMaskRule(currentMaskChar);\r\n        result.next(this._parseMaskRule(index + 1 + isEscapedChar));\r\n        return result\r\n    },\r\n    _getMaskRule: function(pattern) {\r\n        var ruleConfig;\r\n        each(this._maskRules, (function(rulePattern, allowedChars) {\r\n            if (rulePattern === pattern) {\r\n                ruleConfig = {\r\n                    pattern: rulePattern,\r\n                    allowedChars: allowedChars\r\n                };\r\n                return false\r\n            }\r\n        }));\r\n        return isDefined(ruleConfig) ? new MaskRule(extend({\r\n            maskChar: this.option(\"maskChar\")\r\n        }, ruleConfig)) : new StubMaskRule({\r\n            maskChar: pattern\r\n        })\r\n    },\r\n    _renderMaskedValue: function() {\r\n        if (!this._maskRulesChain) {\r\n            return\r\n        }\r\n        var value = this.option(\"value\") || \"\";\r\n        this._maskRulesChain.clear(this._normalizeChainArguments());\r\n        var chainArgs = {\r\n            length: value.length\r\n        };\r\n        chainArgs[this._isMaskedValueMode() ? \"text\" : \"value\"] = value;\r\n        this._handleChain(chainArgs);\r\n        this._displayMask()\r\n    },\r\n    _replaceSelectedText: function(text, selection, char) {\r\n        if (void 0 === char) {\r\n            return text\r\n        }\r\n        var textBefore = text.slice(0, selection.start);\r\n        var textAfter = text.slice(selection.end);\r\n        var edited = textBefore + char + textAfter;\r\n        return edited\r\n    },\r\n    _isMaskedValueMode: function() {\r\n        return this.option(\"useMaskedValue\")\r\n    },\r\n    _displayMask: function(caret) {\r\n        caret = caret || this._caret();\r\n        this._renderValue();\r\n        this._caret(caret)\r\n    },\r\n    _isValueEmpty: function() {\r\n        return isEmpty(this._value)\r\n    },\r\n    _shouldShowMask: function() {\r\n        var showMaskMode = this.option(\"showMaskMode\");\r\n        if (\"onFocus\" === showMaskMode) {\r\n            return focused(this._input()) || !this._isValueEmpty()\r\n        }\r\n        return true\r\n    },\r\n    _showMaskPlaceholder: function() {\r\n        if (this._shouldShowMask()) {\r\n            var text = this._maskRulesChain.text();\r\n            this.option(\"text\", text);\r\n            if (\"onFocus\" === this.option(\"showMaskMode\")) {\r\n                this._renderDisplayText(text)\r\n            }\r\n        }\r\n    },\r\n    _renderValue: function() {\r\n        if (this._maskRulesChain) {\r\n            this._showMaskPlaceholder();\r\n            if (this._$hiddenElement) {\r\n                var value = this._maskRulesChain.value();\r\n                var submitElementValue = !isEmpty(value) ? this._getPreparedValue() : \"\";\r\n                this._$hiddenElement.val(submitElementValue)\r\n            }\r\n        }\r\n        return this.callBase()\r\n    },\r\n    _getPreparedValue: function() {\r\n        return this._convertToValue().replace(/\\s+$/, \"\")\r\n    },\r\n    _valueChangeEventHandler: function(e) {\r\n        if (!this._maskRulesChain) {\r\n            this.callBase.apply(this, arguments);\r\n            return\r\n        }\r\n        this._saveValueChangeEvent(e);\r\n        this.option(\"value\", this._getPreparedValue())\r\n    },\r\n    _isControlKeyFired: function(e) {\r\n        return this._isControlKey(normalizeKeyName(e)) || isCommandKeyPressed(e)\r\n    },\r\n    _handleChain: function(args) {\r\n        var handledCount = this._maskRulesChain.handle(this._normalizeChainArguments(args));\r\n        this._value = this._maskRulesChain.value();\r\n        this._textValue = this._maskRulesChain.text();\r\n        return handledCount\r\n    },\r\n    _normalizeChainArguments: function(args) {\r\n        args = args || {};\r\n        args.index = 0;\r\n        args.fullText = this._maskRulesChain.text();\r\n        return args\r\n    },\r\n    _convertToValue: function(text) {\r\n        if (this._isMaskedValueMode()) {\r\n            text = this._replaceMaskCharWithEmpty(text || this._textValue || \"\")\r\n        } else {\r\n            text = text || this._value || \"\"\r\n        }\r\n        return text\r\n    },\r\n    _replaceMaskCharWithEmpty: function(text) {\r\n        return text.replace(new RegExp(this.option(\"maskChar\"), \"g\"), EMPTY_CHAR)\r\n    },\r\n    _maskKeyHandler: function(e, keyHandler) {\r\n        if (this.option(\"readOnly\")) {\r\n            return\r\n        }\r\n        this.setForwardDirection();\r\n        e.preventDefault();\r\n        this._handleSelection();\r\n        var previousText = this._input().val();\r\n        var raiseInputEvent = () => {\r\n            if (previousText !== this._input().val()) {\r\n                this._maskStrategy.runWithoutEventProcessing(() => eventsEngine.trigger(this._input(), \"input\"))\r\n            }\r\n        };\r\n        var handled = keyHandler();\r\n        if (handled) {\r\n            handled.then(raiseInputEvent)\r\n        } else {\r\n            this.setForwardDirection();\r\n            this._adjustCaret();\r\n            this._displayMask();\r\n            this._maskRulesChain.reset();\r\n            raiseInputEvent()\r\n        }\r\n    },\r\n    _handleKey: function(key, direction) {\r\n        this._direction(direction || FORWARD_DIRECTION);\r\n        this._adjustCaret(key);\r\n        this._handleKeyChain(key);\r\n        this._moveCaret()\r\n    },\r\n    _handleSelection: function() {\r\n        if (!this._hasSelection()) {\r\n            return\r\n        }\r\n        var caret = this._caret();\r\n        var emptyChars = new Array(caret.end - caret.start + 1).join(EMPTY_CHAR);\r\n        this._handleKeyChain(emptyChars)\r\n    },\r\n    _handleKeyChain: function(chars) {\r\n        var caret = this._caret();\r\n        var start = this.isForwardDirection() ? caret.start : caret.start - 1;\r\n        var end = this.isForwardDirection() ? caret.end : caret.end - 1;\r\n        var length = start === end ? 1 : end - start;\r\n        this._handleChain({\r\n            text: chars,\r\n            start: start,\r\n            length: length\r\n        })\r\n    },\r\n    _tryMoveCaretBackward: function() {\r\n        this.setBackwardDirection();\r\n        var currentCaret = this._caret().start;\r\n        this._adjustCaret();\r\n        return !currentCaret || currentCaret !== this._caret().start\r\n    },\r\n    _adjustCaret: function(char) {\r\n        var caretStart = this._caret().start;\r\n        var isForwardDirection = this.isForwardDirection();\r\n        var caret = this._maskRulesChain.adjustedCaret(caretStart, isForwardDirection, char);\r\n        this._caret({\r\n            start: caret,\r\n            end: caret\r\n        })\r\n    },\r\n    _moveCaret: function() {\r\n        var currentCaret = this._caret().start;\r\n        var maskRuleIndex = currentCaret + (this.isForwardDirection() ? 0 : -1);\r\n        var caret = this._maskRulesChain.isAccepted(maskRuleIndex) ? currentCaret + (this.isForwardDirection() ? 1 : -1) : currentCaret;\r\n        this._caret({\r\n            start: caret,\r\n            end: caret\r\n        })\r\n    },\r\n    _caret: function(position, force) {\r\n        var $input = this._input();\r\n        if (!$input.length) {\r\n            return\r\n        }\r\n        if (!arguments.length) {\r\n            return caret($input)\r\n        }\r\n        caret($input, position, force)\r\n    },\r\n    _hasSelection: function() {\r\n        var caret = this._caret();\r\n        return caret.start !== caret.end\r\n    },\r\n    _direction: function(direction) {\r\n        if (!arguments.length) {\r\n            return this._typingDirection\r\n        }\r\n        this._typingDirection = direction\r\n    },\r\n    setForwardDirection: function() {\r\n        this._direction(FORWARD_DIRECTION)\r\n    },\r\n    setBackwardDirection: function() {\r\n        this._direction(BACKWARD_DIRECTION)\r\n    },\r\n    isForwardDirection: function() {\r\n        return this._direction() === FORWARD_DIRECTION\r\n    },\r\n    _clean: function() {\r\n        this._maskStrategy && this._maskStrategy.clean();\r\n        this.callBase()\r\n    },\r\n    _validateMask: function() {\r\n        if (!this._maskRulesChain) {\r\n            return\r\n        }\r\n        var isValid = isEmpty(this.option(\"value\")) || this._maskRulesChain.isValid(this._normalizeChainArguments());\r\n        this.option({\r\n            isValid: isValid,\r\n            validationError: isValid ? null : {\r\n                editorSpecific: true,\r\n                message: this.option(\"maskInvalidMessage\")\r\n            }\r\n        })\r\n    },\r\n    _updateHiddenElement: function() {\r\n        this._removeHiddenElement();\r\n        if (this.option(\"mask\")) {\r\n            this._input().removeAttr(\"name\");\r\n            this._renderHiddenElement()\r\n        }\r\n        this._setSubmitElementName(this.option(\"name\"))\r\n    },\r\n    _updateMaskOption: function() {\r\n        this._updateHiddenElement();\r\n        this._renderMask();\r\n        this._validateMask()\r\n    },\r\n    _processEmptyMask: function(mask) {\r\n        if (mask) {\r\n            return\r\n        }\r\n        var value = this.option(\"value\");\r\n        this.option({\r\n            text: value,\r\n            isValid: true\r\n        });\r\n        this.validationRequest.fire({\r\n            value: value,\r\n            editor: this\r\n        });\r\n        this._renderValue()\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"mask\":\r\n                this._updateMaskOption();\r\n                this._processEmptyMask(args.value);\r\n                break;\r\n            case \"maskChar\":\r\n            case \"maskRules\":\r\n            case \"useMaskedValue\":\r\n                this._updateMaskOption();\r\n                break;\r\n            case \"value\":\r\n                this._renderMaskedValue();\r\n                this._validateMask();\r\n                this.callBase(args);\r\n                this._changedValue = this._input().val();\r\n                break;\r\n            case \"maskInvalidMessage\":\r\n                break;\r\n            case \"showMaskMode\":\r\n                this.option(\"text\", \"\");\r\n                this._renderValue();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    }\r\n});\r\nexport default TextEditorMask;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}