{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/text_box/ui.text_editor.mask.strategy.default.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport BaseMaskStrategy from \"./ui.text_editor.mask.strategy.base\";\nimport { getChar } from \"../../events/utils/index\";\nvar BACKSPACE_INPUT_TYPE = \"deleteContentBackward\";\nvar EMPTY_CHAR = \" \";\n\nclass DefaultMaskStrategy extends BaseMaskStrategy {\n  _getStrategyName() {\n    return \"default\";\n  }\n\n  getHandleEventNames() {\n    return [...super.getHandleEventNames(), \"keyPress\"];\n  }\n\n  _keyPressHandler(event) {\n    if (this._keyPressHandled) {\n      return;\n    }\n\n    this._keyPressHandled = true;\n\n    if (this.editor._isControlKeyFired(event)) {\n      return;\n    }\n\n    var {\n      editor: editor\n    } = this;\n\n    editor._maskKeyHandler(event, () => editor._handleKey(getChar(event)));\n  }\n\n  _inputHandler(event) {\n    if (this._backspaceInputHandled(event.originalEvent && event.originalEvent.inputType)) {\n      this._handleBackspaceInput(event);\n    }\n\n    if (event.originalEvent) {\n      this._autoFillHandler(event);\n    }\n\n    if (this._keyPressHandled) {\n      return;\n    }\n\n    this._keyPressHandled = true;\n    var inputValue = this.editorInput().val();\n    var caret = this.editorCaret();\n\n    if (!caret.end) {\n      return;\n    }\n\n    caret.start = caret.end - 1;\n    var oldValue = inputValue.substring(0, caret.start) + inputValue.substring(caret.end);\n    var char = inputValue[caret.start];\n    var {\n      editor: editor\n    } = this;\n    this.editorInput().val(oldValue);\n\n    editor._caret({\n      start: caret.start,\n      end: caret.start\n    });\n\n    editor._maskKeyHandler(event, () => editor._handleKey(char));\n  }\n\n  _backspaceHandler(event) {\n    var {\n      editor: editor\n    } = this;\n    this._keyPressHandled = true;\n\n    var afterBackspaceHandler = (needAdjustCaret, callBack) => {\n      if (needAdjustCaret) {\n        editor._direction(this.DIRECTION.FORWARD);\n\n        editor._adjustCaret();\n      }\n\n      var currentCaret = this.editorCaret();\n      return new Promise(resolve => {\n        clearTimeout(this._backspaceHandlerTimeout);\n        this._backspaceHandlerTimeout = setTimeout(function () {\n          callBack(currentCaret);\n          resolve();\n        });\n      });\n    };\n\n    editor._maskKeyHandler(event, () => {\n      if (editor._hasSelection()) {\n        return afterBackspaceHandler(true, currentCaret => {\n          editor._displayMask(currentCaret);\n\n          editor._maskRulesChain.reset();\n        });\n      }\n\n      if (editor._tryMoveCaretBackward()) {\n        return afterBackspaceHandler(false, currentCaret => {\n          this.editorCaret(currentCaret);\n        });\n      }\n\n      editor._handleKey(EMPTY_CHAR, this.DIRECTION.BACKWARD);\n\n      return afterBackspaceHandler(true, currentCaret => {\n        editor._displayMask(currentCaret);\n\n        editor._maskRulesChain.reset();\n      });\n    });\n  }\n\n  _backspaceInputHandled(inputType) {\n    return inputType === BACKSPACE_INPUT_TYPE && !this._keyPressHandled;\n  }\n\n  _handleBackspaceInput(event) {\n    var {\n      start: start,\n      end: end\n    } = this.editorCaret();\n    this.editorCaret({\n      start: start + 1,\n      end: end + 1\n    });\n\n    this._backspaceHandler(event);\n  }\n\n}\n\nexport default DefaultMaskStrategy;","map":{"version":3,"names":["BaseMaskStrategy","getChar","BACKSPACE_INPUT_TYPE","EMPTY_CHAR","DefaultMaskStrategy","_getStrategyName","getHandleEventNames","_keyPressHandler","event","_keyPressHandled","editor","_isControlKeyFired","_maskKeyHandler","_handleKey","_inputHandler","_backspaceInputHandled","originalEvent","inputType","_handleBackspaceInput","_autoFillHandler","inputValue","editorInput","val","caret","editorCaret","end","start","oldValue","substring","char","_caret","_backspaceHandler","afterBackspaceHandler","needAdjustCaret","callBack","_direction","DIRECTION","FORWARD","_adjustCaret","currentCaret","Promise","resolve","clearTimeout","_backspaceHandlerTimeout","setTimeout","_hasSelection","_displayMask","_maskRulesChain","reset","_tryMoveCaretBackward","BACKWARD"],"sources":["E:/MisaProject/W2022_06/MISA.EMIS.FE/node_modules/devextreme/esm/ui/text_box/ui.text_editor.mask.strategy.default.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/text_box/ui.text_editor.mask.strategy.default.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport BaseMaskStrategy from \"./ui.text_editor.mask.strategy.base\";\r\nimport {\r\n    getChar\r\n} from \"../../events/utils/index\";\r\nvar BACKSPACE_INPUT_TYPE = \"deleteContentBackward\";\r\nvar EMPTY_CHAR = \" \";\r\nclass DefaultMaskStrategy extends BaseMaskStrategy {\r\n    _getStrategyName() {\r\n        return \"default\"\r\n    }\r\n    getHandleEventNames() {\r\n        return [...super.getHandleEventNames(), \"keyPress\"]\r\n    }\r\n    _keyPressHandler(event) {\r\n        if (this._keyPressHandled) {\r\n            return\r\n        }\r\n        this._keyPressHandled = true;\r\n        if (this.editor._isControlKeyFired(event)) {\r\n            return\r\n        }\r\n        var {\r\n            editor: editor\r\n        } = this;\r\n        editor._maskKeyHandler(event, () => editor._handleKey(getChar(event)))\r\n    }\r\n    _inputHandler(event) {\r\n        if (this._backspaceInputHandled(event.originalEvent && event.originalEvent.inputType)) {\r\n            this._handleBackspaceInput(event)\r\n        }\r\n        if (event.originalEvent) {\r\n            this._autoFillHandler(event)\r\n        }\r\n        if (this._keyPressHandled) {\r\n            return\r\n        }\r\n        this._keyPressHandled = true;\r\n        var inputValue = this.editorInput().val();\r\n        var caret = this.editorCaret();\r\n        if (!caret.end) {\r\n            return\r\n        }\r\n        caret.start = caret.end - 1;\r\n        var oldValue = inputValue.substring(0, caret.start) + inputValue.substring(caret.end);\r\n        var char = inputValue[caret.start];\r\n        var {\r\n            editor: editor\r\n        } = this;\r\n        this.editorInput().val(oldValue);\r\n        editor._caret({\r\n            start: caret.start,\r\n            end: caret.start\r\n        });\r\n        editor._maskKeyHandler(event, () => editor._handleKey(char))\r\n    }\r\n    _backspaceHandler(event) {\r\n        var {\r\n            editor: editor\r\n        } = this;\r\n        this._keyPressHandled = true;\r\n        var afterBackspaceHandler = (needAdjustCaret, callBack) => {\r\n            if (needAdjustCaret) {\r\n                editor._direction(this.DIRECTION.FORWARD);\r\n                editor._adjustCaret()\r\n            }\r\n            var currentCaret = this.editorCaret();\r\n            return new Promise(resolve => {\r\n                clearTimeout(this._backspaceHandlerTimeout);\r\n                this._backspaceHandlerTimeout = setTimeout((function() {\r\n                    callBack(currentCaret);\r\n                    resolve()\r\n                }))\r\n            })\r\n        };\r\n        editor._maskKeyHandler(event, () => {\r\n            if (editor._hasSelection()) {\r\n                return afterBackspaceHandler(true, currentCaret => {\r\n                    editor._displayMask(currentCaret);\r\n                    editor._maskRulesChain.reset()\r\n                })\r\n            }\r\n            if (editor._tryMoveCaretBackward()) {\r\n                return afterBackspaceHandler(false, currentCaret => {\r\n                    this.editorCaret(currentCaret)\r\n                })\r\n            }\r\n            editor._handleKey(EMPTY_CHAR, this.DIRECTION.BACKWARD);\r\n            return afterBackspaceHandler(true, currentCaret => {\r\n                editor._displayMask(currentCaret);\r\n                editor._maskRulesChain.reset()\r\n            })\r\n        })\r\n    }\r\n    _backspaceInputHandled(inputType) {\r\n        return inputType === BACKSPACE_INPUT_TYPE && !this._keyPressHandled\r\n    }\r\n    _handleBackspaceInput(event) {\r\n        var {\r\n            start: start,\r\n            end: end\r\n        } = this.editorCaret();\r\n        this.editorCaret({\r\n            start: start + 1,\r\n            end: end + 1\r\n        });\r\n        this._backspaceHandler(event)\r\n    }\r\n}\r\nexport default DefaultMaskStrategy;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}