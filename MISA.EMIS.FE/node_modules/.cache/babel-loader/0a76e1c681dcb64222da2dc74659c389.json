{"ast":null,"code":"/**\r\n * DevExtreme (esm/core/templates/bindable_template.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../renderer\";\nimport { TemplateBase } from \"./template_base\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport { removeEvent } from \"../../events/remove\";\nimport { isPrimitive } from \"../utils/type\";\n\nvar watchChanges = function (rawData, watchMethod, fields, fieldsMap, callback) {\n  var fieldsDispose;\n\n  var globalDispose = ((data, watchMethod, callback) => watchMethod(() => data, callback))(rawData, watchMethod, function (dataWithRawFields) {\n    fieldsDispose && fieldsDispose();\n\n    if (isPrimitive(dataWithRawFields)) {\n      callback(dataWithRawFields);\n      return;\n    }\n\n    fieldsDispose = function (data, watchMethod, fields, fieldsMap, callback) {\n      var resolvedData = {};\n      var missedFields = fields.slice();\n      var watchHandlers = fields.map(function (name) {\n        var fieldGetter = fieldsMap[name];\n        return watchMethod(fieldGetter ? () => fieldGetter(data) : () => data[name], function (value) {\n          resolvedData[name] = value;\n\n          if (missedFields.length) {\n            var index = missedFields.indexOf(name);\n\n            if (index >= 0) {\n              missedFields.splice(index, 1);\n            }\n          }\n\n          if (!missedFields.length) {\n            callback(resolvedData);\n          }\n        });\n      });\n      return function () {\n        watchHandlers.forEach(dispose => dispose());\n      };\n    }(dataWithRawFields, watchMethod, fields, fieldsMap, callback);\n  });\n\n  return function () {\n    fieldsDispose && fieldsDispose();\n    globalDispose && globalDispose();\n  };\n};\n\nexport class BindableTemplate extends TemplateBase {\n  constructor(render, fields, watchMethod, fieldsMap) {\n    super();\n    this._render = render;\n    this._fields = fields;\n    this._fieldsMap = fieldsMap || {};\n    this._watchMethod = watchMethod;\n  }\n\n  _renderCore(options) {\n    var $container = $(options.container);\n    var dispose = watchChanges(options.model, this._watchMethod, this._fields, this._fieldsMap, data => {\n      $container.empty();\n\n      this._render($container, data, options.model);\n    });\n    eventsEngine.on($container, removeEvent, dispose);\n    return $container.contents();\n  }\n\n}","map":{"version":3,"names":["$","TemplateBase","eventsEngine","removeEvent","isPrimitive","watchChanges","rawData","watchMethod","fields","fieldsMap","callback","fieldsDispose","globalDispose","data","dataWithRawFields","resolvedData","missedFields","slice","watchHandlers","map","name","fieldGetter","value","length","index","indexOf","splice","forEach","dispose","BindableTemplate","constructor","render","_render","_fields","_fieldsMap","_watchMethod","_renderCore","options","$container","container","model","empty","on","contents"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/core/templates/bindable_template.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/core/templates/bindable_template.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../renderer\";\r\nimport {\r\n    TemplateBase\r\n} from \"./template_base\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport {\r\n    removeEvent\r\n} from \"../../events/remove\";\r\nimport {\r\n    isPrimitive\r\n} from \"../utils/type\";\r\nvar watchChanges = function(rawData, watchMethod, fields, fieldsMap, callback) {\r\n    var fieldsDispose;\r\n    var globalDispose = ((data, watchMethod, callback) => watchMethod(() => data, callback))(rawData, watchMethod, (function(dataWithRawFields) {\r\n        fieldsDispose && fieldsDispose();\r\n        if (isPrimitive(dataWithRawFields)) {\r\n            callback(dataWithRawFields);\r\n            return\r\n        }\r\n        fieldsDispose = function(data, watchMethod, fields, fieldsMap, callback) {\r\n            var resolvedData = {};\r\n            var missedFields = fields.slice();\r\n            var watchHandlers = fields.map((function(name) {\r\n                var fieldGetter = fieldsMap[name];\r\n                return watchMethod(fieldGetter ? () => fieldGetter(data) : () => data[name], (function(value) {\r\n                    resolvedData[name] = value;\r\n                    if (missedFields.length) {\r\n                        var index = missedFields.indexOf(name);\r\n                        if (index >= 0) {\r\n                            missedFields.splice(index, 1)\r\n                        }\r\n                    }\r\n                    if (!missedFields.length) {\r\n                        callback(resolvedData)\r\n                    }\r\n                }))\r\n            }));\r\n            return function() {\r\n                watchHandlers.forEach(dispose => dispose())\r\n            }\r\n        }(dataWithRawFields, watchMethod, fields, fieldsMap, callback)\r\n    }));\r\n    return function() {\r\n        fieldsDispose && fieldsDispose();\r\n        globalDispose && globalDispose()\r\n    }\r\n};\r\nexport class BindableTemplate extends TemplateBase {\r\n    constructor(render, fields, watchMethod, fieldsMap) {\r\n        super();\r\n        this._render = render;\r\n        this._fields = fields;\r\n        this._fieldsMap = fieldsMap || {};\r\n        this._watchMethod = watchMethod\r\n    }\r\n    _renderCore(options) {\r\n        var $container = $(options.container);\r\n        var dispose = watchChanges(options.model, this._watchMethod, this._fields, this._fieldsMap, data => {\r\n            $container.empty();\r\n            this._render($container, data, options.model)\r\n        });\r\n        eventsEngine.on($container, removeEvent, dispose);\r\n        return $container.contents()\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}