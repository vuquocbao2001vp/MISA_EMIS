{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/grid_core/ui.grid_core.data_source_adapter.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport Callbacks from \"../../core/utils/callbacks\";\nimport gridCore from \"../data_grid/ui.data_grid.core\";\nimport { executeAsync, getKeyHash } from \"../../core/utils/common\";\nimport { isDefined, isPlainObject, isFunction } from \"../../core/utils/type\";\nimport { each } from \"../../core/utils/iterator\";\nimport { extend } from \"../../core/utils/extend\";\nimport ArrayStore from \"../../data/array_store\";\nimport { applyBatch } from \"../../data/array_utils\";\nimport { when, Deferred } from \"../../core/utils/deferred\";\nexport default gridCore.Controller.inherit(function () {\n  function cloneItems(items, groupCount) {\n    if (items) {\n      items = items.slice(0);\n\n      if (groupCount) {\n        for (var i = 0; i < items.length; i++) {\n          items[i] = extend({\n            key: items[i].key\n          }, items[i]);\n          items[i].items = cloneItems(items[i].items, groupCount - 1);\n        }\n      }\n    }\n\n    return items;\n  }\n\n  function calculateOperationTypes(loadOptions, lastLoadOptions, isFullReload) {\n    var operationTypes = {\n      reload: true,\n      fullReload: true\n    };\n\n    if (lastLoadOptions) {\n      operationTypes = {\n        sorting: !gridCore.equalSortParameters(loadOptions.sort, lastLoadOptions.sort),\n        grouping: !gridCore.equalSortParameters(loadOptions.group, lastLoadOptions.group, true),\n        groupExpanding: !gridCore.equalSortParameters(loadOptions.group, lastLoadOptions.group) || lastLoadOptions.groupExpand,\n        filtering: !gridCore.equalFilterParameters(loadOptions.filter, lastLoadOptions.filter),\n        pageIndex: loadOptions.pageIndex !== lastLoadOptions.pageIndex,\n        skip: loadOptions.skip !== lastLoadOptions.skip,\n        take: loadOptions.take !== lastLoadOptions.take,\n        pageSize: loadOptions.pageSize !== lastLoadOptions.pageSize,\n        fullReload: isFullReload\n      };\n      operationTypes.reload = isFullReload || operationTypes.sorting || operationTypes.grouping || operationTypes.filtering;\n      operationTypes.paging = operationTypes.pageIndex || operationTypes.pageSize || operationTypes.take;\n    }\n\n    return operationTypes;\n  }\n\n  function getPageDataFromCache(options, updatePaging) {\n    var groupCount = gridCore.normalizeSortingInfo(options.group || options.storeLoadOptions.group || options.loadOptions.group).length;\n    var items = [];\n\n    if (fillItemsFromCache(items, options, groupCount)) {\n      return items;\n    } else if (updatePaging) {\n      !function (cacheItemsFromBegin, options, groupCount) {\n        var cacheItemBeginCount = cacheItemsFromBegin.length;\n        var {\n          storeLoadOptions: storeLoadOptions\n        } = options;\n\n        if (void 0 !== storeLoadOptions.skip && storeLoadOptions.take && !groupCount) {\n          var cacheItemsFromEnd = [];\n          fillItemsFromCache(cacheItemsFromEnd, options, groupCount, true);\n          var cacheItemEndCount = cacheItemsFromEnd.length;\n\n          if (cacheItemBeginCount || cacheItemEndCount) {\n            var _options$skip2, _options$take2;\n\n            options.skip = null !== (_options$skip2 = options.skip) && void 0 !== _options$skip2 ? _options$skip2 : storeLoadOptions.skip;\n            options.take = null !== (_options$take2 = options.take) && void 0 !== _options$take2 ? _options$take2 : storeLoadOptions.take;\n          }\n\n          if (cacheItemBeginCount) {\n            storeLoadOptions.skip += cacheItemBeginCount;\n            storeLoadOptions.take -= cacheItemBeginCount;\n            options.cachedDataPartBegin = cacheItemsFromBegin;\n          }\n\n          if (cacheItemEndCount) {\n            storeLoadOptions.take -= cacheItemEndCount;\n            options.cachedDataPartEnd = cacheItemsFromEnd.reverse();\n          }\n        }\n      }(items, options, groupCount);\n    }\n  }\n\n  function fillItemsFromCache(items, options, groupCount, fromEnd) {\n    var _ref, _options$take, _options$cachedData;\n\n    var {\n      storeLoadOptions: storeLoadOptions\n    } = options;\n    var take = null !== (_ref = null !== (_options$take = options.take) && void 0 !== _options$take ? _options$take : storeLoadOptions.take) && void 0 !== _ref ? _ref : 0;\n    var cachedItems = null === (_options$cachedData = options.cachedData) || void 0 === _options$cachedData ? void 0 : _options$cachedData.items;\n\n    if (take && cachedItems) {\n      var _ref2, _options$skip;\n\n      var skip = null !== (_ref2 = null !== (_options$skip = options.skip) && void 0 !== _options$skip ? _options$skip : storeLoadOptions.skip) && void 0 !== _ref2 ? _ref2 : 0;\n\n      for (var i = 0; i < take; i++) {\n        var localIndex = fromEnd ? take - 1 - i : i;\n        var cacheItemIndex = localIndex + skip;\n        var cacheItem = cachedItems[cacheItemIndex];\n\n        if (void 0 === cacheItem && cacheItemIndex in cachedItems) {\n          return true;\n        }\n\n        var item = getItemFromCache(options, cacheItem, groupCount, localIndex, take);\n\n        if (item) {\n          items.push(item);\n        } else {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  }\n\n  function getItemFromCache(options, cacheItem, groupCount, index, take) {\n    if (groupCount && cacheItem) {\n      var skips = 0 === index && options.skips || [];\n      var takes = index === take - 1 && options.takes || [];\n      return function getGroupItemFromCache(cacheItem, groupCount, skips, takes) {\n        if (groupCount && cacheItem) {\n          var result = _extends({}, cacheItem);\n\n          var skip = skips[0] || 0;\n          var take = takes[0];\n          var items = cacheItem.items;\n\n          if (items) {\n            if (void 0 === take && !items[skip]) {\n              return;\n            }\n\n            result.items = [];\n\n            if (skips.length) {\n              result.isContinuation = true;\n            }\n\n            if (takes.length) {\n              result.isContinuationOnNextPage = true;\n            }\n\n            for (var i = 0; void 0 === take ? items[i + skip] : i < take; i++) {\n              var childCacheItem = items[i + skip];\n              var isLast = i + 1 === take;\n              var item = getGroupItemFromCache(childCacheItem, groupCount - 1, 0 === i ? skips.slice(1) : [], isLast ? takes.slice(1) : []);\n\n              if (void 0 !== item) {\n                result.items.push(item);\n              } else {\n                return;\n              }\n            }\n          }\n\n          return result;\n        }\n\n        return cacheItem;\n      }(cacheItem, groupCount, skips, takes);\n    } else {\n      return cacheItem;\n    }\n  }\n\n  function getCacheItem(cacheItem, loadedItem, groupCount, skips) {\n    if (groupCount && loadedItem) {\n      var result = _extends({}, loadedItem);\n\n      delete result.isContinuation;\n      delete result.isContinuationOnNextPage;\n      var skip = skips[0] || 0;\n\n      if (loadedItem.items) {\n        result.items = (null === cacheItem || void 0 === cacheItem ? void 0 : cacheItem.items) || {};\n        loadedItem.items.forEach((item, index) => {\n          var globalIndex = index + skip;\n          var childSkips = 0 === index ? skips.slice(1) : [];\n          result.items[globalIndex] = getCacheItem(result.items[globalIndex], item, groupCount - 1, childSkips);\n        });\n      }\n\n      return result;\n    }\n\n    return loadedItem;\n  }\n\n  return {\n    init: function (dataSource, remoteOperations) {\n      var that = this;\n      that._dataSource = dataSource;\n      that._remoteOperations = remoteOperations || {};\n      that._isLastPage = !dataSource.isLastPage();\n      that._hasLastPage = false;\n      that._currentTotalCount = 0;\n      that._cachedData = {\n        items: {}\n      };\n      that._lastOperationTypes = {};\n      that._eventsStrategy = dataSource._eventsStrategy;\n      that._totalCountCorrection = 0;\n      that._isLoadingAll = false;\n      that.changed = Callbacks();\n      that.loadingChanged = Callbacks();\n      that.loadError = Callbacks();\n      that.customizeStoreLoadOptions = Callbacks();\n      that.changing = Callbacks();\n      that.pushed = Callbacks();\n      that._dataChangedHandler = that._handleDataChanged.bind(that);\n      that._customizeStoreLoadOptionsHandler = that._handleCustomizeStoreLoadOptions.bind(that);\n      that._dataLoadedHandler = that._handleDataLoaded.bind(that);\n      that._loadingChangedHandler = that._handleLoadingChanged.bind(that);\n      that._loadErrorHandler = that._handleLoadError.bind(that);\n      that._pushHandler = that._handlePush.bind(that);\n      that._changingHandler = that._handleChanging.bind(that);\n      dataSource.on(\"changed\", that._dataChangedHandler);\n      dataSource.on(\"customizeStoreLoadOptions\", that._customizeStoreLoadOptionsHandler);\n      dataSource.on(\"customizeLoadResult\", that._dataLoadedHandler);\n      dataSource.on(\"loadingChanged\", that._loadingChangedHandler);\n      dataSource.on(\"loadError\", that._loadErrorHandler);\n      dataSource.on(\"changing\", that._changingHandler);\n      dataSource.store().on(\"beforePush\", that._pushHandler);\n      each(dataSource, function (memberName, member) {\n        if (!that[memberName] && isFunction(member)) {\n          that[memberName] = function () {\n            return this._dataSource[memberName].apply(this._dataSource, arguments);\n          };\n        }\n      });\n    },\n    remoteOperations: function () {\n      return this._remoteOperations;\n    },\n    dispose: function (isSharedDataSource) {\n      var dataSource = this._dataSource;\n      var store = dataSource.store();\n      dataSource.off(\"changed\", this._dataChangedHandler);\n      dataSource.off(\"customizeStoreLoadOptions\", this._customizeStoreLoadOptionsHandler);\n      dataSource.off(\"customizeLoadResult\", this._dataLoadedHandler);\n      dataSource.off(\"loadingChanged\", this._loadingChangedHandler);\n      dataSource.off(\"loadError\", this._loadErrorHandler);\n      dataSource.off(\"changing\", this._changingHandler);\n      store && store.off(\"beforePush\", this._pushHandler);\n\n      if (!isSharedDataSource) {\n        dataSource.dispose();\n      }\n    },\n    refresh: function (options, operationTypes) {\n      var dataSource = this._dataSource;\n\n      if (operationTypes.reload) {\n        this.resetCurrentTotalCount();\n        this._isLastPage = !dataSource.paginate();\n        this._hasLastPage = this._isLastPage;\n      }\n    },\n    resetCurrentTotalCount: function () {\n      this._currentTotalCount = 0;\n      this._totalCountCorrection = 0;\n    },\n    resetCache: function () {\n      this._cachedStoreData = void 0;\n      this._cachedPagingData = void 0;\n    },\n    resetPagesCache: function () {\n      this._cachedData = {\n        items: {}\n      };\n    },\n    _needClearStoreDataCache: function () {\n      var remoteOperations = this.remoteOperations();\n      var operationTypes = calculateOperationTypes(this._lastLoadOptions || {}, {});\n      var isLocalOperations = Object.keys(remoteOperations).every(operationName => !operationTypes[operationName] || !remoteOperations[operationName]);\n      return !isLocalOperations;\n    },\n    push: function (changes, fromStore) {\n      var store = this.store();\n\n      if (this._needClearStoreDataCache()) {\n        this._cachedStoreData = void 0;\n      }\n\n      this._cachedPagingData = void 0;\n      this.resetPagesCache(true);\n\n      if (this._cachedStoreData) {\n        applyBatch({\n          keyInfo: store,\n          data: this._cachedStoreData,\n          changes: changes\n        });\n      }\n\n      if (!fromStore) {\n        this._applyBatch(changes);\n      }\n\n      this.pushed.fire(changes);\n    },\n    getDataIndexGetter: function () {\n      if (!this._dataIndexGetter) {\n        var indexByKey;\n        var storeData;\n        var store = this.store();\n\n        this._dataIndexGetter = data => {\n          var isCacheUpdated = storeData && storeData !== this._cachedStoreData;\n\n          if (!indexByKey || isCacheUpdated) {\n            storeData = this._cachedStoreData || [];\n            indexByKey = {};\n\n            for (var i = 0; i < storeData.length; i++) {\n              indexByKey[getKeyHash(store.keyOf(storeData[i]))] = i;\n            }\n          }\n\n          return indexByKey[getKeyHash(store.keyOf(data))];\n        };\n      }\n\n      return this._dataIndexGetter;\n    },\n    _getKeyInfo: function () {\n      return this.store();\n    },\n    _applyBatch: function (changes) {\n      var keyInfo = this._getKeyInfo();\n\n      var dataSource = this._dataSource;\n      var groupCount = gridCore.normalizeSortingInfo(this.group()).length;\n      var totalCount = this.totalCount();\n      var isReshapeMode = \"reshape\" === this.option(\"editing.refreshMode\");\n      var isVirtualMode = \"virtual\" === this.option(\"scrolling.mode\");\n      var isLegacyMode = this.option(\"scrolling.legacyMode\");\n      changes = changes.filter(function (change) {\n        return !dataSource.paginate() || \"insert\" !== change.type || void 0 !== change.index;\n      });\n\n      var getItemCount = () => groupCount ? this.itemsCount() : this.items().length;\n\n      var oldItemCount = getItemCount();\n      applyBatch({\n        keyInfo: keyInfo,\n        data: this._items,\n        changes: changes,\n        groupCount: groupCount,\n        useInsertIndex: true\n      });\n      applyBatch({\n        keyInfo: keyInfo,\n        data: dataSource.items(),\n        changes: changes,\n        groupCount: groupCount,\n        useInsertIndex: true\n      });\n      var needUpdateTotalCountCorrection = this._currentTotalCount > 0 || !isReshapeMode && isVirtualMode && (!isLegacyMode || totalCount === oldItemCount);\n\n      if (needUpdateTotalCountCorrection) {\n        this._totalCountCorrection += getItemCount() - oldItemCount;\n      }\n\n      changes.splice(0, changes.length);\n    },\n    _handlePush: function (_ref5) {\n      var {\n        changes: changes\n      } = _ref5;\n      this.push(changes, true);\n    },\n    _handleChanging: function (e) {\n      this.changing.fire(e);\n\n      this._applyBatch(e.changes);\n    },\n    _needCleanCacheByOperation: function (operationType, remoteOperations) {\n      var operationTypesByOrder = [\"filtering\", \"sorting\", \"paging\"];\n      var operationTypeIndex = operationTypesByOrder.indexOf(operationType);\n      var currentOperationTypes = operationTypeIndex >= 0 ? operationTypesByOrder.slice(operationTypeIndex) : [operationType];\n      return currentOperationTypes.some(operationType => remoteOperations[operationType]);\n    },\n    _customizeRemoteOperations: function (options, operationTypes) {\n      var cachedStoreData = this._cachedStoreData;\n      var cachedPagingData = this._cachedPagingData;\n      var cachedData = this._cachedData;\n\n      if (options.storeLoadOptions.filter && !options.remoteOperations.filtering || options.storeLoadOptions.sort && !options.remoteOperations.sorting) {\n        options.remoteOperations = {\n          filtering: options.remoteOperations.filtering,\n          summary: options.remoteOperations.summary\n        };\n      }\n\n      if (operationTypes.fullReload) {\n        cachedStoreData = void 0;\n        cachedPagingData = void 0;\n        cachedData = {\n          items: {}\n        };\n      } else {\n        if (operationTypes.reload) {\n          cachedPagingData = void 0;\n          cachedData = {\n            items: {}\n          };\n        } else if (operationTypes.groupExpanding) {\n          cachedData = {\n            items: {}\n          };\n        }\n\n        each(operationTypes, (operationType, value) => {\n          if (value && this._needCleanCacheByOperation(operationType, options.remoteOperations)) {\n            cachedStoreData = void 0;\n            cachedPagingData = void 0;\n          }\n        });\n      }\n\n      if (cachedPagingData) {\n        options.remoteOperations.paging = false;\n      }\n\n      options.cachedStoreData = cachedStoreData;\n      options.cachedPagingData = cachedPagingData;\n      options.cachedData = cachedData;\n\n      if (!options.isCustomLoading) {\n        this._cachedStoreData = cachedStoreData;\n        this._cachedPagingData = cachedPagingData;\n        this._cachedData = cachedData;\n      }\n    },\n\n    _handleCustomizeStoreLoadOptions(options) {\n      var _options$data;\n\n      this._handleDataLoading(options);\n\n      if (!(0 === (null === (_options$data = options.data) || void 0 === _options$data ? void 0 : _options$data.length))) {\n        options.data = getPageDataFromCache(options, true) || options.cachedStoreData;\n      }\n    },\n\n    _handleDataLoading: function (options) {\n      var dataSource = this._dataSource;\n      var lastLoadOptions = this._lastLoadOptions;\n      this.customizeStoreLoadOptions.fire(options);\n      options.delay = this.option(\"loadingTimeout\");\n      options.originalStoreLoadOptions = options.storeLoadOptions;\n      options.remoteOperations = extend({}, this.remoteOperations());\n      var isFullReload = !this.isLoaded() && !this._isRefreshing;\n\n      if (this.option(\"integrationOptions.renderedOnServer\") && !this.isLoaded()) {\n        options.delay = void 0;\n      }\n\n      var loadOptions = extend({\n        pageIndex: this.pageIndex(),\n        pageSize: this.pageSize()\n      }, options.storeLoadOptions);\n      var operationTypes = calculateOperationTypes(loadOptions, lastLoadOptions, isFullReload);\n\n      this._customizeRemoteOperations(options, operationTypes);\n\n      if (!options.isCustomLoading) {\n        var isRefreshing = this._isRefreshing;\n        options.pageIndex = dataSource.pageIndex();\n        options.lastLoadOptions = loadOptions;\n        options.operationTypes = operationTypes;\n        this._loadingOperationTypes = operationTypes;\n        this._isRefreshing = true;\n        when(isRefreshing || this._isRefreshed || this.refresh(options, operationTypes)).done(() => {\n          if (this._lastOperationId === options.operationId) {\n            this._isRefreshed = true;\n            this.load().always(() => {\n              this._isRefreshed = false;\n            });\n          }\n        }).fail(() => {\n          dataSource.cancel(options.operationId);\n        }).always(() => {\n          this._isRefreshing = false;\n        });\n        dataSource.cancel(this._lastOperationId);\n        this._lastOperationId = options.operationId;\n\n        if (this._isRefreshing) {\n          dataSource.cancel(this._lastOperationId);\n        }\n      }\n\n      this._handleDataLoadingCore(options);\n    },\n    _handleDataLoadingCore: function (options) {\n      var remoteOperations = options.remoteOperations;\n      options.loadOptions = {};\n      var cachedExtra = options.cachedData.extra;\n      var localLoadOptionNames = {\n        filter: !remoteOperations.filtering,\n        sort: !remoteOperations.sorting,\n        group: !remoteOperations.grouping,\n        summary: !remoteOperations.summary,\n        skip: !remoteOperations.paging,\n        take: !remoteOperations.paging,\n        requireTotalCount: cachedExtra && \"totalCount\" in cachedExtra || !remoteOperations.paging\n      };\n      each(options.storeLoadOptions, function (optionName, optionValue) {\n        if (localLoadOptionNames[optionName]) {\n          options.loadOptions[optionName] = optionValue;\n          delete options.storeLoadOptions[optionName];\n        }\n      });\n\n      if (cachedExtra) {\n        options.extra = cachedExtra;\n      }\n    },\n    _handleDataLoaded: function (options) {\n      var loadOptions = options.loadOptions;\n      var localPaging = options.remoteOperations && !options.remoteOperations.paging;\n      var cachedData = options.cachedData;\n      var storeLoadOptions = options.storeLoadOptions;\n      var needCache = false !== this.option(\"cacheEnabled\") && storeLoadOptions;\n      var needPageCache = needCache && !options.isCustomLoading && cachedData && (!localPaging || storeLoadOptions.group);\n      var needPagingCache = needCache && localPaging;\n      var needStoreCache = needPagingCache && !options.isCustomLoading;\n\n      if (!loadOptions) {\n        this._dataSource.cancel(options.operationId);\n\n        return;\n      }\n\n      if (localPaging) {\n        options.skip = loadOptions.skip;\n        options.take = loadOptions.take;\n        delete loadOptions.skip;\n        delete loadOptions.take;\n      }\n\n      if (loadOptions.group) {\n        loadOptions.group = options.group || loadOptions.group;\n      }\n\n      var groupCount = gridCore.normalizeSortingInfo(options.group || storeLoadOptions.group || loadOptions.group).length;\n\n      if (options.cachedDataPartBegin) {\n        options.data = options.cachedDataPartBegin.concat(options.data);\n      }\n\n      if (options.cachedDataPartEnd) {\n        options.data = options.data.concat(options.cachedDataPartEnd);\n      }\n\n      if (!needPageCache || !getPageDataFromCache(options)) {\n        if (needPagingCache && options.cachedPagingData) {\n          options.data = cloneItems(options.cachedPagingData, groupCount);\n        } else {\n          if (needStoreCache) {\n            if (!this._cachedStoreData) {\n              this._cachedStoreData = cloneItems(options.data, gridCore.normalizeSortingInfo(storeLoadOptions.group).length);\n            } else if (options.mergeStoreLoadData) {\n              options.data = this._cachedStoreData = this._cachedStoreData.concat(options.data);\n            }\n          }\n\n          new ArrayStore(options.data).load(loadOptions).done(data => {\n            options.data = data;\n\n            if (needStoreCache) {\n              this._cachedPagingData = cloneItems(options.data, groupCount);\n            }\n          }).fail(error => {\n            options.data = new Deferred().reject(error);\n          });\n        }\n\n        if (loadOptions.requireTotalCount && localPaging) {\n          options.extra = isPlainObject(options.extra) ? options.extra : {};\n          options.extra.totalCount = options.data.length;\n        }\n\n        if (options.extra && options.extra.totalCount >= 0 && (false === storeLoadOptions.requireTotalCount || false === loadOptions.requireTotalCount)) {\n          options.extra.totalCount = -1;\n        }\n\n        this._handleDataLoadedCore(options);\n\n        if (needPageCache) {\n          cachedData.extra = cachedData.extra || extend({}, options.extra);\n          when(options.data).done(data => {\n            !function (options, data, groupCount) {\n              var _ref3, _options$skip3, _ref4, _options$take3;\n\n              var {\n                storeLoadOptions: storeLoadOptions\n              } = options;\n              var skip = null !== (_ref3 = null !== (_options$skip3 = options.skip) && void 0 !== _options$skip3 ? _options$skip3 : storeLoadOptions.skip) && void 0 !== _ref3 ? _ref3 : 0;\n              var take = null !== (_ref4 = null !== (_options$take3 = options.take) && void 0 !== _options$take3 ? _options$take3 : storeLoadOptions.take) && void 0 !== _ref4 ? _ref4 : 0;\n\n              for (var i = 0; i < take; i++) {\n                var globalIndex = i + skip;\n                var cacheItems = options.cachedData.items;\n                var skips = 0 === i && options.skips || [];\n                cacheItems[globalIndex] = getCacheItem(cacheItems[globalIndex], data[i], groupCount, skips);\n              }\n            }(options, data, groupCount);\n          });\n        }\n      }\n\n      when(options.data).done(() => {\n        if (options.lastLoadOptions) {\n          this._lastLoadOptions = options.lastLoadOptions;\n          Object.keys(options.operationTypes).forEach(operationType => {\n            this._lastOperationTypes[operationType] = this._lastOperationTypes[operationType] || options.operationTypes[operationType];\n          });\n        }\n      });\n      options.storeLoadOptions = options.originalStoreLoadOptions;\n    },\n    _handleDataLoadedCore: function (options) {\n      if (options.remoteOperations && !options.remoteOperations.paging && Array.isArray(options.data)) {\n        if (void 0 !== options.skip) {\n          options.data = options.data.slice(options.skip);\n        }\n\n        if (void 0 !== options.take) {\n          options.data = options.data.slice(0, options.take);\n        }\n      }\n    },\n    _handleLoadingChanged: function (isLoading) {\n      this.loadingChanged.fire(isLoading);\n    },\n    _handleLoadError: function (error) {\n      this.loadError.fire(error);\n      this.changed.fire({\n        changeType: \"loadError\",\n        error: error\n      });\n    },\n    _loadPageSize: function () {\n      return this.pageSize();\n    },\n    _handleDataChanged: function (args) {\n      var currentTotalCount;\n      var dataSource = this._dataSource;\n      var isLoading = false;\n      var isDataLoading = !args || isDefined(args.changeType);\n      var itemsCount = this.itemsCount();\n\n      if (isDataLoading) {\n        this._isLastPage = !itemsCount || !this._loadPageSize() || itemsCount < this._loadPageSize();\n\n        if (this._isLastPage) {\n          this._hasLastPage = true;\n        }\n      }\n\n      if (dataSource.totalCount() >= 0) {\n        if (dataSource.pageIndex() >= this.pageCount()) {\n          dataSource.pageIndex(this.pageCount() - 1);\n          this.pageIndex(dataSource.pageIndex());\n          this.resetPagesCache();\n          dataSource.load();\n          isLoading = true;\n        }\n      } else if (isDataLoading) {\n        currentTotalCount = dataSource.pageIndex() * this.pageSize() + itemsCount;\n\n        if (currentTotalCount > this._currentTotalCount) {\n          this._currentTotalCount = currentTotalCount;\n\n          if (0 === dataSource.pageIndex() || !this.option(\"scrolling.legacyMode\")) {\n            this._totalCountCorrection = 0;\n          }\n        }\n\n        if (0 === itemsCount && dataSource.pageIndex() >= this.pageCount()) {\n          dataSource.pageIndex(this.pageCount() - 1);\n\n          if (\"infinite\" !== this.option(\"scrolling.mode\")) {\n            dataSource.load();\n            isLoading = true;\n          }\n        }\n      }\n\n      if (!isLoading) {\n        this._operationTypes = this._lastOperationTypes;\n        this._lastOperationTypes = {};\n        this.component._optionCache = {};\n        this.changed.fire(args);\n        this.component._optionCache = void 0;\n      }\n    },\n    _scheduleCustomLoadCallbacks: function (deferred) {\n      var that = this;\n      that._isCustomLoading = true;\n      deferred.always(function () {\n        that._isCustomLoading = false;\n      });\n    },\n    loadingOperationTypes: function () {\n      return this._loadingOperationTypes;\n    },\n    operationTypes: function () {\n      return this._operationTypes;\n    },\n    lastLoadOptions: function () {\n      return this._lastLoadOptions || {};\n    },\n    isLastPage: function () {\n      return this._isLastPage;\n    },\n    _dataSourceTotalCount: function () {\n      return this._dataSource.totalCount();\n    },\n    totalCount: function () {\n      return parseInt((this._currentTotalCount || this._dataSourceTotalCount()) + this._totalCountCorrection);\n    },\n    totalCountCorrection: function () {\n      return this._totalCountCorrection;\n    },\n    itemsCount: function () {\n      return this._dataSource.items().length;\n    },\n    totalItemsCount: function () {\n      return this.totalCount();\n    },\n    pageSize: function () {\n      var dataSource = this._dataSource;\n\n      if (!arguments.length && !dataSource.paginate()) {\n        return 0;\n      }\n\n      return dataSource.pageSize.apply(dataSource, arguments);\n    },\n    pageCount: function () {\n      var count = this.totalItemsCount() - this._totalCountCorrection;\n\n      var pageSize = this.pageSize();\n\n      if (pageSize && count > 0) {\n        return Math.max(1, Math.ceil(count / pageSize));\n      }\n\n      return 1;\n    },\n    hasKnownLastPage: function () {\n      return this._hasLastPage || this._dataSource.totalCount() >= 0;\n    },\n    loadFromStore: function (loadOptions, store) {\n      var dataSource = this._dataSource;\n      var d = new Deferred();\n\n      if (!dataSource) {\n        return;\n      }\n\n      store = store || dataSource.store();\n      store.load(loadOptions).done(function (data, extra) {\n        if (data && !Array.isArray(data) && Array.isArray(data.data)) {\n          extra = data;\n          data = data.data;\n        }\n\n        d.resolve(data, extra);\n      }).fail(d.reject);\n      return d;\n    },\n    isCustomLoading: function () {\n      return !!this._isCustomLoading;\n    },\n    load: function (options) {\n      var that = this;\n      var dataSource = that._dataSource;\n      var d = new Deferred();\n\n      if (options) {\n        var store = dataSource.store();\n        var dataSourceLoadOptions = dataSource.loadOptions();\n        var loadResult = {\n          storeLoadOptions: options,\n          isCustomLoading: true\n        };\n        each(store._customLoadOptions() || [], function (_, optionName) {\n          if (!(optionName in loadResult.storeLoadOptions)) {\n            loadResult.storeLoadOptions[optionName] = dataSourceLoadOptions[optionName];\n          }\n        });\n        this._isLoadingAll = options.isLoadingAll;\n\n        that._scheduleCustomLoadCallbacks(d);\n\n        dataSource._scheduleLoadCallbacks(d);\n\n        that._handleCustomizeStoreLoadOptions(loadResult);\n\n        !function (action, timeout) {\n          if (isDefined(timeout)) {\n            executeAsync(action, timeout);\n          } else {\n            action();\n          }\n        }(function () {\n          if (!dataSource.store()) {\n            return d.reject(\"canceled\");\n          }\n\n          when(loadResult.data || that.loadFromStore(loadResult.storeLoadOptions)).done(function (data, extra) {\n            loadResult.data = data;\n            loadResult.extra = extra || {};\n\n            that._handleDataLoaded(loadResult);\n\n            if (options.requireTotalCount && void 0 === loadResult.extra.totalCount) {\n              loadResult.extra.totalCount = store.totalCount(loadResult.storeLoadOptions);\n            }\n\n            when(loadResult.data, loadResult.extra.totalCount).done(function (data, totalCount) {\n              loadResult.extra.totalCount = totalCount;\n              d.resolve(data, loadResult.extra);\n            }).fail(d.reject);\n          }).fail(d.reject);\n        }, that.option(\"loadingTimeout\"));\n        return d.fail(function () {\n          that._eventsStrategy.fireEvent(\"loadError\", arguments);\n        }).always(() => {\n          this._isLoadingAll = false;\n        }).promise();\n      } else {\n        return dataSource.load();\n      }\n    },\n    reload: function (full) {\n      return full ? this._dataSource.reload() : this._dataSource.load();\n    },\n    getCachedStoreData: function () {\n      return this._cachedStoreData;\n    }\n  };\n}());","map":{"version":3,"names":["_extends","Callbacks","gridCore","executeAsync","getKeyHash","isDefined","isPlainObject","isFunction","each","extend","ArrayStore","applyBatch","when","Deferred","Controller","inherit","cloneItems","items","groupCount","slice","i","length","key","calculateOperationTypes","loadOptions","lastLoadOptions","isFullReload","operationTypes","reload","fullReload","sorting","equalSortParameters","sort","grouping","group","groupExpanding","groupExpand","filtering","equalFilterParameters","filter","pageIndex","skip","take","pageSize","paging","getPageDataFromCache","options","updatePaging","normalizeSortingInfo","storeLoadOptions","fillItemsFromCache","cacheItemsFromBegin","cacheItemBeginCount","cacheItemsFromEnd","cacheItemEndCount","_options$skip2","_options$take2","cachedDataPartBegin","cachedDataPartEnd","reverse","fromEnd","_ref","_options$take","_options$cachedData","cachedItems","cachedData","_ref2","_options$skip","localIndex","cacheItemIndex","cacheItem","item","getItemFromCache","push","index","skips","takes","getGroupItemFromCache","result","isContinuation","isContinuationOnNextPage","childCacheItem","isLast","getCacheItem","loadedItem","forEach","globalIndex","childSkips","init","dataSource","remoteOperations","that","_dataSource","_remoteOperations","_isLastPage","isLastPage","_hasLastPage","_currentTotalCount","_cachedData","_lastOperationTypes","_eventsStrategy","_totalCountCorrection","_isLoadingAll","changed","loadingChanged","loadError","customizeStoreLoadOptions","changing","pushed","_dataChangedHandler","_handleDataChanged","bind","_customizeStoreLoadOptionsHandler","_handleCustomizeStoreLoadOptions","_dataLoadedHandler","_handleDataLoaded","_loadingChangedHandler","_handleLoadingChanged","_loadErrorHandler","_handleLoadError","_pushHandler","_handlePush","_changingHandler","_handleChanging","on","store","memberName","member","apply","arguments","dispose","isSharedDataSource","off","refresh","resetCurrentTotalCount","paginate","resetCache","_cachedStoreData","_cachedPagingData","resetPagesCache","_needClearStoreDataCache","_lastLoadOptions","isLocalOperations","Object","keys","every","operationName","changes","fromStore","keyInfo","data","_applyBatch","fire","getDataIndexGetter","_dataIndexGetter","indexByKey","storeData","isCacheUpdated","keyOf","_getKeyInfo","totalCount","isReshapeMode","option","isVirtualMode","isLegacyMode","change","type","getItemCount","itemsCount","oldItemCount","_items","useInsertIndex","needUpdateTotalCountCorrection","splice","_ref5","e","_needCleanCacheByOperation","operationType","operationTypesByOrder","operationTypeIndex","indexOf","currentOperationTypes","some","_customizeRemoteOperations","cachedStoreData","cachedPagingData","summary","value","isCustomLoading","_options$data","_handleDataLoading","delay","originalStoreLoadOptions","isLoaded","_isRefreshing","isRefreshing","_loadingOperationTypes","_isRefreshed","done","_lastOperationId","operationId","load","always","fail","cancel","_handleDataLoadingCore","cachedExtra","extra","localLoadOptionNames","requireTotalCount","optionName","optionValue","localPaging","needCache","needPageCache","needPagingCache","needStoreCache","concat","mergeStoreLoadData","error","reject","_handleDataLoadedCore","_ref3","_options$skip3","_ref4","_options$take3","cacheItems","Array","isArray","isLoading","changeType","_loadPageSize","args","currentTotalCount","isDataLoading","pageCount","_operationTypes","component","_optionCache","_scheduleCustomLoadCallbacks","deferred","_isCustomLoading","loadingOperationTypes","_dataSourceTotalCount","parseInt","totalCountCorrection","totalItemsCount","count","Math","max","ceil","hasKnownLastPage","loadFromStore","d","resolve","dataSourceLoadOptions","loadResult","_customLoadOptions","_","isLoadingAll","_scheduleLoadCallbacks","action","timeout","fireEvent","promise","full","getCachedStoreData"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/ui/grid_core/ui.grid_core.data_source_adapter.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/grid_core/ui.grid_core.data_source_adapter.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport Callbacks from \"../../core/utils/callbacks\";\r\nimport gridCore from \"../data_grid/ui.data_grid.core\";\r\nimport {\r\n    executeAsync,\r\n    getKeyHash\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    isDefined,\r\n    isPlainObject,\r\n    isFunction\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport ArrayStore from \"../../data/array_store\";\r\nimport {\r\n    applyBatch\r\n} from \"../../data/array_utils\";\r\nimport {\r\n    when,\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nexport default gridCore.Controller.inherit(function() {\r\n    function cloneItems(items, groupCount) {\r\n        if (items) {\r\n            items = items.slice(0);\r\n            if (groupCount) {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    items[i] = extend({\r\n                        key: items[i].key\r\n                    }, items[i]);\r\n                    items[i].items = cloneItems(items[i].items, groupCount - 1)\r\n                }\r\n            }\r\n        }\r\n        return items\r\n    }\r\n\r\n    function calculateOperationTypes(loadOptions, lastLoadOptions, isFullReload) {\r\n        var operationTypes = {\r\n            reload: true,\r\n            fullReload: true\r\n        };\r\n        if (lastLoadOptions) {\r\n            operationTypes = {\r\n                sorting: !gridCore.equalSortParameters(loadOptions.sort, lastLoadOptions.sort),\r\n                grouping: !gridCore.equalSortParameters(loadOptions.group, lastLoadOptions.group, true),\r\n                groupExpanding: !gridCore.equalSortParameters(loadOptions.group, lastLoadOptions.group) || lastLoadOptions.groupExpand,\r\n                filtering: !gridCore.equalFilterParameters(loadOptions.filter, lastLoadOptions.filter),\r\n                pageIndex: loadOptions.pageIndex !== lastLoadOptions.pageIndex,\r\n                skip: loadOptions.skip !== lastLoadOptions.skip,\r\n                take: loadOptions.take !== lastLoadOptions.take,\r\n                pageSize: loadOptions.pageSize !== lastLoadOptions.pageSize,\r\n                fullReload: isFullReload\r\n            };\r\n            operationTypes.reload = isFullReload || operationTypes.sorting || operationTypes.grouping || operationTypes.filtering;\r\n            operationTypes.paging = operationTypes.pageIndex || operationTypes.pageSize || operationTypes.take\r\n        }\r\n        return operationTypes\r\n    }\r\n\r\n    function getPageDataFromCache(options, updatePaging) {\r\n        var groupCount = gridCore.normalizeSortingInfo(options.group || options.storeLoadOptions.group || options.loadOptions.group).length;\r\n        var items = [];\r\n        if (fillItemsFromCache(items, options, groupCount)) {\r\n            return items\r\n        } else if (updatePaging) {\r\n            ! function(cacheItemsFromBegin, options, groupCount) {\r\n                var cacheItemBeginCount = cacheItemsFromBegin.length;\r\n                var {\r\n                    storeLoadOptions: storeLoadOptions\r\n                } = options;\r\n                if (void 0 !== storeLoadOptions.skip && storeLoadOptions.take && !groupCount) {\r\n                    var cacheItemsFromEnd = [];\r\n                    fillItemsFromCache(cacheItemsFromEnd, options, groupCount, true);\r\n                    var cacheItemEndCount = cacheItemsFromEnd.length;\r\n                    if (cacheItemBeginCount || cacheItemEndCount) {\r\n                        var _options$skip2, _options$take2;\r\n                        options.skip = null !== (_options$skip2 = options.skip) && void 0 !== _options$skip2 ? _options$skip2 : storeLoadOptions.skip;\r\n                        options.take = null !== (_options$take2 = options.take) && void 0 !== _options$take2 ? _options$take2 : storeLoadOptions.take\r\n                    }\r\n                    if (cacheItemBeginCount) {\r\n                        storeLoadOptions.skip += cacheItemBeginCount;\r\n                        storeLoadOptions.take -= cacheItemBeginCount;\r\n                        options.cachedDataPartBegin = cacheItemsFromBegin\r\n                    }\r\n                    if (cacheItemEndCount) {\r\n                        storeLoadOptions.take -= cacheItemEndCount;\r\n                        options.cachedDataPartEnd = cacheItemsFromEnd.reverse()\r\n                    }\r\n                }\r\n            }(items, options, groupCount)\r\n        }\r\n    }\r\n\r\n    function fillItemsFromCache(items, options, groupCount, fromEnd) {\r\n        var _ref, _options$take, _options$cachedData;\r\n        var {\r\n            storeLoadOptions: storeLoadOptions\r\n        } = options;\r\n        var take = null !== (_ref = null !== (_options$take = options.take) && void 0 !== _options$take ? _options$take : storeLoadOptions.take) && void 0 !== _ref ? _ref : 0;\r\n        var cachedItems = null === (_options$cachedData = options.cachedData) || void 0 === _options$cachedData ? void 0 : _options$cachedData.items;\r\n        if (take && cachedItems) {\r\n            var _ref2, _options$skip;\r\n            var skip = null !== (_ref2 = null !== (_options$skip = options.skip) && void 0 !== _options$skip ? _options$skip : storeLoadOptions.skip) && void 0 !== _ref2 ? _ref2 : 0;\r\n            for (var i = 0; i < take; i++) {\r\n                var localIndex = fromEnd ? take - 1 - i : i;\r\n                var cacheItemIndex = localIndex + skip;\r\n                var cacheItem = cachedItems[cacheItemIndex];\r\n                if (void 0 === cacheItem && cacheItemIndex in cachedItems) {\r\n                    return true\r\n                }\r\n                var item = getItemFromCache(options, cacheItem, groupCount, localIndex, take);\r\n                if (item) {\r\n                    items.push(item)\r\n                } else {\r\n                    return false\r\n                }\r\n            }\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n\r\n    function getItemFromCache(options, cacheItem, groupCount, index, take) {\r\n        if (groupCount && cacheItem) {\r\n            var skips = 0 === index && options.skips || [];\r\n            var takes = index === take - 1 && options.takes || [];\r\n            return function getGroupItemFromCache(cacheItem, groupCount, skips, takes) {\r\n                if (groupCount && cacheItem) {\r\n                    var result = _extends({}, cacheItem);\r\n                    var skip = skips[0] || 0;\r\n                    var take = takes[0];\r\n                    var items = cacheItem.items;\r\n                    if (items) {\r\n                        if (void 0 === take && !items[skip]) {\r\n                            return\r\n                        }\r\n                        result.items = [];\r\n                        if (skips.length) {\r\n                            result.isContinuation = true\r\n                        }\r\n                        if (takes.length) {\r\n                            result.isContinuationOnNextPage = true\r\n                        }\r\n                        for (var i = 0; void 0 === take ? items[i + skip] : i < take; i++) {\r\n                            var childCacheItem = items[i + skip];\r\n                            var isLast = i + 1 === take;\r\n                            var item = getGroupItemFromCache(childCacheItem, groupCount - 1, 0 === i ? skips.slice(1) : [], isLast ? takes.slice(1) : []);\r\n                            if (void 0 !== item) {\r\n                                result.items.push(item)\r\n                            } else {\r\n                                return\r\n                            }\r\n                        }\r\n                    }\r\n                    return result\r\n                }\r\n                return cacheItem\r\n            }(cacheItem, groupCount, skips, takes)\r\n        } else {\r\n            return cacheItem\r\n        }\r\n    }\r\n\r\n    function getCacheItem(cacheItem, loadedItem, groupCount, skips) {\r\n        if (groupCount && loadedItem) {\r\n            var result = _extends({}, loadedItem);\r\n            delete result.isContinuation;\r\n            delete result.isContinuationOnNextPage;\r\n            var skip = skips[0] || 0;\r\n            if (loadedItem.items) {\r\n                result.items = (null === cacheItem || void 0 === cacheItem ? void 0 : cacheItem.items) || {};\r\n                loadedItem.items.forEach((item, index) => {\r\n                    var globalIndex = index + skip;\r\n                    var childSkips = 0 === index ? skips.slice(1) : [];\r\n                    result.items[globalIndex] = getCacheItem(result.items[globalIndex], item, groupCount - 1, childSkips)\r\n                })\r\n            }\r\n            return result\r\n        }\r\n        return loadedItem\r\n    }\r\n    return {\r\n        init: function(dataSource, remoteOperations) {\r\n            var that = this;\r\n            that._dataSource = dataSource;\r\n            that._remoteOperations = remoteOperations || {};\r\n            that._isLastPage = !dataSource.isLastPage();\r\n            that._hasLastPage = false;\r\n            that._currentTotalCount = 0;\r\n            that._cachedData = {\r\n                items: {}\r\n            };\r\n            that._lastOperationTypes = {};\r\n            that._eventsStrategy = dataSource._eventsStrategy;\r\n            that._totalCountCorrection = 0;\r\n            that._isLoadingAll = false;\r\n            that.changed = Callbacks();\r\n            that.loadingChanged = Callbacks();\r\n            that.loadError = Callbacks();\r\n            that.customizeStoreLoadOptions = Callbacks();\r\n            that.changing = Callbacks();\r\n            that.pushed = Callbacks();\r\n            that._dataChangedHandler = that._handleDataChanged.bind(that);\r\n            that._customizeStoreLoadOptionsHandler = that._handleCustomizeStoreLoadOptions.bind(that);\r\n            that._dataLoadedHandler = that._handleDataLoaded.bind(that);\r\n            that._loadingChangedHandler = that._handleLoadingChanged.bind(that);\r\n            that._loadErrorHandler = that._handleLoadError.bind(that);\r\n            that._pushHandler = that._handlePush.bind(that);\r\n            that._changingHandler = that._handleChanging.bind(that);\r\n            dataSource.on(\"changed\", that._dataChangedHandler);\r\n            dataSource.on(\"customizeStoreLoadOptions\", that._customizeStoreLoadOptionsHandler);\r\n            dataSource.on(\"customizeLoadResult\", that._dataLoadedHandler);\r\n            dataSource.on(\"loadingChanged\", that._loadingChangedHandler);\r\n            dataSource.on(\"loadError\", that._loadErrorHandler);\r\n            dataSource.on(\"changing\", that._changingHandler);\r\n            dataSource.store().on(\"beforePush\", that._pushHandler);\r\n            each(dataSource, (function(memberName, member) {\r\n                if (!that[memberName] && isFunction(member)) {\r\n                    that[memberName] = function() {\r\n                        return this._dataSource[memberName].apply(this._dataSource, arguments)\r\n                    }\r\n                }\r\n            }))\r\n        },\r\n        remoteOperations: function() {\r\n            return this._remoteOperations\r\n        },\r\n        dispose: function(isSharedDataSource) {\r\n            var dataSource = this._dataSource;\r\n            var store = dataSource.store();\r\n            dataSource.off(\"changed\", this._dataChangedHandler);\r\n            dataSource.off(\"customizeStoreLoadOptions\", this._customizeStoreLoadOptionsHandler);\r\n            dataSource.off(\"customizeLoadResult\", this._dataLoadedHandler);\r\n            dataSource.off(\"loadingChanged\", this._loadingChangedHandler);\r\n            dataSource.off(\"loadError\", this._loadErrorHandler);\r\n            dataSource.off(\"changing\", this._changingHandler);\r\n            store && store.off(\"beforePush\", this._pushHandler);\r\n            if (!isSharedDataSource) {\r\n                dataSource.dispose()\r\n            }\r\n        },\r\n        refresh: function(options, operationTypes) {\r\n            var dataSource = this._dataSource;\r\n            if (operationTypes.reload) {\r\n                this.resetCurrentTotalCount();\r\n                this._isLastPage = !dataSource.paginate();\r\n                this._hasLastPage = this._isLastPage\r\n            }\r\n        },\r\n        resetCurrentTotalCount: function() {\r\n            this._currentTotalCount = 0;\r\n            this._totalCountCorrection = 0\r\n        },\r\n        resetCache: function() {\r\n            this._cachedStoreData = void 0;\r\n            this._cachedPagingData = void 0\r\n        },\r\n        resetPagesCache: function() {\r\n            this._cachedData = {\r\n                items: {}\r\n            }\r\n        },\r\n        _needClearStoreDataCache: function() {\r\n            var remoteOperations = this.remoteOperations();\r\n            var operationTypes = calculateOperationTypes(this._lastLoadOptions || {}, {});\r\n            var isLocalOperations = Object.keys(remoteOperations).every(operationName => !operationTypes[operationName] || !remoteOperations[operationName]);\r\n            return !isLocalOperations\r\n        },\r\n        push: function(changes, fromStore) {\r\n            var store = this.store();\r\n            if (this._needClearStoreDataCache()) {\r\n                this._cachedStoreData = void 0\r\n            }\r\n            this._cachedPagingData = void 0;\r\n            this.resetPagesCache(true);\r\n            if (this._cachedStoreData) {\r\n                applyBatch({\r\n                    keyInfo: store,\r\n                    data: this._cachedStoreData,\r\n                    changes: changes\r\n                })\r\n            }\r\n            if (!fromStore) {\r\n                this._applyBatch(changes)\r\n            }\r\n            this.pushed.fire(changes)\r\n        },\r\n        getDataIndexGetter: function() {\r\n            if (!this._dataIndexGetter) {\r\n                var indexByKey;\r\n                var storeData;\r\n                var store = this.store();\r\n                this._dataIndexGetter = data => {\r\n                    var isCacheUpdated = storeData && storeData !== this._cachedStoreData;\r\n                    if (!indexByKey || isCacheUpdated) {\r\n                        storeData = this._cachedStoreData || [];\r\n                        indexByKey = {};\r\n                        for (var i = 0; i < storeData.length; i++) {\r\n                            indexByKey[getKeyHash(store.keyOf(storeData[i]))] = i\r\n                        }\r\n                    }\r\n                    return indexByKey[getKeyHash(store.keyOf(data))]\r\n                }\r\n            }\r\n            return this._dataIndexGetter\r\n        },\r\n        _getKeyInfo: function() {\r\n            return this.store()\r\n        },\r\n        _applyBatch: function(changes) {\r\n            var keyInfo = this._getKeyInfo();\r\n            var dataSource = this._dataSource;\r\n            var groupCount = gridCore.normalizeSortingInfo(this.group()).length;\r\n            var totalCount = this.totalCount();\r\n            var isReshapeMode = \"reshape\" === this.option(\"editing.refreshMode\");\r\n            var isVirtualMode = \"virtual\" === this.option(\"scrolling.mode\");\r\n            var isLegacyMode = this.option(\"scrolling.legacyMode\");\r\n            changes = changes.filter((function(change) {\r\n                return !dataSource.paginate() || \"insert\" !== change.type || void 0 !== change.index\r\n            }));\r\n            var getItemCount = () => groupCount ? this.itemsCount() : this.items().length;\r\n            var oldItemCount = getItemCount();\r\n            applyBatch({\r\n                keyInfo: keyInfo,\r\n                data: this._items,\r\n                changes: changes,\r\n                groupCount: groupCount,\r\n                useInsertIndex: true\r\n            });\r\n            applyBatch({\r\n                keyInfo: keyInfo,\r\n                data: dataSource.items(),\r\n                changes: changes,\r\n                groupCount: groupCount,\r\n                useInsertIndex: true\r\n            });\r\n            var needUpdateTotalCountCorrection = this._currentTotalCount > 0 || !isReshapeMode && isVirtualMode && (!isLegacyMode || totalCount === oldItemCount);\r\n            if (needUpdateTotalCountCorrection) {\r\n                this._totalCountCorrection += getItemCount() - oldItemCount\r\n            }\r\n            changes.splice(0, changes.length)\r\n        },\r\n        _handlePush: function(_ref5) {\r\n            var {\r\n                changes: changes\r\n            } = _ref5;\r\n            this.push(changes, true)\r\n        },\r\n        _handleChanging: function(e) {\r\n            this.changing.fire(e);\r\n            this._applyBatch(e.changes)\r\n        },\r\n        _needCleanCacheByOperation: function(operationType, remoteOperations) {\r\n            var operationTypesByOrder = [\"filtering\", \"sorting\", \"paging\"];\r\n            var operationTypeIndex = operationTypesByOrder.indexOf(operationType);\r\n            var currentOperationTypes = operationTypeIndex >= 0 ? operationTypesByOrder.slice(operationTypeIndex) : [operationType];\r\n            return currentOperationTypes.some(operationType => remoteOperations[operationType])\r\n        },\r\n        _customizeRemoteOperations: function(options, operationTypes) {\r\n            var cachedStoreData = this._cachedStoreData;\r\n            var cachedPagingData = this._cachedPagingData;\r\n            var cachedData = this._cachedData;\r\n            if (options.storeLoadOptions.filter && !options.remoteOperations.filtering || options.storeLoadOptions.sort && !options.remoteOperations.sorting) {\r\n                options.remoteOperations = {\r\n                    filtering: options.remoteOperations.filtering,\r\n                    summary: options.remoteOperations.summary\r\n                }\r\n            }\r\n            if (operationTypes.fullReload) {\r\n                cachedStoreData = void 0;\r\n                cachedPagingData = void 0;\r\n                cachedData = {\r\n                    items: {}\r\n                }\r\n            } else {\r\n                if (operationTypes.reload) {\r\n                    cachedPagingData = void 0;\r\n                    cachedData = {\r\n                        items: {}\r\n                    }\r\n                } else if (operationTypes.groupExpanding) {\r\n                    cachedData = {\r\n                        items: {}\r\n                    }\r\n                }\r\n                each(operationTypes, (operationType, value) => {\r\n                    if (value && this._needCleanCacheByOperation(operationType, options.remoteOperations)) {\r\n                        cachedStoreData = void 0;\r\n                        cachedPagingData = void 0\r\n                    }\r\n                })\r\n            }\r\n            if (cachedPagingData) {\r\n                options.remoteOperations.paging = false\r\n            }\r\n            options.cachedStoreData = cachedStoreData;\r\n            options.cachedPagingData = cachedPagingData;\r\n            options.cachedData = cachedData;\r\n            if (!options.isCustomLoading) {\r\n                this._cachedStoreData = cachedStoreData;\r\n                this._cachedPagingData = cachedPagingData;\r\n                this._cachedData = cachedData\r\n            }\r\n        },\r\n        _handleCustomizeStoreLoadOptions(options) {\r\n            var _options$data;\r\n            this._handleDataLoading(options);\r\n            if (!(0 === (null === (_options$data = options.data) || void 0 === _options$data ? void 0 : _options$data.length))) {\r\n                options.data = getPageDataFromCache(options, true) || options.cachedStoreData\r\n            }\r\n        },\r\n        _handleDataLoading: function(options) {\r\n            var dataSource = this._dataSource;\r\n            var lastLoadOptions = this._lastLoadOptions;\r\n            this.customizeStoreLoadOptions.fire(options);\r\n            options.delay = this.option(\"loadingTimeout\");\r\n            options.originalStoreLoadOptions = options.storeLoadOptions;\r\n            options.remoteOperations = extend({}, this.remoteOperations());\r\n            var isFullReload = !this.isLoaded() && !this._isRefreshing;\r\n            if (this.option(\"integrationOptions.renderedOnServer\") && !this.isLoaded()) {\r\n                options.delay = void 0\r\n            }\r\n            var loadOptions = extend({\r\n                pageIndex: this.pageIndex(),\r\n                pageSize: this.pageSize()\r\n            }, options.storeLoadOptions);\r\n            var operationTypes = calculateOperationTypes(loadOptions, lastLoadOptions, isFullReload);\r\n            this._customizeRemoteOperations(options, operationTypes);\r\n            if (!options.isCustomLoading) {\r\n                var isRefreshing = this._isRefreshing;\r\n                options.pageIndex = dataSource.pageIndex();\r\n                options.lastLoadOptions = loadOptions;\r\n                options.operationTypes = operationTypes;\r\n                this._loadingOperationTypes = operationTypes;\r\n                this._isRefreshing = true;\r\n                when(isRefreshing || this._isRefreshed || this.refresh(options, operationTypes)).done(() => {\r\n                    if (this._lastOperationId === options.operationId) {\r\n                        this._isRefreshed = true;\r\n                        this.load().always(() => {\r\n                            this._isRefreshed = false\r\n                        })\r\n                    }\r\n                }).fail(() => {\r\n                    dataSource.cancel(options.operationId)\r\n                }).always(() => {\r\n                    this._isRefreshing = false\r\n                });\r\n                dataSource.cancel(this._lastOperationId);\r\n                this._lastOperationId = options.operationId;\r\n                if (this._isRefreshing) {\r\n                    dataSource.cancel(this._lastOperationId)\r\n                }\r\n            }\r\n            this._handleDataLoadingCore(options)\r\n        },\r\n        _handleDataLoadingCore: function(options) {\r\n            var remoteOperations = options.remoteOperations;\r\n            options.loadOptions = {};\r\n            var cachedExtra = options.cachedData.extra;\r\n            var localLoadOptionNames = {\r\n                filter: !remoteOperations.filtering,\r\n                sort: !remoteOperations.sorting,\r\n                group: !remoteOperations.grouping,\r\n                summary: !remoteOperations.summary,\r\n                skip: !remoteOperations.paging,\r\n                take: !remoteOperations.paging,\r\n                requireTotalCount: cachedExtra && \"totalCount\" in cachedExtra || !remoteOperations.paging\r\n            };\r\n            each(options.storeLoadOptions, (function(optionName, optionValue) {\r\n                if (localLoadOptionNames[optionName]) {\r\n                    options.loadOptions[optionName] = optionValue;\r\n                    delete options.storeLoadOptions[optionName]\r\n                }\r\n            }));\r\n            if (cachedExtra) {\r\n                options.extra = cachedExtra\r\n            }\r\n        },\r\n        _handleDataLoaded: function(options) {\r\n            var loadOptions = options.loadOptions;\r\n            var localPaging = options.remoteOperations && !options.remoteOperations.paging;\r\n            var cachedData = options.cachedData;\r\n            var storeLoadOptions = options.storeLoadOptions;\r\n            var needCache = false !== this.option(\"cacheEnabled\") && storeLoadOptions;\r\n            var needPageCache = needCache && !options.isCustomLoading && cachedData && (!localPaging || storeLoadOptions.group);\r\n            var needPagingCache = needCache && localPaging;\r\n            var needStoreCache = needPagingCache && !options.isCustomLoading;\r\n            if (!loadOptions) {\r\n                this._dataSource.cancel(options.operationId);\r\n                return\r\n            }\r\n            if (localPaging) {\r\n                options.skip = loadOptions.skip;\r\n                options.take = loadOptions.take;\r\n                delete loadOptions.skip;\r\n                delete loadOptions.take\r\n            }\r\n            if (loadOptions.group) {\r\n                loadOptions.group = options.group || loadOptions.group\r\n            }\r\n            var groupCount = gridCore.normalizeSortingInfo(options.group || storeLoadOptions.group || loadOptions.group).length;\r\n            if (options.cachedDataPartBegin) {\r\n                options.data = options.cachedDataPartBegin.concat(options.data)\r\n            }\r\n            if (options.cachedDataPartEnd) {\r\n                options.data = options.data.concat(options.cachedDataPartEnd)\r\n            }\r\n            if (!needPageCache || !getPageDataFromCache(options)) {\r\n                if (needPagingCache && options.cachedPagingData) {\r\n                    options.data = cloneItems(options.cachedPagingData, groupCount)\r\n                } else {\r\n                    if (needStoreCache) {\r\n                        if (!this._cachedStoreData) {\r\n                            this._cachedStoreData = cloneItems(options.data, gridCore.normalizeSortingInfo(storeLoadOptions.group).length)\r\n                        } else if (options.mergeStoreLoadData) {\r\n                            options.data = this._cachedStoreData = this._cachedStoreData.concat(options.data)\r\n                        }\r\n                    }\r\n                    new ArrayStore(options.data).load(loadOptions).done(data => {\r\n                        options.data = data;\r\n                        if (needStoreCache) {\r\n                            this._cachedPagingData = cloneItems(options.data, groupCount)\r\n                        }\r\n                    }).fail(error => {\r\n                        options.data = (new Deferred).reject(error)\r\n                    })\r\n                }\r\n                if (loadOptions.requireTotalCount && localPaging) {\r\n                    options.extra = isPlainObject(options.extra) ? options.extra : {};\r\n                    options.extra.totalCount = options.data.length\r\n                }\r\n                if (options.extra && options.extra.totalCount >= 0 && (false === storeLoadOptions.requireTotalCount || false === loadOptions.requireTotalCount)) {\r\n                    options.extra.totalCount = -1\r\n                }\r\n                this._handleDataLoadedCore(options);\r\n                if (needPageCache) {\r\n                    cachedData.extra = cachedData.extra || extend({}, options.extra);\r\n                    when(options.data).done(data => {\r\n                        ! function(options, data, groupCount) {\r\n                            var _ref3, _options$skip3, _ref4, _options$take3;\r\n                            var {\r\n                                storeLoadOptions: storeLoadOptions\r\n                            } = options;\r\n                            var skip = null !== (_ref3 = null !== (_options$skip3 = options.skip) && void 0 !== _options$skip3 ? _options$skip3 : storeLoadOptions.skip) && void 0 !== _ref3 ? _ref3 : 0;\r\n                            var take = null !== (_ref4 = null !== (_options$take3 = options.take) && void 0 !== _options$take3 ? _options$take3 : storeLoadOptions.take) && void 0 !== _ref4 ? _ref4 : 0;\r\n                            for (var i = 0; i < take; i++) {\r\n                                var globalIndex = i + skip;\r\n                                var cacheItems = options.cachedData.items;\r\n                                var skips = 0 === i && options.skips || [];\r\n                                cacheItems[globalIndex] = getCacheItem(cacheItems[globalIndex], data[i], groupCount, skips)\r\n                            }\r\n                        }(options, data, groupCount)\r\n                    })\r\n                }\r\n            }\r\n            when(options.data).done(() => {\r\n                if (options.lastLoadOptions) {\r\n                    this._lastLoadOptions = options.lastLoadOptions;\r\n                    Object.keys(options.operationTypes).forEach(operationType => {\r\n                        this._lastOperationTypes[operationType] = this._lastOperationTypes[operationType] || options.operationTypes[operationType]\r\n                    })\r\n                }\r\n            });\r\n            options.storeLoadOptions = options.originalStoreLoadOptions\r\n        },\r\n        _handleDataLoadedCore: function(options) {\r\n            if (options.remoteOperations && !options.remoteOperations.paging && Array.isArray(options.data)) {\r\n                if (void 0 !== options.skip) {\r\n                    options.data = options.data.slice(options.skip)\r\n                }\r\n                if (void 0 !== options.take) {\r\n                    options.data = options.data.slice(0, options.take)\r\n                }\r\n            }\r\n        },\r\n        _handleLoadingChanged: function(isLoading) {\r\n            this.loadingChanged.fire(isLoading)\r\n        },\r\n        _handleLoadError: function(error) {\r\n            this.loadError.fire(error);\r\n            this.changed.fire({\r\n                changeType: \"loadError\",\r\n                error: error\r\n            })\r\n        },\r\n        _loadPageSize: function() {\r\n            return this.pageSize()\r\n        },\r\n        _handleDataChanged: function(args) {\r\n            var currentTotalCount;\r\n            var dataSource = this._dataSource;\r\n            var isLoading = false;\r\n            var isDataLoading = !args || isDefined(args.changeType);\r\n            var itemsCount = this.itemsCount();\r\n            if (isDataLoading) {\r\n                this._isLastPage = !itemsCount || !this._loadPageSize() || itemsCount < this._loadPageSize();\r\n                if (this._isLastPage) {\r\n                    this._hasLastPage = true\r\n                }\r\n            }\r\n            if (dataSource.totalCount() >= 0) {\r\n                if (dataSource.pageIndex() >= this.pageCount()) {\r\n                    dataSource.pageIndex(this.pageCount() - 1);\r\n                    this.pageIndex(dataSource.pageIndex());\r\n                    this.resetPagesCache();\r\n                    dataSource.load();\r\n                    isLoading = true\r\n                }\r\n            } else if (isDataLoading) {\r\n                currentTotalCount = dataSource.pageIndex() * this.pageSize() + itemsCount;\r\n                if (currentTotalCount > this._currentTotalCount) {\r\n                    this._currentTotalCount = currentTotalCount;\r\n                    if (0 === dataSource.pageIndex() || !this.option(\"scrolling.legacyMode\")) {\r\n                        this._totalCountCorrection = 0\r\n                    }\r\n                }\r\n                if (0 === itemsCount && dataSource.pageIndex() >= this.pageCount()) {\r\n                    dataSource.pageIndex(this.pageCount() - 1);\r\n                    if (\"infinite\" !== this.option(\"scrolling.mode\")) {\r\n                        dataSource.load();\r\n                        isLoading = true\r\n                    }\r\n                }\r\n            }\r\n            if (!isLoading) {\r\n                this._operationTypes = this._lastOperationTypes;\r\n                this._lastOperationTypes = {};\r\n                this.component._optionCache = {};\r\n                this.changed.fire(args);\r\n                this.component._optionCache = void 0\r\n            }\r\n        },\r\n        _scheduleCustomLoadCallbacks: function(deferred) {\r\n            var that = this;\r\n            that._isCustomLoading = true;\r\n            deferred.always((function() {\r\n                that._isCustomLoading = false\r\n            }))\r\n        },\r\n        loadingOperationTypes: function() {\r\n            return this._loadingOperationTypes\r\n        },\r\n        operationTypes: function() {\r\n            return this._operationTypes\r\n        },\r\n        lastLoadOptions: function() {\r\n            return this._lastLoadOptions || {}\r\n        },\r\n        isLastPage: function() {\r\n            return this._isLastPage\r\n        },\r\n        _dataSourceTotalCount: function() {\r\n            return this._dataSource.totalCount()\r\n        },\r\n        totalCount: function() {\r\n            return parseInt((this._currentTotalCount || this._dataSourceTotalCount()) + this._totalCountCorrection)\r\n        },\r\n        totalCountCorrection: function() {\r\n            return this._totalCountCorrection\r\n        },\r\n        itemsCount: function() {\r\n            return this._dataSource.items().length\r\n        },\r\n        totalItemsCount: function() {\r\n            return this.totalCount()\r\n        },\r\n        pageSize: function() {\r\n            var dataSource = this._dataSource;\r\n            if (!arguments.length && !dataSource.paginate()) {\r\n                return 0\r\n            }\r\n            return dataSource.pageSize.apply(dataSource, arguments)\r\n        },\r\n        pageCount: function() {\r\n            var count = this.totalItemsCount() - this._totalCountCorrection;\r\n            var pageSize = this.pageSize();\r\n            if (pageSize && count > 0) {\r\n                return Math.max(1, Math.ceil(count / pageSize))\r\n            }\r\n            return 1\r\n        },\r\n        hasKnownLastPage: function() {\r\n            return this._hasLastPage || this._dataSource.totalCount() >= 0\r\n        },\r\n        loadFromStore: function(loadOptions, store) {\r\n            var dataSource = this._dataSource;\r\n            var d = new Deferred;\r\n            if (!dataSource) {\r\n                return\r\n            }\r\n            store = store || dataSource.store();\r\n            store.load(loadOptions).done((function(data, extra) {\r\n                if (data && !Array.isArray(data) && Array.isArray(data.data)) {\r\n                    extra = data;\r\n                    data = data.data\r\n                }\r\n                d.resolve(data, extra)\r\n            })).fail(d.reject);\r\n            return d\r\n        },\r\n        isCustomLoading: function() {\r\n            return !!this._isCustomLoading\r\n        },\r\n        load: function(options) {\r\n            var that = this;\r\n            var dataSource = that._dataSource;\r\n            var d = new Deferred;\r\n            if (options) {\r\n                var store = dataSource.store();\r\n                var dataSourceLoadOptions = dataSource.loadOptions();\r\n                var loadResult = {\r\n                    storeLoadOptions: options,\r\n                    isCustomLoading: true\r\n                };\r\n                each(store._customLoadOptions() || [], (function(_, optionName) {\r\n                    if (!(optionName in loadResult.storeLoadOptions)) {\r\n                        loadResult.storeLoadOptions[optionName] = dataSourceLoadOptions[optionName]\r\n                    }\r\n                }));\r\n                this._isLoadingAll = options.isLoadingAll;\r\n                that._scheduleCustomLoadCallbacks(d);\r\n                dataSource._scheduleLoadCallbacks(d);\r\n                that._handleCustomizeStoreLoadOptions(loadResult);\r\n                ! function(action, timeout) {\r\n                    if (isDefined(timeout)) {\r\n                        executeAsync(action, timeout)\r\n                    } else {\r\n                        action()\r\n                    }\r\n                }((function() {\r\n                    if (!dataSource.store()) {\r\n                        return d.reject(\"canceled\")\r\n                    }\r\n                    when(loadResult.data || that.loadFromStore(loadResult.storeLoadOptions)).done((function(data, extra) {\r\n                        loadResult.data = data;\r\n                        loadResult.extra = extra || {};\r\n                        that._handleDataLoaded(loadResult);\r\n                        if (options.requireTotalCount && void 0 === loadResult.extra.totalCount) {\r\n                            loadResult.extra.totalCount = store.totalCount(loadResult.storeLoadOptions)\r\n                        }\r\n                        when(loadResult.data, loadResult.extra.totalCount).done((function(data, totalCount) {\r\n                            loadResult.extra.totalCount = totalCount;\r\n                            d.resolve(data, loadResult.extra)\r\n                        })).fail(d.reject)\r\n                    })).fail(d.reject)\r\n                }), that.option(\"loadingTimeout\"));\r\n                return d.fail((function() {\r\n                    that._eventsStrategy.fireEvent(\"loadError\", arguments)\r\n                })).always(() => {\r\n                    this._isLoadingAll = false\r\n                }).promise()\r\n            } else {\r\n                return dataSource.load()\r\n            }\r\n        },\r\n        reload: function(full) {\r\n            return full ? this._dataSource.reload() : this._dataSource.load()\r\n        },\r\n        getCachedStoreData: function() {\r\n            return this._cachedStoreData\r\n        }\r\n    }\r\n}());\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}