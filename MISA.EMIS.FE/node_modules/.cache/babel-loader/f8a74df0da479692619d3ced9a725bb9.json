{"ast":null,"code":"import RRule, { DEFAULT_OPTIONS } from './rrule';\nimport { includes, isPresent, isArray, isNumber, toArray } from './helpers';\nimport { Weekday } from './weekday';\nimport dateutil from './dateutil';\nimport { DateWithZone } from './datewithzone';\nexport function optionsToString(options) {\n  var rrule = [];\n  var dtstart = '';\n  var keys = Object.keys(options);\n  var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n\n  for (var i = 0; i < keys.length; i++) {\n    if (keys[i] === 'tzid') continue;\n    if (!includes(defaultKeys, keys[i])) continue;\n    var key = keys[i].toUpperCase();\n    var value = options[keys[i]];\n    var outValue = '';\n    if (!isPresent(value) || isArray(value) && !value.length) continue;\n\n    switch (key) {\n      case 'FREQ':\n        outValue = RRule.FREQUENCIES[options.freq];\n        break;\n\n      case 'WKST':\n        if (isNumber(value)) {\n          outValue = new Weekday(value).toString();\n        } else {\n          outValue = value.toString();\n        }\n\n        break;\n\n      case 'BYWEEKDAY':\n        /*\n        NOTE: BYWEEKDAY is a special case.\n        RRule() deconstructs the rule.options.byweekday array\n        into an array of Weekday arguments.\n        On the other hand, rule.origOptions is an array of Weekdays.\n        We need to handle both cases here.\n        It might be worth change RRule to keep the Weekdays.\n               Also, BYWEEKDAY (used by RRule) vs. BYDAY (RFC)\n               */\n        key = 'BYDAY';\n        outValue = toArray(value).map(function (wday) {\n          if (wday instanceof Weekday) {\n            return wday;\n          }\n\n          if (isArray(wday)) {\n            return new Weekday(wday[0], wday[1]);\n          }\n\n          return new Weekday(wday);\n        }).toString();\n        break;\n\n      case 'DTSTART':\n        dtstart = buildDtstart(value, options.tzid);\n        break;\n\n      case 'UNTIL':\n        outValue = dateutil.timeToUntilString(value, !options.tzid);\n        break;\n\n      default:\n        if (isArray(value)) {\n          var strValues = [];\n\n          for (var j = 0; j < value.length; j++) {\n            strValues[j] = String(value[j]);\n          }\n\n          outValue = strValues.toString();\n        } else {\n          outValue = String(value);\n        }\n\n    }\n\n    if (outValue) {\n      rrule.push([key, outValue]);\n    }\n  }\n\n  var rules = rrule.map(function (_a) {\n    var key = _a[0],\n        value = _a[1];\n    return key + \"=\" + value.toString();\n  }).join(';');\n  var ruleString = '';\n\n  if (rules !== '') {\n    ruleString = \"RRULE:\" + rules;\n  }\n\n  return [dtstart, ruleString].filter(function (x) {\n    return !!x;\n  }).join('\\n');\n}\n\nfunction buildDtstart(dtstart, tzid) {\n  if (!dtstart) {\n    return '';\n  }\n\n  return 'DTSTART' + new DateWithZone(new Date(dtstart), tzid).toString();\n}","map":{"version":3,"mappings":"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","names":["RRule","DEFAULT_OPTIONS","includes","isPresent","isArray","isNumber","toArray","Weekday","dateutil","DateWithZone","optionsToString","options","rrule","dtstart","keys","Object","defaultKeys","i","length","key","toUpperCase","value","outValue","FREQUENCIES","freq","toString","map","wday","buildDtstart","tzid","timeToUntilString","strValues","j","String","push","rules","_a","join","ruleString","filter","x","Date"],"sourceRoot":"","sources":["../../../src/optionstostring.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}