{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/number_box/number_box.mask.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport eventsEngine from \"../../events/core/events_engine\";\nimport { extend } from \"../../core/utils/extend\";\nimport { isNumeric, isDefined, isFunction, isString } from \"../../core/utils/type\";\nimport devices from \"../../core/devices\";\nimport { fitIntoRange, inRange } from \"../../core/utils/math\";\nimport number from \"../../localization/number\";\nimport { getCaretWithOffset, isCaretInBoundaries, getCaretInBoundaries, getCaretBoundaries, getCaretAfterFormat, getCaretOffset } from \"./number_box.caret\";\nimport { getFormat as getLDMLFormat } from \"../../localization/ldml/number\";\nimport NumberBoxBase from \"./number_box.base\";\nimport { addNamespace, getChar, normalizeKeyName, isCommandKeyPressed } from \"../../events/utils/index\";\nimport { ensureDefined, escapeRegExp } from \"../../core/utils/common\";\nimport { getRealSeparatorIndex, getNthOccurrence, splitByIndex, adjustPercentValue } from \"./utils\";\nvar NUMBER_FORMATTER_NAMESPACE = \"dxNumberFormatter\";\nvar MOVE_FORWARD = 1;\nvar MOVE_BACKWARD = -1;\nvar MINUS = \"-\";\nvar MINUS_KEY = \"minus\";\nvar INPUT_EVENT = \"input\";\nvar CARET_TIMEOUT_DURATION = 0;\nvar NumberBoxMask = NumberBoxBase.inherit({\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      useMaskBehavior: true,\n      format: null\n    });\n  },\n  _isDeleteKey: function (key) {\n    return \"del\" === key;\n  },\n  _supportedKeys: function () {\n    if (!this._useMaskBehavior()) {\n      return this.callBase();\n    }\n\n    return extend(this.callBase(), {\n      minus: this._revertSign.bind(this),\n      del: this._removeHandler.bind(this),\n      backspace: this._removeHandler.bind(this),\n      leftArrow: this._arrowHandler.bind(this, MOVE_BACKWARD),\n      rightArrow: this._arrowHandler.bind(this, MOVE_FORWARD),\n      home: this._moveCaretToBoundaryEventHandler.bind(this, MOVE_FORWARD),\n      enter: this._updateFormattedValue.bind(this),\n      end: this._moveCaretToBoundaryEventHandler.bind(this, MOVE_BACKWARD)\n    });\n  },\n  _getTextSeparatorIndex: function (text) {\n    var decimalSeparator = number.getDecimalSeparator();\n    var realSeparatorOccurrenceIndex = getRealSeparatorIndex(this.option(\"format\")).occurrence;\n    return getNthOccurrence(text, decimalSeparator, realSeparatorOccurrenceIndex);\n  },\n  _focusInHandler: function (e) {\n    if (!this._preventNestedFocusEvent(e)) {\n      this.clearCaretTimeout();\n      this._caretTimeout = setTimeout(function () {\n        this._caretTimeout = void 0;\n\n        var caret = this._caret();\n\n        if (caret.start === caret.end && this._useMaskBehavior()) {\n          var text = this._getInputVal();\n\n          var decimalSeparatorIndex = this._getTextSeparatorIndex(text);\n\n          if (decimalSeparatorIndex >= 0) {\n            this._caret({\n              start: decimalSeparatorIndex,\n              end: decimalSeparatorIndex\n            });\n          } else {\n            this._moveCaretToBoundaryEventHandler(MOVE_BACKWARD, e);\n          }\n        }\n      }.bind(this), CARET_TIMEOUT_DURATION);\n    }\n\n    this.callBase(e);\n  },\n  _focusOutHandler: function (e) {\n    var shouldHandleEvent = !this._preventNestedFocusEvent(e);\n\n    if (shouldHandleEvent) {\n      this._focusOutOccurs = true;\n\n      if (this._useMaskBehavior()) {\n        this._updateFormattedValue();\n      }\n    }\n\n    this.callBase(e);\n\n    if (shouldHandleEvent) {\n      this._focusOutOccurs = false;\n    }\n  },\n\n  _hasValueBeenChanged(inputValue) {\n    var format = this._getFormatPattern();\n\n    var value = this.option(\"value\");\n    var formatted = this._format(value, format) || \"\";\n    return formatted !== inputValue;\n  },\n\n  _updateFormattedValue: function () {\n    var inputValue = this._getInputVal();\n\n    if (this._hasValueBeenChanged(inputValue)) {\n      this._updateParsedValue();\n\n      this._adjustParsedValue();\n\n      this._setTextByParsedValue();\n\n      if (this._parsedValue !== this.option(\"value\")) {\n        eventsEngine.trigger(this._input(), \"change\");\n      }\n    }\n  },\n  _arrowHandler: function (step, e) {\n    if (!this._useMaskBehavior()) {\n      return;\n    }\n\n    var text = this._getInputVal();\n\n    var format = this._getFormatPattern();\n\n    var nextCaret = getCaretWithOffset(this._caret(), step);\n\n    if (!isCaretInBoundaries(nextCaret, text, format)) {\n      nextCaret = step === MOVE_FORWARD ? nextCaret.end : nextCaret.start;\n      e.preventDefault();\n\n      this._caret(getCaretInBoundaries(nextCaret, text, format));\n    }\n  },\n  _moveCaretToBoundary: function (direction) {\n    var boundaries = getCaretBoundaries(this._getInputVal(), this._getFormatPattern());\n    var newCaret = getCaretWithOffset(direction === MOVE_FORWARD ? boundaries.start : boundaries.end, 0);\n\n    this._caret(newCaret);\n  },\n  _moveCaretToBoundaryEventHandler: function (direction, e) {\n    if (!this._useMaskBehavior() || e && e.shiftKey) {\n      return;\n    }\n\n    this._moveCaretToBoundary(direction);\n\n    e && e.preventDefault();\n  },\n  _shouldMoveCaret: function (text, caret) {\n    var decimalSeparator = number.getDecimalSeparator();\n    var isDecimalSeparatorNext = text.charAt(caret.end) === decimalSeparator;\n    var moveToFloat = (this._lastKey === decimalSeparator || \".\" === this._lastKey || \",\" === this._lastKey) && isDecimalSeparatorNext;\n    return moveToFloat;\n  },\n  _getInputVal: function () {\n    return number.convertDigits(this._input().val(), true);\n  },\n  _keyboardHandler: function (e) {\n    this.clearCaretTimeout();\n    this._lastKey = number.convertDigits(getChar(e), true);\n    this._lastKeyName = normalizeKeyName(e);\n\n    if (!this._shouldHandleKey(e.originalEvent)) {\n      return this.callBase(e);\n    }\n\n    var normalizedText = this._getInputVal();\n\n    var caret = this._caret();\n\n    var enteredChar = this._lastKeyName === MINUS_KEY ? \"\" : this._lastKey;\n\n    var newValue = this._tryParse(normalizedText, caret, enteredChar);\n\n    if (this._shouldMoveCaret(normalizedText, caret)) {\n      this._moveCaret(1);\n\n      e.originalEvent.preventDefault();\n    }\n\n    if (void 0 === newValue) {\n      if (this._lastKeyName !== MINUS_KEY) {\n        e.originalEvent.preventDefault();\n      }\n    } else {\n      this._parsedValue = newValue;\n    }\n\n    return this.callBase(e);\n  },\n  _keyPressHandler: function (e) {\n    if (!this._useMaskBehavior()) {\n      this.callBase(e);\n    }\n  },\n  _removeHandler: function (e) {\n    var caret = this._caret();\n\n    var text = this._getInputVal();\n\n    var start = caret.start;\n    var end = caret.end;\n    this._lastKey = getChar(e);\n    this._lastKeyName = normalizeKeyName(e);\n\n    var isDeleteKey = this._isDeleteKey(this._lastKeyName);\n\n    var isBackspaceKey = !isDeleteKey;\n\n    if (start === end) {\n      var caretPosition = start;\n      var canDelete = isBackspaceKey && caretPosition > 0 || isDeleteKey && caretPosition < text.length;\n\n      if (canDelete) {\n        isDeleteKey && end++;\n        isBackspaceKey && start--;\n      } else {\n        e.preventDefault();\n        return;\n      }\n    }\n\n    var char = text.slice(start, end);\n\n    if (this._isStub(char)) {\n      this._moveCaret(isDeleteKey ? 1 : -1);\n\n      if (this._parsedValue < 0 || 1 / this._parsedValue === -1 / 0) {\n        this._revertSign(e);\n\n        this._setTextByParsedValue();\n      }\n\n      e.preventDefault();\n      return;\n    }\n\n    var decimalSeparator = number.getDecimalSeparator();\n\n    if (char === decimalSeparator) {\n      var decimalSeparatorIndex = text.indexOf(decimalSeparator);\n\n      if (this._isNonStubAfter(decimalSeparatorIndex + 1)) {\n        this._moveCaret(isDeleteKey ? 1 : -1);\n\n        e.preventDefault();\n      }\n\n      return;\n    }\n\n    if (end - start < text.length) {\n      var editedText = this._replaceSelectedText(text, {\n        start: start,\n        end: end\n      }, \"\");\n\n      var noDigits = editedText.search(/[0-9]/) < 0;\n\n      if (noDigits && this._isValueInRange(0)) {\n        this._parsedValue = this._parsedValue < 0 || 1 / this._parsedValue === -1 / 0 ? -0 : 0;\n        return;\n      }\n    }\n\n    var valueAfterRemoving = this._tryParse(text, {\n      start: start,\n      end: end\n    }, \"\");\n\n    if (void 0 === valueAfterRemoving) {\n      e.preventDefault();\n    } else {\n      this._parsedValue = valueAfterRemoving;\n    }\n  },\n  _isPercentFormat: function () {\n    var format = this._getFormatPattern();\n\n    var noEscapedFormat = format.replace(/'[^']+'/g, \"\");\n    return -1 !== noEscapedFormat.indexOf(\"%\");\n  },\n  _parse: function (text, format) {\n    var formatOption = this.option(\"format\");\n    var isCustomParser = isFunction(formatOption.parser);\n    var parser = isCustomParser ? formatOption.parser : number.parse;\n    var integerPartStartIndex = 0;\n\n    if (!isCustomParser) {\n      var formatPointIndex = getRealSeparatorIndex(format).index;\n\n      var textPointIndex = this._getTextSeparatorIndex(text);\n\n      var formatIntegerPartLength = -1 !== formatPointIndex ? formatPointIndex : format.length;\n      var textIntegerPartLength = -1 !== textPointIndex ? textPointIndex : text.length;\n\n      if (textIntegerPartLength > formatIntegerPartLength && -1 === format.indexOf(\"#\")) {\n        integerPartStartIndex = textIntegerPartLength - formatIntegerPartLength;\n      }\n    }\n\n    text = text.substr(integerPartStartIndex);\n    return parser(text, format);\n  },\n  _format: function (value, format) {\n    var formatOption = this.option(\"format\");\n    var customFormatter = (null === formatOption || void 0 === formatOption ? void 0 : formatOption.formatter) || formatOption;\n    var formatter = isFunction(customFormatter) ? customFormatter : number.format;\n    var formattedValue = null === value ? \"\" : formatter(value, format);\n    return formattedValue;\n  },\n  _getFormatPattern: function () {\n    if (!this._currentFormat) {\n      this._updateFormat();\n    }\n\n    return this._currentFormat;\n  },\n  _updateFormat: function () {\n    var format = this.option(\"format\");\n    var isCustomParser = isFunction(null === format || void 0 === format ? void 0 : format.parser);\n    var isLDMLPattern = isString(format) && (format.indexOf(\"0\") >= 0 || format.indexOf(\"#\") >= 0);\n    this._currentFormat = isCustomParser || isLDMLPattern ? format : getLDMLFormat(value => {\n      var text = this._format(value, format);\n\n      return number.convertDigits(text, true);\n    });\n  },\n  _getFormatForSign: function (text) {\n    var format = this._getFormatPattern();\n\n    if (isString(format)) {\n      var signParts = format.split(\";\");\n      var sign = number.getSign(text, format);\n      signParts[1] = signParts[1] || \"-\" + signParts[0];\n      return sign < 0 ? signParts[1] : signParts[0];\n    } else {\n      var _sign = number.getSign(text);\n\n      return _sign < 0 ? \"-\" : \"\";\n    }\n  },\n  _removeStubs: function (text, excludeComma) {\n    var format = this._getFormatForSign(text);\n\n    var thousandsSeparator = number.getThousandsSeparator();\n\n    var stubs = this._getStubs(format);\n\n    var result = text;\n\n    if (stubs.length) {\n      var prefixStubs = stubs[0];\n      var postfixRegex = new RegExp(\"(\" + escapeRegExp(stubs[1] || \"\") + \")$\", \"g\");\n      var decoratorsRegex = new RegExp(\"[-\" + escapeRegExp(excludeComma ? \"\" : thousandsSeparator) + \"]\", \"g\");\n      result = result.replace(prefixStubs, \"\").replace(postfixRegex, \"\").replace(decoratorsRegex, \"\");\n    }\n\n    return result;\n  },\n  _getStubs: function (format) {\n    var regExpResult = /[^']([#0.,]+)/g.exec(format);\n    var pattern = regExpResult && regExpResult[0].trim();\n    return format.split(pattern).map(function (stub) {\n      return stub.replace(/'/g, \"\");\n    });\n  },\n  _truncateToPrecision: function (value, maxPrecision) {\n    if (isDefined(value)) {\n      var strValue = value.toString();\n      var decimalSeparatorIndex = strValue.indexOf(\".\");\n\n      if (strValue && decimalSeparatorIndex > -1) {\n        var parsedValue = parseFloat(strValue.substr(0, decimalSeparatorIndex + maxPrecision + 1));\n        return isNaN(parsedValue) ? value : parsedValue;\n      }\n    }\n\n    return value;\n  },\n  _tryParse: function (text, selection, char) {\n    var editedText = this._replaceSelectedText(text, selection, char);\n\n    var format = this._getFormatPattern();\n\n    var isTextSelected = selection.start !== selection.end;\n\n    var parsedValue = this._getParsedValue(editedText, format);\n\n    var maxPrecision = !format.parser && this._getPrecisionLimits(editedText).max;\n\n    var isValueChanged = parsedValue !== this._parsedValue;\n    var decimalSeparator = number.getDecimalSeparator();\n    var isDecimalPointRestricted = char === decimalSeparator && 0 === maxPrecision;\n\n    var isUselessCharRestricted = !isTextSelected && !isValueChanged && char !== MINUS && !this._isValueIncomplete(editedText) && this._isStub(char);\n\n    if (isDecimalPointRestricted || isUselessCharRestricted) {\n      return;\n    }\n\n    if (\"\" === this._removeStubs(editedText)) {\n      parsedValue = Math.abs(0 * this._parsedValue);\n    }\n\n    if (isNaN(parsedValue)) {\n      return;\n    }\n\n    var value = null === parsedValue ? this._parsedValue : parsedValue;\n    parsedValue = maxPrecision ? this._truncateToPrecision(value, maxPrecision) : parsedValue;\n    return !format.parser && this._isPercentFormat() ? adjustPercentValue(parsedValue, maxPrecision) : parsedValue;\n  },\n  _getParsedValue: function (text, format) {\n    var sign = number.getSign(text, (null === format || void 0 === format ? void 0 : format.formatter) || format);\n\n    var textWithoutStubs = this._removeStubs(text, true);\n\n    var parsedValue = this._parse(textWithoutStubs, format);\n\n    var parsedValueSign = parsedValue < 0 ? -1 : 1;\n    var parsedValueWithSign = isNumeric(parsedValue) && sign !== parsedValueSign ? sign * parsedValue : parsedValue;\n    return parsedValueWithSign;\n  },\n  _isValueIncomplete: function (text) {\n    if (!this._useMaskBehavior()) {\n      return this.callBase(text);\n    }\n\n    var caret = this._caret();\n\n    var point = number.getDecimalSeparator();\n\n    var pointIndex = this._getTextSeparatorIndex(text);\n\n    var isCaretOnFloat = pointIndex >= 0 && pointIndex < caret.start;\n\n    var textParts = this._removeStubs(text, true).split(point);\n\n    if (!isCaretOnFloat || 2 !== textParts.length) {\n      return false;\n    }\n\n    var floatLength = textParts[1].length;\n\n    var format = this._getFormatPattern();\n\n    var isCustomParser = !!format.parser;\n\n    var precision = !isCustomParser && this._getPrecisionLimits(this._getFormatPattern(), text);\n\n    var isPrecisionInRange = isCustomParser ? true : inRange(floatLength, precision.min, precision.max);\n    var endsWithZero = \"0\" === textParts[1].charAt(floatLength - 1);\n    return isPrecisionInRange && (endsWithZero || !floatLength);\n  },\n  _isValueInRange: function (value) {\n    var min = ensureDefined(this.option(\"min\"), -1 / 0);\n    var max = ensureDefined(this.option(\"max\"), 1 / 0);\n    return inRange(value, min, max);\n  },\n  _setInputText: function (text) {\n    var normalizedText = number.convertDigits(text, true);\n    var newCaret = getCaretAfterFormat(this._getInputVal(), normalizedText, this._caret(), this._getFormatPattern());\n\n    this._input().val(text);\n\n    this._toggleEmptinessEventHandler();\n\n    this._formattedValue = text;\n\n    if (!this._focusOutOccurs) {\n      this._caret(newCaret);\n    }\n  },\n  _useMaskBehavior: function () {\n    return !!this.option(\"format\") && this.option(\"useMaskBehavior\");\n  },\n  _renderInputType: function () {\n    var isNumberType = \"number\" === this.option(\"mode\");\n    var isDesktop = \"desktop\" === devices.real().deviceType;\n\n    if (this._useMaskBehavior() && isNumberType) {\n      this._setInputType(isDesktop || this._isSupportInputMode() ? \"text\" : \"tel\");\n    } else {\n      this.callBase();\n    }\n  },\n  _isChar: function (str) {\n    return isString(str) && 1 === str.length;\n  },\n  _moveCaret: function (offset) {\n    if (!offset) {\n      return;\n    }\n\n    var newCaret = getCaretWithOffset(this._caret(), offset);\n    var adjustedCaret = getCaretInBoundaries(newCaret, this._getInputVal(), this._getFormatPattern());\n\n    this._caret(adjustedCaret);\n  },\n  _shouldHandleKey: function (e) {\n    var keyName = normalizeKeyName(e);\n    var isSpecialChar = isCommandKeyPressed(e) || e.altKey || e.shiftKey || !this._isChar(keyName);\n    var isMinusKey = keyName === MINUS_KEY;\n\n    var useMaskBehavior = this._useMaskBehavior();\n\n    return useMaskBehavior && !isSpecialChar && !isMinusKey;\n  },\n  _renderInput: function () {\n    this.callBase();\n\n    this._renderFormatter();\n  },\n  _renderFormatter: function () {\n    this._clearCache();\n\n    this._detachFormatterEvents();\n\n    if (this._useMaskBehavior()) {\n      this._attachFormatterEvents();\n    }\n  },\n  _detachFormatterEvents: function () {\n    eventsEngine.off(this._input(), \".\" + NUMBER_FORMATTER_NAMESPACE);\n  },\n  _isInputFromPaste: function (e) {\n    var inputType = e.originalEvent && e.originalEvent.inputType;\n\n    if (isDefined(inputType)) {\n      return \"insertFromPaste\" === inputType;\n    } else {\n      return this._isValuePasted;\n    }\n  },\n  _attachFormatterEvents: function () {\n    var $input = this._input();\n\n    eventsEngine.on($input, addNamespace(INPUT_EVENT, NUMBER_FORMATTER_NAMESPACE), function (e) {\n      this._formatValue(e);\n\n      this._isValuePasted = false;\n    }.bind(this));\n    eventsEngine.on($input, addNamespace(\"dxclick\", NUMBER_FORMATTER_NAMESPACE), function () {\n      if (!this._caretTimeout) {\n        this._caretTimeout = setTimeout(function () {\n          this._caretTimeout = void 0;\n\n          this._caret(getCaretInBoundaries(this._caret(), this._getInputVal(), this._getFormatPattern()));\n        }.bind(this), CARET_TIMEOUT_DURATION);\n      }\n    }.bind(this));\n    eventsEngine.on($input, \"dxdblclick\", function () {\n      this.clearCaretTimeout();\n    }.bind(this));\n  },\n  clearCaretTimeout: function () {\n    clearTimeout(this._caretTimeout);\n    this._caretTimeout = void 0;\n  },\n  _forceRefreshInputValue: function () {\n    if (!this._useMaskBehavior()) {\n      return this.callBase();\n    }\n  },\n  _isNonStubAfter: function (index) {\n    var text = this._getInputVal().slice(index);\n\n    return text && !this._isStub(text, true);\n  },\n  _isStub: function (str, isString) {\n    var escapedDecimalSeparator = escapeRegExp(number.getDecimalSeparator());\n    var regExpString = \"^[^0-9\" + escapedDecimalSeparator + \"]+$\";\n    var stubRegExp = new RegExp(regExpString, \"g\");\n    return stubRegExp.test(str) && (isString || this._isChar(str));\n  },\n  _parseValue: function (text) {\n    if (!this._useMaskBehavior()) {\n      return this.callBase(text);\n    }\n\n    return this._parsedValue;\n  },\n  _getPrecisionLimits: function (text) {\n    var currentFormat = this._getFormatForSign(text);\n\n    var realSeparatorIndex = getRealSeparatorIndex(currentFormat).index;\n    var floatPart = (splitByIndex(currentFormat, realSeparatorIndex)[1] || \"\").replace(/[^#0]/g, \"\");\n    var minPrecision = floatPart.replace(/^(0*)#*/, \"$1\").length;\n    var maxPrecision = floatPart.length;\n    return {\n      min: minPrecision,\n      max: maxPrecision\n    };\n  },\n  _revertSign: function (e) {\n    if (!this._useMaskBehavior()) {\n      return;\n    }\n\n    var caret = this._caret();\n\n    if (caret.start !== caret.end) {\n      if (normalizeKeyName(e) === MINUS_KEY) {\n        this._applyRevertedSign(e, caret, true);\n\n        return;\n      } else {\n        this._caret(getCaretInBoundaries(0, this._getInputVal(), this._getFormatPattern()));\n      }\n    }\n\n    this._applyRevertedSign(e, caret);\n  },\n  _applyRevertedSign: function (e, caret, preserveSelectedText) {\n    var newValue = -1 * ensureDefined(this._parsedValue, null);\n\n    if (this._isValueInRange(newValue)) {\n      this._parsedValue = newValue;\n\n      if (preserveSelectedText) {\n        var format = this._getFormatPattern();\n\n        var previousText = this._getInputVal();\n\n        this._setTextByParsedValue();\n\n        e.preventDefault();\n\n        var currentText = this._getInputVal();\n\n        var offset = getCaretOffset(previousText, currentText, format);\n        caret = getCaretWithOffset(caret, offset);\n        var caretInBoundaries = getCaretInBoundaries(caret, currentText, format);\n\n        this._caret(caretInBoundaries);\n      }\n    }\n  },\n  _removeMinusFromText: function (text, caret) {\n    var isMinusPressed = this._lastKeyName === MINUS_KEY && text.charAt(caret.start - 1) === MINUS;\n    return isMinusPressed ? this._replaceSelectedText(text, {\n      start: caret.start - 1,\n      end: caret.start\n    }, \"\") : text;\n  },\n  _setTextByParsedValue: function () {\n    var format = this._getFormatPattern();\n\n    var parsed = this._parseValue();\n\n    var formatted = this._format(parsed, format) || \"\";\n\n    this._setInputText(formatted);\n  },\n  _formatValue: function (e) {\n    var normalizedText = this._getInputVal();\n\n    var caret = this._caret();\n\n    var textWithoutMinus = this._removeMinusFromText(normalizedText, caret);\n\n    var wasMinusRemoved = textWithoutMinus !== normalizedText;\n    normalizedText = textWithoutMinus;\n\n    if (!this._isInputFromPaste(e) && this._isValueIncomplete(textWithoutMinus)) {\n      this._formattedValue = normalizedText;\n\n      if (wasMinusRemoved) {\n        this._setTextByParsedValue();\n      }\n\n      return;\n    }\n\n    var textWasChanged = number.convertDigits(this._formattedValue, true) !== normalizedText;\n\n    if (textWasChanged) {\n      var value = this._tryParse(normalizedText, caret, \"\");\n\n      if (isDefined(value)) {\n        this._parsedValue = value;\n      }\n    }\n\n    this._setTextByParsedValue();\n  },\n  _renderDisplayText: function () {\n    if (this._useMaskBehavior()) {\n      this._toggleEmptinessEventHandler();\n    } else {\n      this.callBase.apply(this, arguments);\n    }\n  },\n  _renderValue: function () {\n    if (this._useMaskBehavior()) {\n      this._parsedValue = this.option(\"value\");\n\n      this._setTextByParsedValue();\n    }\n\n    return this.callBase();\n  },\n  _updateParsedValue: function () {\n    var inputValue = this._getInputVal();\n\n    this._parsedValue = this._tryParse(inputValue, this._caret());\n  },\n  _adjustParsedValue: function () {\n    if (!this._useMaskBehavior()) {\n      return;\n    }\n\n    var clearedText = this._removeStubs(this._getInputVal());\n\n    var parsedValue = clearedText ? this._parseValue() : null;\n\n    if (!isNumeric(parsedValue)) {\n      this._parsedValue = parsedValue;\n      return;\n    }\n\n    this._parsedValue = fitIntoRange(parsedValue, this.option(\"min\"), this.option(\"max\"));\n  },\n  _valueChangeEventHandler: function (e) {\n    if (!this._useMaskBehavior()) {\n      return this.callBase(e);\n    }\n\n    var caret = this._caret();\n\n    this._saveValueChangeEvent(e);\n\n    this._lastKey = null;\n    this._lastKeyName = null;\n\n    this._updateParsedValue();\n\n    this._adjustParsedValue();\n\n    this.option(\"value\", this._parsedValue);\n\n    if (caret) {\n      this._caret(caret);\n    }\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"format\":\n      case \"useMaskBehavior\":\n        this._renderInputType();\n\n        this._updateFormat();\n\n        this._renderFormatter();\n\n        this._renderValue();\n\n        this._refreshValueChangeEvent();\n\n        this._refreshEvents();\n\n        break;\n\n      case \"min\":\n      case \"max\":\n        this._adjustParsedValue();\n\n        this.callBase(args);\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _clearCache: function () {\n    delete this._formattedValue;\n    delete this._lastKey;\n    delete this._lastKeyName;\n    delete this._parsedValue;\n    delete this._focusOutOccurs;\n    clearTimeout(this._caretTimeout);\n    delete this._caretTimeout;\n  },\n  _clean: function () {\n    this._clearCache();\n\n    this.callBase();\n  }\n});\nexport default NumberBoxMask;","map":{"version":3,"names":["eventsEngine","extend","isNumeric","isDefined","isFunction","isString","devices","fitIntoRange","inRange","number","getCaretWithOffset","isCaretInBoundaries","getCaretInBoundaries","getCaretBoundaries","getCaretAfterFormat","getCaretOffset","getFormat","getLDMLFormat","NumberBoxBase","addNamespace","getChar","normalizeKeyName","isCommandKeyPressed","ensureDefined","escapeRegExp","getRealSeparatorIndex","getNthOccurrence","splitByIndex","adjustPercentValue","NUMBER_FORMATTER_NAMESPACE","MOVE_FORWARD","MOVE_BACKWARD","MINUS","MINUS_KEY","INPUT_EVENT","CARET_TIMEOUT_DURATION","NumberBoxMask","inherit","_getDefaultOptions","callBase","useMaskBehavior","format","_isDeleteKey","key","_supportedKeys","_useMaskBehavior","minus","_revertSign","bind","del","_removeHandler","backspace","leftArrow","_arrowHandler","rightArrow","home","_moveCaretToBoundaryEventHandler","enter","_updateFormattedValue","end","_getTextSeparatorIndex","text","decimalSeparator","getDecimalSeparator","realSeparatorOccurrenceIndex","option","occurrence","_focusInHandler","e","_preventNestedFocusEvent","clearCaretTimeout","_caretTimeout","setTimeout","caret","_caret","start","_getInputVal","decimalSeparatorIndex","_focusOutHandler","shouldHandleEvent","_focusOutOccurs","_hasValueBeenChanged","inputValue","_getFormatPattern","value","formatted","_format","_updateParsedValue","_adjustParsedValue","_setTextByParsedValue","_parsedValue","trigger","_input","step","nextCaret","preventDefault","_moveCaretToBoundary","direction","boundaries","newCaret","shiftKey","_shouldMoveCaret","isDecimalSeparatorNext","charAt","moveToFloat","_lastKey","convertDigits","val","_keyboardHandler","_lastKeyName","_shouldHandleKey","originalEvent","normalizedText","enteredChar","newValue","_tryParse","_moveCaret","_keyPressHandler","isDeleteKey","isBackspaceKey","caretPosition","canDelete","length","char","slice","_isStub","indexOf","_isNonStubAfter","editedText","_replaceSelectedText","noDigits","search","_isValueInRange","valueAfterRemoving","_isPercentFormat","noEscapedFormat","replace","_parse","formatOption","isCustomParser","parser","parse","integerPartStartIndex","formatPointIndex","index","textPointIndex","formatIntegerPartLength","textIntegerPartLength","substr","customFormatter","formatter","formattedValue","_currentFormat","_updateFormat","isLDMLPattern","_getFormatForSign","signParts","split","sign","getSign","_sign","_removeStubs","excludeComma","thousandsSeparator","getThousandsSeparator","stubs","_getStubs","result","prefixStubs","postfixRegex","RegExp","decoratorsRegex","regExpResult","exec","pattern","trim","map","stub","_truncateToPrecision","maxPrecision","strValue","toString","parsedValue","parseFloat","isNaN","selection","isTextSelected","_getParsedValue","_getPrecisionLimits","max","isValueChanged","isDecimalPointRestricted","isUselessCharRestricted","_isValueIncomplete","Math","abs","textWithoutStubs","parsedValueSign","parsedValueWithSign","point","pointIndex","isCaretOnFloat","textParts","floatLength","precision","isPrecisionInRange","min","endsWithZero","_setInputText","_toggleEmptinessEventHandler","_formattedValue","_renderInputType","isNumberType","isDesktop","real","deviceType","_setInputType","_isSupportInputMode","_isChar","str","offset","adjustedCaret","keyName","isSpecialChar","altKey","isMinusKey","_renderInput","_renderFormatter","_clearCache","_detachFormatterEvents","_attachFormatterEvents","off","_isInputFromPaste","inputType","_isValuePasted","$input","on","_formatValue","clearTimeout","_forceRefreshInputValue","escapedDecimalSeparator","regExpString","stubRegExp","test","_parseValue","currentFormat","realSeparatorIndex","floatPart","minPrecision","_applyRevertedSign","preserveSelectedText","previousText","currentText","caretInBoundaries","_removeMinusFromText","isMinusPressed","parsed","textWithoutMinus","wasMinusRemoved","textWasChanged","_renderDisplayText","apply","arguments","_renderValue","clearedText","_valueChangeEventHandler","_saveValueChangeEvent","_optionChanged","args","name","_refreshValueChangeEvent","_refreshEvents","_clean"],"sources":["E:/MisaProject/W2022_06/misa_emis/node_modules/devextreme/esm/ui/number_box/number_box.mask.js"],"sourcesContent":["/**\r\n * DevExtreme (esm/ui/number_box/number_box.mask.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    isNumeric,\r\n    isDefined,\r\n    isFunction,\r\n    isString\r\n} from \"../../core/utils/type\";\r\nimport devices from \"../../core/devices\";\r\nimport {\r\n    fitIntoRange,\r\n    inRange\r\n} from \"../../core/utils/math\";\r\nimport number from \"../../localization/number\";\r\nimport {\r\n    getCaretWithOffset,\r\n    isCaretInBoundaries,\r\n    getCaretInBoundaries,\r\n    getCaretBoundaries,\r\n    getCaretAfterFormat,\r\n    getCaretOffset\r\n} from \"./number_box.caret\";\r\nimport {\r\n    getFormat as getLDMLFormat\r\n} from \"../../localization/ldml/number\";\r\nimport NumberBoxBase from \"./number_box.base\";\r\nimport {\r\n    addNamespace,\r\n    getChar,\r\n    normalizeKeyName,\r\n    isCommandKeyPressed\r\n} from \"../../events/utils/index\";\r\nimport {\r\n    ensureDefined,\r\n    escapeRegExp\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    getRealSeparatorIndex,\r\n    getNthOccurrence,\r\n    splitByIndex,\r\n    adjustPercentValue\r\n} from \"./utils\";\r\nvar NUMBER_FORMATTER_NAMESPACE = \"dxNumberFormatter\";\r\nvar MOVE_FORWARD = 1;\r\nvar MOVE_BACKWARD = -1;\r\nvar MINUS = \"-\";\r\nvar MINUS_KEY = \"minus\";\r\nvar INPUT_EVENT = \"input\";\r\nvar CARET_TIMEOUT_DURATION = 0;\r\nvar NumberBoxMask = NumberBoxBase.inherit({\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            useMaskBehavior: true,\r\n            format: null\r\n        })\r\n    },\r\n    _isDeleteKey: function(key) {\r\n        return \"del\" === key\r\n    },\r\n    _supportedKeys: function() {\r\n        if (!this._useMaskBehavior()) {\r\n            return this.callBase()\r\n        }\r\n        return extend(this.callBase(), {\r\n            minus: this._revertSign.bind(this),\r\n            del: this._removeHandler.bind(this),\r\n            backspace: this._removeHandler.bind(this),\r\n            leftArrow: this._arrowHandler.bind(this, MOVE_BACKWARD),\r\n            rightArrow: this._arrowHandler.bind(this, MOVE_FORWARD),\r\n            home: this._moveCaretToBoundaryEventHandler.bind(this, MOVE_FORWARD),\r\n            enter: this._updateFormattedValue.bind(this),\r\n            end: this._moveCaretToBoundaryEventHandler.bind(this, MOVE_BACKWARD)\r\n        })\r\n    },\r\n    _getTextSeparatorIndex: function(text) {\r\n        var decimalSeparator = number.getDecimalSeparator();\r\n        var realSeparatorOccurrenceIndex = getRealSeparatorIndex(this.option(\"format\")).occurrence;\r\n        return getNthOccurrence(text, decimalSeparator, realSeparatorOccurrenceIndex)\r\n    },\r\n    _focusInHandler: function(e) {\r\n        if (!this._preventNestedFocusEvent(e)) {\r\n            this.clearCaretTimeout();\r\n            this._caretTimeout = setTimeout(function() {\r\n                this._caretTimeout = void 0;\r\n                var caret = this._caret();\r\n                if (caret.start === caret.end && this._useMaskBehavior()) {\r\n                    var text = this._getInputVal();\r\n                    var decimalSeparatorIndex = this._getTextSeparatorIndex(text);\r\n                    if (decimalSeparatorIndex >= 0) {\r\n                        this._caret({\r\n                            start: decimalSeparatorIndex,\r\n                            end: decimalSeparatorIndex\r\n                        })\r\n                    } else {\r\n                        this._moveCaretToBoundaryEventHandler(MOVE_BACKWARD, e)\r\n                    }\r\n                }\r\n            }.bind(this), CARET_TIMEOUT_DURATION)\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _focusOutHandler: function(e) {\r\n        var shouldHandleEvent = !this._preventNestedFocusEvent(e);\r\n        if (shouldHandleEvent) {\r\n            this._focusOutOccurs = true;\r\n            if (this._useMaskBehavior()) {\r\n                this._updateFormattedValue()\r\n            }\r\n        }\r\n        this.callBase(e);\r\n        if (shouldHandleEvent) {\r\n            this._focusOutOccurs = false\r\n        }\r\n    },\r\n    _hasValueBeenChanged(inputValue) {\r\n        var format = this._getFormatPattern();\r\n        var value = this.option(\"value\");\r\n        var formatted = this._format(value, format) || \"\";\r\n        return formatted !== inputValue\r\n    },\r\n    _updateFormattedValue: function() {\r\n        var inputValue = this._getInputVal();\r\n        if (this._hasValueBeenChanged(inputValue)) {\r\n            this._updateParsedValue();\r\n            this._adjustParsedValue();\r\n            this._setTextByParsedValue();\r\n            if (this._parsedValue !== this.option(\"value\")) {\r\n                eventsEngine.trigger(this._input(), \"change\")\r\n            }\r\n        }\r\n    },\r\n    _arrowHandler: function(step, e) {\r\n        if (!this._useMaskBehavior()) {\r\n            return\r\n        }\r\n        var text = this._getInputVal();\r\n        var format = this._getFormatPattern();\r\n        var nextCaret = getCaretWithOffset(this._caret(), step);\r\n        if (!isCaretInBoundaries(nextCaret, text, format)) {\r\n            nextCaret = step === MOVE_FORWARD ? nextCaret.end : nextCaret.start;\r\n            e.preventDefault();\r\n            this._caret(getCaretInBoundaries(nextCaret, text, format))\r\n        }\r\n    },\r\n    _moveCaretToBoundary: function(direction) {\r\n        var boundaries = getCaretBoundaries(this._getInputVal(), this._getFormatPattern());\r\n        var newCaret = getCaretWithOffset(direction === MOVE_FORWARD ? boundaries.start : boundaries.end, 0);\r\n        this._caret(newCaret)\r\n    },\r\n    _moveCaretToBoundaryEventHandler: function(direction, e) {\r\n        if (!this._useMaskBehavior() || e && e.shiftKey) {\r\n            return\r\n        }\r\n        this._moveCaretToBoundary(direction);\r\n        e && e.preventDefault()\r\n    },\r\n    _shouldMoveCaret: function(text, caret) {\r\n        var decimalSeparator = number.getDecimalSeparator();\r\n        var isDecimalSeparatorNext = text.charAt(caret.end) === decimalSeparator;\r\n        var moveToFloat = (this._lastKey === decimalSeparator || \".\" === this._lastKey || \",\" === this._lastKey) && isDecimalSeparatorNext;\r\n        return moveToFloat\r\n    },\r\n    _getInputVal: function() {\r\n        return number.convertDigits(this._input().val(), true)\r\n    },\r\n    _keyboardHandler: function(e) {\r\n        this.clearCaretTimeout();\r\n        this._lastKey = number.convertDigits(getChar(e), true);\r\n        this._lastKeyName = normalizeKeyName(e);\r\n        if (!this._shouldHandleKey(e.originalEvent)) {\r\n            return this.callBase(e)\r\n        }\r\n        var normalizedText = this._getInputVal();\r\n        var caret = this._caret();\r\n        var enteredChar = this._lastKeyName === MINUS_KEY ? \"\" : this._lastKey;\r\n        var newValue = this._tryParse(normalizedText, caret, enteredChar);\r\n        if (this._shouldMoveCaret(normalizedText, caret)) {\r\n            this._moveCaret(1);\r\n            e.originalEvent.preventDefault()\r\n        }\r\n        if (void 0 === newValue) {\r\n            if (this._lastKeyName !== MINUS_KEY) {\r\n                e.originalEvent.preventDefault()\r\n            }\r\n        } else {\r\n            this._parsedValue = newValue\r\n        }\r\n        return this.callBase(e)\r\n    },\r\n    _keyPressHandler: function(e) {\r\n        if (!this._useMaskBehavior()) {\r\n            this.callBase(e)\r\n        }\r\n    },\r\n    _removeHandler: function(e) {\r\n        var caret = this._caret();\r\n        var text = this._getInputVal();\r\n        var start = caret.start;\r\n        var end = caret.end;\r\n        this._lastKey = getChar(e);\r\n        this._lastKeyName = normalizeKeyName(e);\r\n        var isDeleteKey = this._isDeleteKey(this._lastKeyName);\r\n        var isBackspaceKey = !isDeleteKey;\r\n        if (start === end) {\r\n            var caretPosition = start;\r\n            var canDelete = isBackspaceKey && caretPosition > 0 || isDeleteKey && caretPosition < text.length;\r\n            if (canDelete) {\r\n                isDeleteKey && end++;\r\n                isBackspaceKey && start--\r\n            } else {\r\n                e.preventDefault();\r\n                return\r\n            }\r\n        }\r\n        var char = text.slice(start, end);\r\n        if (this._isStub(char)) {\r\n            this._moveCaret(isDeleteKey ? 1 : -1);\r\n            if (this._parsedValue < 0 || 1 / this._parsedValue === -1 / 0) {\r\n                this._revertSign(e);\r\n                this._setTextByParsedValue()\r\n            }\r\n            e.preventDefault();\r\n            return\r\n        }\r\n        var decimalSeparator = number.getDecimalSeparator();\r\n        if (char === decimalSeparator) {\r\n            var decimalSeparatorIndex = text.indexOf(decimalSeparator);\r\n            if (this._isNonStubAfter(decimalSeparatorIndex + 1)) {\r\n                this._moveCaret(isDeleteKey ? 1 : -1);\r\n                e.preventDefault()\r\n            }\r\n            return\r\n        }\r\n        if (end - start < text.length) {\r\n            var editedText = this._replaceSelectedText(text, {\r\n                start: start,\r\n                end: end\r\n            }, \"\");\r\n            var noDigits = editedText.search(/[0-9]/) < 0;\r\n            if (noDigits && this._isValueInRange(0)) {\r\n                this._parsedValue = this._parsedValue < 0 || 1 / this._parsedValue === -1 / 0 ? -0 : 0;\r\n                return\r\n            }\r\n        }\r\n        var valueAfterRemoving = this._tryParse(text, {\r\n            start: start,\r\n            end: end\r\n        }, \"\");\r\n        if (void 0 === valueAfterRemoving) {\r\n            e.preventDefault()\r\n        } else {\r\n            this._parsedValue = valueAfterRemoving\r\n        }\r\n    },\r\n    _isPercentFormat: function() {\r\n        var format = this._getFormatPattern();\r\n        var noEscapedFormat = format.replace(/'[^']+'/g, \"\");\r\n        return -1 !== noEscapedFormat.indexOf(\"%\")\r\n    },\r\n    _parse: function(text, format) {\r\n        var formatOption = this.option(\"format\");\r\n        var isCustomParser = isFunction(formatOption.parser);\r\n        var parser = isCustomParser ? formatOption.parser : number.parse;\r\n        var integerPartStartIndex = 0;\r\n        if (!isCustomParser) {\r\n            var formatPointIndex = getRealSeparatorIndex(format).index;\r\n            var textPointIndex = this._getTextSeparatorIndex(text);\r\n            var formatIntegerPartLength = -1 !== formatPointIndex ? formatPointIndex : format.length;\r\n            var textIntegerPartLength = -1 !== textPointIndex ? textPointIndex : text.length;\r\n            if (textIntegerPartLength > formatIntegerPartLength && -1 === format.indexOf(\"#\")) {\r\n                integerPartStartIndex = textIntegerPartLength - formatIntegerPartLength\r\n            }\r\n        }\r\n        text = text.substr(integerPartStartIndex);\r\n        return parser(text, format)\r\n    },\r\n    _format: function(value, format) {\r\n        var formatOption = this.option(\"format\");\r\n        var customFormatter = (null === formatOption || void 0 === formatOption ? void 0 : formatOption.formatter) || formatOption;\r\n        var formatter = isFunction(customFormatter) ? customFormatter : number.format;\r\n        var formattedValue = null === value ? \"\" : formatter(value, format);\r\n        return formattedValue\r\n    },\r\n    _getFormatPattern: function() {\r\n        if (!this._currentFormat) {\r\n            this._updateFormat()\r\n        }\r\n        return this._currentFormat\r\n    },\r\n    _updateFormat: function() {\r\n        var format = this.option(\"format\");\r\n        var isCustomParser = isFunction(null === format || void 0 === format ? void 0 : format.parser);\r\n        var isLDMLPattern = isString(format) && (format.indexOf(\"0\") >= 0 || format.indexOf(\"#\") >= 0);\r\n        this._currentFormat = isCustomParser || isLDMLPattern ? format : getLDMLFormat(value => {\r\n            var text = this._format(value, format);\r\n            return number.convertDigits(text, true)\r\n        })\r\n    },\r\n    _getFormatForSign: function(text) {\r\n        var format = this._getFormatPattern();\r\n        if (isString(format)) {\r\n            var signParts = format.split(\";\");\r\n            var sign = number.getSign(text, format);\r\n            signParts[1] = signParts[1] || \"-\" + signParts[0];\r\n            return sign < 0 ? signParts[1] : signParts[0]\r\n        } else {\r\n            var _sign = number.getSign(text);\r\n            return _sign < 0 ? \"-\" : \"\"\r\n        }\r\n    },\r\n    _removeStubs: function(text, excludeComma) {\r\n        var format = this._getFormatForSign(text);\r\n        var thousandsSeparator = number.getThousandsSeparator();\r\n        var stubs = this._getStubs(format);\r\n        var result = text;\r\n        if (stubs.length) {\r\n            var prefixStubs = stubs[0];\r\n            var postfixRegex = new RegExp(\"(\" + escapeRegExp(stubs[1] || \"\") + \")$\", \"g\");\r\n            var decoratorsRegex = new RegExp(\"[-\" + escapeRegExp(excludeComma ? \"\" : thousandsSeparator) + \"]\", \"g\");\r\n            result = result.replace(prefixStubs, \"\").replace(postfixRegex, \"\").replace(decoratorsRegex, \"\")\r\n        }\r\n        return result\r\n    },\r\n    _getStubs: function(format) {\r\n        var regExpResult = /[^']([#0.,]+)/g.exec(format);\r\n        var pattern = regExpResult && regExpResult[0].trim();\r\n        return format.split(pattern).map((function(stub) {\r\n            return stub.replace(/'/g, \"\")\r\n        }))\r\n    },\r\n    _truncateToPrecision: function(value, maxPrecision) {\r\n        if (isDefined(value)) {\r\n            var strValue = value.toString();\r\n            var decimalSeparatorIndex = strValue.indexOf(\".\");\r\n            if (strValue && decimalSeparatorIndex > -1) {\r\n                var parsedValue = parseFloat(strValue.substr(0, decimalSeparatorIndex + maxPrecision + 1));\r\n                return isNaN(parsedValue) ? value : parsedValue\r\n            }\r\n        }\r\n        return value\r\n    },\r\n    _tryParse: function(text, selection, char) {\r\n        var editedText = this._replaceSelectedText(text, selection, char);\r\n        var format = this._getFormatPattern();\r\n        var isTextSelected = selection.start !== selection.end;\r\n        var parsedValue = this._getParsedValue(editedText, format);\r\n        var maxPrecision = !format.parser && this._getPrecisionLimits(editedText).max;\r\n        var isValueChanged = parsedValue !== this._parsedValue;\r\n        var decimalSeparator = number.getDecimalSeparator();\r\n        var isDecimalPointRestricted = char === decimalSeparator && 0 === maxPrecision;\r\n        var isUselessCharRestricted = !isTextSelected && !isValueChanged && char !== MINUS && !this._isValueIncomplete(editedText) && this._isStub(char);\r\n        if (isDecimalPointRestricted || isUselessCharRestricted) {\r\n            return\r\n        }\r\n        if (\"\" === this._removeStubs(editedText)) {\r\n            parsedValue = Math.abs(0 * this._parsedValue)\r\n        }\r\n        if (isNaN(parsedValue)) {\r\n            return\r\n        }\r\n        var value = null === parsedValue ? this._parsedValue : parsedValue;\r\n        parsedValue = maxPrecision ? this._truncateToPrecision(value, maxPrecision) : parsedValue;\r\n        return !format.parser && this._isPercentFormat() ? adjustPercentValue(parsedValue, maxPrecision) : parsedValue\r\n    },\r\n    _getParsedValue: function(text, format) {\r\n        var sign = number.getSign(text, (null === format || void 0 === format ? void 0 : format.formatter) || format);\r\n        var textWithoutStubs = this._removeStubs(text, true);\r\n        var parsedValue = this._parse(textWithoutStubs, format);\r\n        var parsedValueSign = parsedValue < 0 ? -1 : 1;\r\n        var parsedValueWithSign = isNumeric(parsedValue) && sign !== parsedValueSign ? sign * parsedValue : parsedValue;\r\n        return parsedValueWithSign\r\n    },\r\n    _isValueIncomplete: function(text) {\r\n        if (!this._useMaskBehavior()) {\r\n            return this.callBase(text)\r\n        }\r\n        var caret = this._caret();\r\n        var point = number.getDecimalSeparator();\r\n        var pointIndex = this._getTextSeparatorIndex(text);\r\n        var isCaretOnFloat = pointIndex >= 0 && pointIndex < caret.start;\r\n        var textParts = this._removeStubs(text, true).split(point);\r\n        if (!isCaretOnFloat || 2 !== textParts.length) {\r\n            return false\r\n        }\r\n        var floatLength = textParts[1].length;\r\n        var format = this._getFormatPattern();\r\n        var isCustomParser = !!format.parser;\r\n        var precision = !isCustomParser && this._getPrecisionLimits(this._getFormatPattern(), text);\r\n        var isPrecisionInRange = isCustomParser ? true : inRange(floatLength, precision.min, precision.max);\r\n        var endsWithZero = \"0\" === textParts[1].charAt(floatLength - 1);\r\n        return isPrecisionInRange && (endsWithZero || !floatLength)\r\n    },\r\n    _isValueInRange: function(value) {\r\n        var min = ensureDefined(this.option(\"min\"), -1 / 0);\r\n        var max = ensureDefined(this.option(\"max\"), 1 / 0);\r\n        return inRange(value, min, max)\r\n    },\r\n    _setInputText: function(text) {\r\n        var normalizedText = number.convertDigits(text, true);\r\n        var newCaret = getCaretAfterFormat(this._getInputVal(), normalizedText, this._caret(), this._getFormatPattern());\r\n        this._input().val(text);\r\n        this._toggleEmptinessEventHandler();\r\n        this._formattedValue = text;\r\n        if (!this._focusOutOccurs) {\r\n            this._caret(newCaret)\r\n        }\r\n    },\r\n    _useMaskBehavior: function() {\r\n        return !!this.option(\"format\") && this.option(\"useMaskBehavior\")\r\n    },\r\n    _renderInputType: function() {\r\n        var isNumberType = \"number\" === this.option(\"mode\");\r\n        var isDesktop = \"desktop\" === devices.real().deviceType;\r\n        if (this._useMaskBehavior() && isNumberType) {\r\n            this._setInputType(isDesktop || this._isSupportInputMode() ? \"text\" : \"tel\")\r\n        } else {\r\n            this.callBase()\r\n        }\r\n    },\r\n    _isChar: function(str) {\r\n        return isString(str) && 1 === str.length\r\n    },\r\n    _moveCaret: function(offset) {\r\n        if (!offset) {\r\n            return\r\n        }\r\n        var newCaret = getCaretWithOffset(this._caret(), offset);\r\n        var adjustedCaret = getCaretInBoundaries(newCaret, this._getInputVal(), this._getFormatPattern());\r\n        this._caret(adjustedCaret)\r\n    },\r\n    _shouldHandleKey: function(e) {\r\n        var keyName = normalizeKeyName(e);\r\n        var isSpecialChar = isCommandKeyPressed(e) || e.altKey || e.shiftKey || !this._isChar(keyName);\r\n        var isMinusKey = keyName === MINUS_KEY;\r\n        var useMaskBehavior = this._useMaskBehavior();\r\n        return useMaskBehavior && !isSpecialChar && !isMinusKey\r\n    },\r\n    _renderInput: function() {\r\n        this.callBase();\r\n        this._renderFormatter()\r\n    },\r\n    _renderFormatter: function() {\r\n        this._clearCache();\r\n        this._detachFormatterEvents();\r\n        if (this._useMaskBehavior()) {\r\n            this._attachFormatterEvents()\r\n        }\r\n    },\r\n    _detachFormatterEvents: function() {\r\n        eventsEngine.off(this._input(), \".\" + NUMBER_FORMATTER_NAMESPACE)\r\n    },\r\n    _isInputFromPaste: function(e) {\r\n        var inputType = e.originalEvent && e.originalEvent.inputType;\r\n        if (isDefined(inputType)) {\r\n            return \"insertFromPaste\" === inputType\r\n        } else {\r\n            return this._isValuePasted\r\n        }\r\n    },\r\n    _attachFormatterEvents: function() {\r\n        var $input = this._input();\r\n        eventsEngine.on($input, addNamespace(INPUT_EVENT, NUMBER_FORMATTER_NAMESPACE), function(e) {\r\n            this._formatValue(e);\r\n            this._isValuePasted = false\r\n        }.bind(this));\r\n        eventsEngine.on($input, addNamespace(\"dxclick\", NUMBER_FORMATTER_NAMESPACE), function() {\r\n            if (!this._caretTimeout) {\r\n                this._caretTimeout = setTimeout(function() {\r\n                    this._caretTimeout = void 0;\r\n                    this._caret(getCaretInBoundaries(this._caret(), this._getInputVal(), this._getFormatPattern()))\r\n                }.bind(this), CARET_TIMEOUT_DURATION)\r\n            }\r\n        }.bind(this));\r\n        eventsEngine.on($input, \"dxdblclick\", function() {\r\n            this.clearCaretTimeout()\r\n        }.bind(this))\r\n    },\r\n    clearCaretTimeout: function() {\r\n        clearTimeout(this._caretTimeout);\r\n        this._caretTimeout = void 0\r\n    },\r\n    _forceRefreshInputValue: function() {\r\n        if (!this._useMaskBehavior()) {\r\n            return this.callBase()\r\n        }\r\n    },\r\n    _isNonStubAfter: function(index) {\r\n        var text = this._getInputVal().slice(index);\r\n        return text && !this._isStub(text, true)\r\n    },\r\n    _isStub: function(str, isString) {\r\n        var escapedDecimalSeparator = escapeRegExp(number.getDecimalSeparator());\r\n        var regExpString = \"^[^0-9\" + escapedDecimalSeparator + \"]+$\";\r\n        var stubRegExp = new RegExp(regExpString, \"g\");\r\n        return stubRegExp.test(str) && (isString || this._isChar(str))\r\n    },\r\n    _parseValue: function(text) {\r\n        if (!this._useMaskBehavior()) {\r\n            return this.callBase(text)\r\n        }\r\n        return this._parsedValue\r\n    },\r\n    _getPrecisionLimits: function(text) {\r\n        var currentFormat = this._getFormatForSign(text);\r\n        var realSeparatorIndex = getRealSeparatorIndex(currentFormat).index;\r\n        var floatPart = (splitByIndex(currentFormat, realSeparatorIndex)[1] || \"\").replace(/[^#0]/g, \"\");\r\n        var minPrecision = floatPart.replace(/^(0*)#*/, \"$1\").length;\r\n        var maxPrecision = floatPart.length;\r\n        return {\r\n            min: minPrecision,\r\n            max: maxPrecision\r\n        }\r\n    },\r\n    _revertSign: function(e) {\r\n        if (!this._useMaskBehavior()) {\r\n            return\r\n        }\r\n        var caret = this._caret();\r\n        if (caret.start !== caret.end) {\r\n            if (normalizeKeyName(e) === MINUS_KEY) {\r\n                this._applyRevertedSign(e, caret, true);\r\n                return\r\n            } else {\r\n                this._caret(getCaretInBoundaries(0, this._getInputVal(), this._getFormatPattern()))\r\n            }\r\n        }\r\n        this._applyRevertedSign(e, caret)\r\n    },\r\n    _applyRevertedSign: function(e, caret, preserveSelectedText) {\r\n        var newValue = -1 * ensureDefined(this._parsedValue, null);\r\n        if (this._isValueInRange(newValue)) {\r\n            this._parsedValue = newValue;\r\n            if (preserveSelectedText) {\r\n                var format = this._getFormatPattern();\r\n                var previousText = this._getInputVal();\r\n                this._setTextByParsedValue();\r\n                e.preventDefault();\r\n                var currentText = this._getInputVal();\r\n                var offset = getCaretOffset(previousText, currentText, format);\r\n                caret = getCaretWithOffset(caret, offset);\r\n                var caretInBoundaries = getCaretInBoundaries(caret, currentText, format);\r\n                this._caret(caretInBoundaries)\r\n            }\r\n        }\r\n    },\r\n    _removeMinusFromText: function(text, caret) {\r\n        var isMinusPressed = this._lastKeyName === MINUS_KEY && text.charAt(caret.start - 1) === MINUS;\r\n        return isMinusPressed ? this._replaceSelectedText(text, {\r\n            start: caret.start - 1,\r\n            end: caret.start\r\n        }, \"\") : text\r\n    },\r\n    _setTextByParsedValue: function() {\r\n        var format = this._getFormatPattern();\r\n        var parsed = this._parseValue();\r\n        var formatted = this._format(parsed, format) || \"\";\r\n        this._setInputText(formatted)\r\n    },\r\n    _formatValue: function(e) {\r\n        var normalizedText = this._getInputVal();\r\n        var caret = this._caret();\r\n        var textWithoutMinus = this._removeMinusFromText(normalizedText, caret);\r\n        var wasMinusRemoved = textWithoutMinus !== normalizedText;\r\n        normalizedText = textWithoutMinus;\r\n        if (!this._isInputFromPaste(e) && this._isValueIncomplete(textWithoutMinus)) {\r\n            this._formattedValue = normalizedText;\r\n            if (wasMinusRemoved) {\r\n                this._setTextByParsedValue()\r\n            }\r\n            return\r\n        }\r\n        var textWasChanged = number.convertDigits(this._formattedValue, true) !== normalizedText;\r\n        if (textWasChanged) {\r\n            var value = this._tryParse(normalizedText, caret, \"\");\r\n            if (isDefined(value)) {\r\n                this._parsedValue = value\r\n            }\r\n        }\r\n        this._setTextByParsedValue()\r\n    },\r\n    _renderDisplayText: function() {\r\n        if (this._useMaskBehavior()) {\r\n            this._toggleEmptinessEventHandler()\r\n        } else {\r\n            this.callBase.apply(this, arguments)\r\n        }\r\n    },\r\n    _renderValue: function() {\r\n        if (this._useMaskBehavior()) {\r\n            this._parsedValue = this.option(\"value\");\r\n            this._setTextByParsedValue()\r\n        }\r\n        return this.callBase()\r\n    },\r\n    _updateParsedValue: function() {\r\n        var inputValue = this._getInputVal();\r\n        this._parsedValue = this._tryParse(inputValue, this._caret())\r\n    },\r\n    _adjustParsedValue: function() {\r\n        if (!this._useMaskBehavior()) {\r\n            return\r\n        }\r\n        var clearedText = this._removeStubs(this._getInputVal());\r\n        var parsedValue = clearedText ? this._parseValue() : null;\r\n        if (!isNumeric(parsedValue)) {\r\n            this._parsedValue = parsedValue;\r\n            return\r\n        }\r\n        this._parsedValue = fitIntoRange(parsedValue, this.option(\"min\"), this.option(\"max\"))\r\n    },\r\n    _valueChangeEventHandler: function(e) {\r\n        if (!this._useMaskBehavior()) {\r\n            return this.callBase(e)\r\n        }\r\n        var caret = this._caret();\r\n        this._saveValueChangeEvent(e);\r\n        this._lastKey = null;\r\n        this._lastKeyName = null;\r\n        this._updateParsedValue();\r\n        this._adjustParsedValue();\r\n        this.option(\"value\", this._parsedValue);\r\n        if (caret) {\r\n            this._caret(caret)\r\n        }\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"format\":\r\n            case \"useMaskBehavior\":\r\n                this._renderInputType();\r\n                this._updateFormat();\r\n                this._renderFormatter();\r\n                this._renderValue();\r\n                this._refreshValueChangeEvent();\r\n                this._refreshEvents();\r\n                break;\r\n            case \"min\":\r\n            case \"max\":\r\n                this._adjustParsedValue();\r\n                this.callBase(args);\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _clearCache: function() {\r\n        delete this._formattedValue;\r\n        delete this._lastKey;\r\n        delete this._lastKeyName;\r\n        delete this._parsedValue;\r\n        delete this._focusOutOccurs;\r\n        clearTimeout(this._caretTimeout);\r\n        delete this._caretTimeout\r\n    },\r\n    _clean: function() {\r\n        this._clearCache();\r\n        this.callBase()\r\n    }\r\n});\r\nexport default NumberBoxMask;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}